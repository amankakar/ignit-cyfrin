<style> code { white-space: pre-wrap; display: block; background-color: #eee; }.executed { background-color: #afa; }.reverted { background-color: #ffa; }.unexecuted { background-color: #faa; }.neutral { background-color: #eee; }</style><b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/access/AccessControlUpgradeable.sol</b>
<code>
   1 |     | <span class='unexecuted'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (access/AccessControl.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./IAccessControlUpgradeable.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../utils/ContextUpgradeable.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../utils/StringsUpgradeable.sol&quot;;</span>
   9 |     | <span class='neutral'>import &quot;../utils/introspection/ERC165Upgradeable.sol&quot;;</span>
  10 |     | <span class='neutral'>import &quot;../proxy/utils/Initializable.sol&quot;;</span>
  11 |     | <span class='neutral'></span>
  12 |     | <span class='neutral'>/**</span>
  13 |     | <span class='neutral'> * @dev Contract module that allows children to implement role-based access</span>
  14 |     | <span class='neutral'> * control mechanisms. This is a lightweight version that doesn&#39;t allow enumerating role</span>
  15 |     | <span class='neutral'> * members except through off-chain means by accessing the contract event logs. Some</span>
  16 |     | <span class='neutral'> * applications may benefit from on-chain enumerability, for those cases see</span>
  17 |     | <span class='neutral'> * {AccessControlEnumerable}.</span>
  18 |     | <span class='neutral'> *</span>
  19 |     | <span class='neutral'> * Roles are referred to by their `bytes32` identifier. These should be exposed</span>
  20 |     | <span class='neutral'> * in the external API and be unique. The best way to achieve this is by</span>
  21 |     | <span class='neutral'> * using `public constant` hash digests:</span>
  22 |     | <span class='neutral'> *</span>
  23 |     | <span class='neutral'> * ```</span>
  24 |     | <span class='neutral'> * bytes32 public constant MY_ROLE = keccak256(&quot;MY_ROLE&quot;);</span>
  25 |     | <span class='neutral'> * ```</span>
  26 |     | <span class='neutral'> *</span>
  27 |     | <span class='neutral'> * Roles can be used to represent a set of permissions. To restrict access to a</span>
  28 |     | <span class='neutral'> * function call, use {hasRole}:</span>
  29 |     | <span class='neutral'> *</span>
  30 |     | <span class='neutral'> * ```</span>
  31 |     | <span class='neutral'> * function foo() public {</span>
  32 |     | <span class='neutral'> *     require(hasRole(MY_ROLE, msg.sender));</span>
  33 |     | <span class='neutral'> *     ...</span>
  34 |     | <span class='neutral'> * }</span>
  35 |     | <span class='neutral'> * ```</span>
  36 |     | <span class='neutral'> *</span>
  37 |     | <span class='neutral'> * Roles can be granted and revoked dynamically via the {grantRole} and</span>
  38 |     | <span class='neutral'> * {revokeRole} functions. Each role has an associated admin role, and only</span>
  39 |     | <span class='neutral'> * accounts that have a role&#39;s admin role can call {grantRole} and {revokeRole}.</span>
  40 |     | <span class='neutral'> *</span>
  41 |     | <span class='neutral'> * By default, the admin role for all roles is `DEFAULT_ADMIN_ROLE`, which means</span>
  42 |     | <span class='neutral'> * that only accounts with this role will be able to grant or revoke other</span>
  43 |     | <span class='neutral'> * roles. More complex role relationships can be created by using</span>
  44 |     | <span class='neutral'> * {_setRoleAdmin}.</span>
  45 |     | <span class='neutral'> *</span>
  46 |     | <span class='neutral'> * WARNING: The `DEFAULT_ADMIN_ROLE` is also its own admin: it has permission to</span>
  47 |     | <span class='neutral'> * grant and revoke this role. Extra precautions should be taken to secure</span>
  48 |     | <span class='neutral'> * accounts that have been granted it.</span>
  49 |     | <span class='neutral'> */</span>
  50 |     | <span class='neutral'>abstract contract AccessControlUpgradeable is Initializable, ContextUpgradeable, IAccessControlUpgradeable, ERC165Upgradeable {</span>
  51 |     | <span class='neutral'>    function __AccessControl_init() internal onlyInitializing {</span>
  52 |     | <span class='neutral'>    }</span>
  53 |     | <span class='neutral'></span>
  54 |     | <span class='neutral'>    function __AccessControl_init_unchained() internal onlyInitializing {</span>
  55 |     | <span class='neutral'>    }</span>
  56 |     | <span class='neutral'>    struct RoleData {</span>
  57 |     | <span class='neutral'>        mapping(address =&gt; bool) members;</span>
  58 |     | <span class='neutral'>        bytes32 adminRole;</span>
  59 |     | <span class='neutral'>    }</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    mapping(bytes32 =&gt; RoleData) private _roles;</span>
  62 |     | <span class='neutral'></span>
  63 |     | <span class='neutral'>    bytes32 public constant DEFAULT_ADMIN_ROLE = 0x00;</span>
  64 |     | <span class='neutral'></span>
  65 |     | <span class='neutral'>    /**</span>
  66 |     | <span class='neutral'>     * @dev Modifier that checks that an account has a specific role. Reverts</span>
  67 |     | <span class='neutral'>     * with a standardized message including the required role.</span>
  68 |     | <span class='neutral'>     *</span>
  69 |     | <span class='neutral'>     * The format of the revert reason is given by the following regular expression:</span>
  70 |     | <span class='neutral'>     *</span>
  71 |     | <span class='neutral'>     *  /^AccessControl: account (0x[0-9a-f]{40}) is missing role (0x[0-9a-f]{64})$/</span>
  72 |     | <span class='neutral'>     *</span>
  73 |     | <span class='neutral'>     * _Available since v4.1._</span>
  74 |     | <span class='neutral'>     */</span>
  75 |     | <span class='neutral'>    modifier onlyRole(bytes32 role) {</span>
  76 | *   | <span class='executed'>        _checkRole(role);</span>
  77 |     | <span class='neutral'>        _;</span>
  78 |     | <span class='neutral'>    }</span>
  79 |     | <span class='neutral'></span>
  80 |     | <span class='neutral'>    /**</span>
  81 |     | <span class='neutral'>     * @dev See {IERC165-supportsInterface}.</span>
  82 |     | <span class='neutral'>     */</span>
  83 |     | <span class='neutral'>    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
  84 |     | <span class='unexecuted'>        return interfaceId == type(IAccessControlUpgradeable).interfaceId || super.supportsInterface(interfaceId);</span>
  85 |     | <span class='neutral'>    }</span>
  86 |     | <span class='neutral'></span>
  87 |     | <span class='neutral'>    /**</span>
  88 |     | <span class='neutral'>     * @dev Returns `true` if `account` has been granted `role`.</span>
  89 |     | <span class='neutral'>     */</span>
  90 |     | <span class='neutral'>    function hasRole(bytes32 role, address account) public view virtual override returns (bool) {</span>
  91 | *   | <span class='executed'>        return _roles[role].members[account];</span>
  92 |     | <span class='neutral'>    }</span>
  93 |     | <span class='neutral'></span>
  94 |     | <span class='neutral'>    /**</span>
  95 |     | <span class='neutral'>     * @dev Revert with a standard message if `_msgSender()` is missing `role`.</span>
  96 |     | <span class='neutral'>     * Overriding this function changes the behavior of the {onlyRole} modifier.</span>
  97 |     | <span class='neutral'>     *</span>
  98 |     | <span class='neutral'>     * Format of the revert message is described in {_checkRole}.</span>
  99 |     | <span class='neutral'>     *</span>
 100 |     | <span class='neutral'>     * _Available since v4.6._</span>
 101 |     | <span class='neutral'>     */</span>
 102 | *   | <span class='executed'>    function _checkRole(bytes32 role) internal view virtual {</span>
 103 |     | <span class='neutral'>        _checkRole(role, _msgSender());</span>
 104 |     | <span class='neutral'>    }</span>
 105 |     | <span class='neutral'></span>
 106 |     | <span class='neutral'>    /**</span>
 107 |     | <span class='neutral'>     * @dev Revert with a standard message if `account` is missing `role`.</span>
 108 |     | <span class='neutral'>     *</span>
 109 |     | <span class='neutral'>     * The format of the revert reason is given by the following regular expression:</span>
 110 |     | <span class='neutral'>     *</span>
 111 |     | <span class='neutral'>     *  /^AccessControl: account (0x[0-9a-f]{40}) is missing role (0x[0-9a-f]{64})$/</span>
 112 |     | <span class='neutral'>     */</span>
 113 |     | <span class='neutral'>    function _checkRole(bytes32 role, address account) internal view virtual {</span>
 114 | *   | <span class='executed'>        if (!hasRole(role, account)) {</span>
 115 |     | <span class='unexecuted'>            revert(</span>
 116 |     | <span class='neutral'>                string(</span>
 117 |     | <span class='unexecuted'>                    abi.encodePacked(</span>
 118 |     | <span class='neutral'>                        &quot;AccessControl: account &quot;,</span>
 119 |     | <span class='neutral'>                        StringsUpgradeable.toHexString(account),</span>
 120 |     | <span class='neutral'>                        &quot; is missing role &quot;,</span>
 121 |     | <span class='neutral'>                        StringsUpgradeable.toHexString(uint256(role), 32)</span>
 122 |     | <span class='neutral'>                    )</span>
 123 |     | <span class='neutral'>                )</span>
 124 |     | <span class='neutral'>            );</span>
 125 |     | <span class='neutral'>        }</span>
 126 |     | <span class='neutral'>    }</span>
 127 |     | <span class='neutral'></span>
 128 |     | <span class='neutral'>    /**</span>
 129 |     | <span class='neutral'>     * @dev Returns the admin role that controls `role`. See {grantRole} and</span>
 130 |     | <span class='neutral'>     * {revokeRole}.</span>
 131 |     | <span class='neutral'>     *</span>
 132 |     | <span class='neutral'>     * To change a role&#39;s admin, use {_setRoleAdmin}.</span>
 133 |     | <span class='neutral'>     */</span>
 134 | *   | <span class='executed'>    function getRoleAdmin(bytes32 role) public view virtual override returns (bytes32) {</span>
 135 | *   | <span class='executed'>        return _roles[role].adminRole;</span>
 136 |     | <span class='neutral'>    }</span>
 137 |     | <span class='neutral'></span>
 138 |     | <span class='neutral'>    /**</span>
 139 |     | <span class='neutral'>     * @dev Grants `role` to `account`.</span>
 140 |     | <span class='neutral'>     *</span>
 141 |     | <span class='neutral'>     * If `account` had not been already granted `role`, emits a {RoleGranted}</span>
 142 |     | <span class='neutral'>     * event.</span>
 143 |     | <span class='neutral'>     *</span>
 144 |     | <span class='neutral'>     * Requirements:</span>
 145 |     | <span class='neutral'>     *</span>
 146 |     | <span class='neutral'>     * - the caller must have ``role``&#39;s admin role.</span>
 147 |     | <span class='neutral'>     *</span>
 148 |     | <span class='neutral'>     * May emit a {RoleGranted} event.</span>
 149 |     | <span class='neutral'>     */</span>
 150 | *   | <span class='executed'>    function grantRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {</span>
 151 |     | <span class='neutral'>        _grantRole(role, account);</span>
 152 |     | <span class='neutral'>    }</span>
 153 |     | <span class='neutral'></span>
 154 |     | <span class='neutral'>    /**</span>
 155 |     | <span class='neutral'>     * @dev Revokes `role` from `account`.</span>
 156 |     | <span class='neutral'>     *</span>
 157 |     | <span class='neutral'>     * If `account` had been granted `role`, emits a {RoleRevoked} event.</span>
 158 |     | <span class='neutral'>     *</span>
 159 |     | <span class='neutral'>     * Requirements:</span>
 160 |     | <span class='neutral'>     *</span>
 161 |     | <span class='neutral'>     * - the caller must have ``role``&#39;s admin role.</span>
 162 |     | <span class='neutral'>     *</span>
 163 |     | <span class='neutral'>     * May emit a {RoleRevoked} event.</span>
 164 |     | <span class='neutral'>     */</span>
 165 | *   | <span class='executed'>    function revokeRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {</span>
 166 |     | <span class='unexecuted'>        _revokeRole(role, account);</span>
 167 |     | <span class='neutral'>    }</span>
 168 |     | <span class='neutral'></span>
 169 |     | <span class='neutral'>    /**</span>
 170 |     | <span class='neutral'>     * @dev Revokes `role` from the calling account.</span>
 171 |     | <span class='neutral'>     *</span>
 172 |     | <span class='neutral'>     * Roles are often managed via {grantRole} and {revokeRole}: this function&#39;s</span>
 173 |     | <span class='neutral'>     * purpose is to provide a mechanism for accounts to lose their privileges</span>
 174 |     | <span class='neutral'>     * if they are compromised (such as when a trusted device is misplaced).</span>
 175 |     | <span class='neutral'>     *</span>
 176 |     | <span class='neutral'>     * If the calling account had been revoked `role`, emits a {RoleRevoked}</span>
 177 |     | <span class='neutral'>     * event.</span>
 178 |     | <span class='neutral'>     *</span>
 179 |     | <span class='neutral'>     * Requirements:</span>
 180 |     | <span class='neutral'>     *</span>
 181 |     | <span class='neutral'>     * - the caller must be `account`.</span>
 182 |     | <span class='neutral'>     *</span>
 183 |     | <span class='neutral'>     * May emit a {RoleRevoked} event.</span>
 184 |     | <span class='neutral'>     */</span>
 185 |     | <span class='neutral'>    function renounceRole(bytes32 role, address account) public virtual override {</span>
 186 |     | <span class='unexecuted'>        require(account == _msgSender(), &quot;AccessControl: can only renounce roles for self&quot;);</span>
 187 |     | <span class='neutral'></span>
 188 |     | <span class='unexecuted'>        _revokeRole(role, account);</span>
 189 |     | <span class='neutral'>    }</span>
 190 |     | <span class='neutral'></span>
 191 |     | <span class='neutral'>    /**</span>
 192 |     | <span class='neutral'>     * @dev Grants `role` to `account`.</span>
 193 |     | <span class='neutral'>     *</span>
 194 |     | <span class='neutral'>     * If `account` had not been already granted `role`, emits a {RoleGranted}</span>
 195 |     | <span class='neutral'>     * event. Note that unlike {grantRole}, this function doesn&#39;t perform any</span>
 196 |     | <span class='neutral'>     * checks on the calling account.</span>
 197 |     | <span class='neutral'>     *</span>
 198 |     | <span class='neutral'>     * May emit a {RoleGranted} event.</span>
 199 |     | <span class='neutral'>     *</span>
 200 |     | <span class='neutral'>     * [WARNING]</span>
 201 |     | <span class='neutral'>     * ====</span>
 202 |     | <span class='neutral'>     * This function should only be called from the constructor when setting</span>
 203 |     | <span class='neutral'>     * up the initial roles for the system.</span>
 204 |     | <span class='neutral'>     *</span>
 205 |     | <span class='neutral'>     * Using this function in any other way is effectively circumventing the admin</span>
 206 |     | <span class='neutral'>     * system imposed by {AccessControl}.</span>
 207 |     | <span class='neutral'>     * ====</span>
 208 |     | <span class='neutral'>     *</span>
 209 |     | <span class='neutral'>     * NOTE: This function is deprecated in favor of {_grantRole}.</span>
 210 |     | <span class='neutral'>     */</span>
 211 |     | <span class='neutral'>    function _setupRole(bytes32 role, address account) internal virtual {</span>
 212 |     | <span class='neutral'>        _grantRole(role, account);</span>
 213 |     | <span class='neutral'>    }</span>
 214 |     | <span class='neutral'></span>
 215 |     | <span class='neutral'>    /**</span>
 216 |     | <span class='neutral'>     * @dev Sets `adminRole` as ``role``&#39;s admin role.</span>
 217 |     | <span class='neutral'>     *</span>
 218 |     | <span class='neutral'>     * Emits a {RoleAdminChanged} event.</span>
 219 |     | <span class='neutral'>     */</span>
 220 |     | <span class='neutral'>    function _setRoleAdmin(bytes32 role, bytes32 adminRole) internal virtual {</span>
 221 |     | <span class='neutral'>        bytes32 previousAdminRole = getRoleAdmin(role);</span>
 222 |     | <span class='neutral'>        _roles[role].adminRole = adminRole;</span>
 223 |     | <span class='neutral'>        emit RoleAdminChanged(role, previousAdminRole, adminRole);</span>
 224 |     | <span class='neutral'>    }</span>
 225 |     | <span class='neutral'></span>
 226 |     | <span class='neutral'>    /**</span>
 227 |     | <span class='neutral'>     * @dev Grants `role` to `account`.</span>
 228 |     | <span class='neutral'>     *</span>
 229 |     | <span class='neutral'>     * Internal function without access restriction.</span>
 230 |     | <span class='neutral'>     *</span>
 231 |     | <span class='neutral'>     * May emit a {RoleGranted} event.</span>
 232 |     | <span class='neutral'>     */</span>
 233 |     | <span class='neutral'>    function _grantRole(bytes32 role, address account) internal virtual {</span>
 234 | *   | <span class='executed'>        if (!hasRole(role, account)) {</span>
 235 |     | <span class='neutral'>            _roles[role].members[account] = true;</span>
 236 | *   | <span class='executed'>            emit RoleGranted(role, account, _msgSender());</span>
 237 |     | <span class='neutral'>        }</span>
 238 |     | <span class='neutral'>    }</span>
 239 |     | <span class='neutral'></span>
 240 |     | <span class='neutral'>    /**</span>
 241 |     | <span class='neutral'>     * @dev Revokes `role` from `account`.</span>
 242 |     | <span class='neutral'>     *</span>
 243 |     | <span class='neutral'>     * Internal function without access restriction.</span>
 244 |     | <span class='neutral'>     *</span>
 245 |     | <span class='neutral'>     * May emit a {RoleRevoked} event.</span>
 246 |     | <span class='neutral'>     */</span>
 247 |     | <span class='unexecuted'>    function _revokeRole(bytes32 role, address account) internal virtual {</span>
 248 |     | <span class='unexecuted'>        if (hasRole(role, account)) {</span>
 249 |     | <span class='neutral'>            _roles[role].members[account] = false;</span>
 250 |     | <span class='unexecuted'>            emit RoleRevoked(role, account, _msgSender());</span>
 251 |     | <span class='neutral'>        }</span>
 252 |     | <span class='neutral'>    }</span>
 253 |     | <span class='neutral'></span>
 254 |     | <span class='neutral'>    /**</span>
 255 |     | <span class='neutral'>     * @dev This empty reserved space is put in place to allow future versions to add new</span>
 256 |     | <span class='neutral'>     * variables without shifting down storage in the inheritance chain.</span>
 257 |     | <span class='neutral'>     * See https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps</span>
 258 |     | <span class='neutral'>     */</span>
 259 |     | <span class='neutral'>    uint256[49] private __gap;</span>
 260 |     | <span class='neutral'>}</span>
 261 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/access/IAccessControlUpgradeable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (access/IAccessControl.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev External interface of AccessControl declared to support ERC165 detection.</span>
  8 |     | <span class='neutral'> */</span>
  9 |     | <span class='neutral'>interface IAccessControlUpgradeable {</span>
 10 |     | <span class='neutral'>    /**</span>
 11 |     | <span class='neutral'>     * @dev Emitted when `newAdminRole` is set as ``role``&#39;s admin role, replacing `previousAdminRole`</span>
 12 |     | <span class='neutral'>     *</span>
 13 |     | <span class='neutral'>     * `DEFAULT_ADMIN_ROLE` is the starting admin for all roles, despite</span>
 14 |     | <span class='neutral'>     * {RoleAdminChanged} not being emitted signaling this.</span>
 15 |     | <span class='neutral'>     *</span>
 16 |     | <span class='neutral'>     * _Available since v3.1._</span>
 17 |     | <span class='neutral'>     */</span>
 18 |     | <span class='neutral'>    event RoleAdminChanged(bytes32 indexed role, bytes32 indexed previousAdminRole, bytes32 indexed newAdminRole);</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    /**</span>
 21 |     | <span class='neutral'>     * @dev Emitted when `account` is granted `role`.</span>
 22 |     | <span class='neutral'>     *</span>
 23 |     | <span class='neutral'>     * `sender` is the account that originated the contract call, an admin role</span>
 24 |     | <span class='neutral'>     * bearer except when using {AccessControl-_setupRole}.</span>
 25 |     | <span class='neutral'>     */</span>
 26 |     | <span class='neutral'>    event RoleGranted(bytes32 indexed role, address indexed account, address indexed sender);</span>
 27 |     | <span class='neutral'></span>
 28 |     | <span class='neutral'>    /**</span>
 29 |     | <span class='neutral'>     * @dev Emitted when `account` is revoked `role`.</span>
 30 |     | <span class='neutral'>     *</span>
 31 |     | <span class='neutral'>     * `sender` is the account that originated the contract call:</span>
 32 |     | <span class='neutral'>     *   - if using `revokeRole`, it is the admin role bearer</span>
 33 |     | <span class='neutral'>     *   - if using `renounceRole`, it is the role bearer (i.e. `account`)</span>
 34 |     | <span class='neutral'>     */</span>
 35 |     | <span class='neutral'>    event RoleRevoked(bytes32 indexed role, address indexed account, address indexed sender);</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>    /**</span>
 38 |     | <span class='neutral'>     * @dev Returns `true` if `account` has been granted `role`.</span>
 39 |     | <span class='neutral'>     */</span>
 40 |     | <span class='neutral'>    function hasRole(bytes32 role, address account) external view returns (bool);</span>
 41 |     | <span class='neutral'></span>
 42 |     | <span class='neutral'>    /**</span>
 43 |     | <span class='neutral'>     * @dev Returns the admin role that controls `role`. See {grantRole} and</span>
 44 |     | <span class='neutral'>     * {revokeRole}.</span>
 45 |     | <span class='neutral'>     *</span>
 46 |     | <span class='neutral'>     * To change a role&#39;s admin, use {AccessControl-_setRoleAdmin}.</span>
 47 |     | <span class='neutral'>     */</span>
 48 |     | <span class='neutral'>    function getRoleAdmin(bytes32 role) external view returns (bytes32);</span>
 49 |     | <span class='neutral'></span>
 50 |     | <span class='neutral'>    /**</span>
 51 |     | <span class='neutral'>     * @dev Grants `role` to `account`.</span>
 52 |     | <span class='neutral'>     *</span>
 53 |     | <span class='neutral'>     * If `account` had not been already granted `role`, emits a {RoleGranted}</span>
 54 |     | <span class='neutral'>     * event.</span>
 55 |     | <span class='neutral'>     *</span>
 56 |     | <span class='neutral'>     * Requirements:</span>
 57 |     | <span class='neutral'>     *</span>
 58 |     | <span class='neutral'>     * - the caller must have ``role``&#39;s admin role.</span>
 59 |     | <span class='neutral'>     */</span>
 60 |     | <span class='neutral'>    function grantRole(bytes32 role, address account) external;</span>
 61 |     | <span class='neutral'></span>
 62 |     | <span class='neutral'>    /**</span>
 63 |     | <span class='neutral'>     * @dev Revokes `role` from `account`.</span>
 64 |     | <span class='neutral'>     *</span>
 65 |     | <span class='neutral'>     * If `account` had been granted `role`, emits a {RoleRevoked} event.</span>
 66 |     | <span class='neutral'>     *</span>
 67 |     | <span class='neutral'>     * Requirements:</span>
 68 |     | <span class='neutral'>     *</span>
 69 |     | <span class='neutral'>     * - the caller must have ``role``&#39;s admin role.</span>
 70 |     | <span class='neutral'>     */</span>
 71 |     | <span class='neutral'>    function revokeRole(bytes32 role, address account) external;</span>
 72 |     | <span class='neutral'></span>
 73 |     | <span class='neutral'>    /**</span>
 74 |     | <span class='neutral'>     * @dev Revokes `role` from the calling account.</span>
 75 |     | <span class='neutral'>     *</span>
 76 |     | <span class='neutral'>     * Roles are often managed via {grantRole} and {revokeRole}: this function&#39;s</span>
 77 |     | <span class='neutral'>     * purpose is to provide a mechanism for accounts to lose their privileges</span>
 78 |     | <span class='neutral'>     * if they are compromised (such as when a trusted device is misplaced).</span>
 79 |     | <span class='neutral'>     *</span>
 80 |     | <span class='neutral'>     * If the calling account had been granted `role`, emits a {RoleRevoked}</span>
 81 |     | <span class='neutral'>     * event.</span>
 82 |     | <span class='neutral'>     *</span>
 83 |     | <span class='neutral'>     * Requirements:</span>
 84 |     | <span class='neutral'>     *</span>
 85 |     | <span class='neutral'>     * - the caller must be `account`.</span>
 86 |     | <span class='neutral'>     */</span>
 87 |     | <span class='neutral'>    function renounceRole(bytes32 role, address account) external;</span>
 88 |     | <span class='neutral'>}</span>
 89 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.1) (proxy/utils/Initializable.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.2;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../../utils/AddressUpgradeable.sol&quot;;</span>
   7 |     | <span class='neutral'></span>
   8 |     | <span class='neutral'>/**</span>
   9 |     | <span class='neutral'> * @dev This is a base contract to aid in writing upgradeable contracts, or any kind of contract that will be deployed</span>
  10 |     | <span class='neutral'> * behind a proxy. Since proxied contracts do not make use of a constructor, it&#39;s common to move constructor logic to an</span>
  11 |     | <span class='neutral'> * external initializer function, usually called `initialize`. It then becomes necessary to protect this initializer</span>
  12 |     | <span class='neutral'> * function so it can only be called once. The {initializer} modifier provided by this contract will have this effect.</span>
  13 |     | <span class='neutral'> *</span>
  14 |     | <span class='neutral'> * The initialization functions use a version number. Once a version number is used, it is consumed and cannot be</span>
  15 |     | <span class='neutral'> * reused. This mechanism prevents re-execution of each &quot;step&quot; but allows the creation of new initialization steps in</span>
  16 |     | <span class='neutral'> * case an upgrade adds a module that needs to be initialized.</span>
  17 |     | <span class='neutral'> *</span>
  18 |     | <span class='neutral'> * For example:</span>
  19 |     | <span class='neutral'> *</span>
  20 |     | <span class='neutral'> * [.hljs-theme-light.nopadding]</span>
  21 |     | <span class='neutral'> * ```</span>
  22 |     | <span class='neutral'> * contract MyToken is ERC20Upgradeable {</span>
  23 |     | <span class='neutral'> *     function initialize() initializer public {</span>
  24 |     | <span class='neutral'> *         __ERC20_init(&quot;MyToken&quot;, &quot;MTK&quot;);</span>
  25 |     | <span class='neutral'> *     }</span>
  26 |     | <span class='neutral'> * }</span>
  27 |     | <span class='neutral'> * contract MyTokenV2 is MyToken, ERC20PermitUpgradeable {</span>
  28 |     | <span class='neutral'> *     function initializeV2() reinitializer(2) public {</span>
  29 |     | <span class='neutral'> *         __ERC20Permit_init(&quot;MyToken&quot;);</span>
  30 |     | <span class='neutral'> *     }</span>
  31 |     | <span class='neutral'> * }</span>
  32 |     | <span class='neutral'> * ```</span>
  33 |     | <span class='neutral'> *</span>
  34 |     | <span class='neutral'> * TIP: To avoid leaving the proxy in an uninitialized state, the initializer function should be called as early as</span>
  35 |     | <span class='neutral'> * possible by providing the encoded function call as the `_data` argument to {ERC1967Proxy-constructor}.</span>
  36 |     | <span class='neutral'> *</span>
  37 |     | <span class='neutral'> * CAUTION: When used with inheritance, manual care must be taken to not invoke a parent initializer twice, or to ensure</span>
  38 |     | <span class='neutral'> * that all initializers are idempotent. This is not verified automatically as constructors are by Solidity.</span>
  39 |     | <span class='neutral'> *</span>
  40 |     | <span class='neutral'> * [CAUTION]</span>
  41 |     | <span class='neutral'> * ====</span>
  42 |     | <span class='neutral'> * Avoid leaving a contract uninitialized.</span>
  43 |     | <span class='neutral'> *</span>
  44 |     | <span class='neutral'> * An uninitialized contract can be taken over by an attacker. This applies to both a proxy and its implementation</span>
  45 |     | <span class='neutral'> * contract, which may impact the proxy. To prevent the implementation contract from being used, you should invoke</span>
  46 |     | <span class='neutral'> * the {_disableInitializers} function in the constructor to automatically lock it when it is deployed:</span>
  47 |     | <span class='neutral'> *</span>
  48 |     | <span class='neutral'> * [.hljs-theme-light.nopadding]</span>
  49 |     | <span class='neutral'> * ```</span>
  50 |     | <span class='neutral'> * /// @custom:oz-upgrades-unsafe-allow constructor</span>
  51 |     | <span class='neutral'> * constructor() {</span>
  52 |     | <span class='neutral'> *     _disableInitializers();</span>
  53 |     | <span class='neutral'> * }</span>
  54 |     | <span class='neutral'> * ```</span>
  55 |     | <span class='neutral'> * ====</span>
  56 |     | <span class='neutral'> */</span>
  57 |     | <span class='neutral'>abstract contract Initializable {</span>
  58 |     | <span class='neutral'>    /**</span>
  59 |     | <span class='neutral'>     * @dev Indicates that the contract has been initialized.</span>
  60 |     | <span class='neutral'>     * @custom:oz-retyped-from bool</span>
  61 |     | <span class='neutral'>     */</span>
  62 |     | <span class='neutral'>    uint8 private _initialized;</span>
  63 |     | <span class='neutral'></span>
  64 |     | <span class='neutral'>    /**</span>
  65 |     | <span class='neutral'>     * @dev Indicates that the contract is in the process of being initialized.</span>
  66 |     | <span class='neutral'>     */</span>
  67 |     | <span class='neutral'>    bool private _initializing;</span>
  68 |     | <span class='neutral'></span>
  69 |     | <span class='neutral'>    /**</span>
  70 |     | <span class='neutral'>     * @dev Triggered when the contract has been initialized or reinitialized.</span>
  71 |     | <span class='neutral'>     */</span>
  72 |     | <span class='neutral'>    event Initialized(uint8 version);</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='neutral'>    /**</span>
  75 |     | <span class='neutral'>     * @dev A modifier that defines a protected initializer function that can be invoked at most once. In its scope,</span>
  76 |     | <span class='neutral'>     * `onlyInitializing` functions can be used to initialize parent contracts.</span>
  77 |     | <span class='neutral'>     *</span>
  78 |     | <span class='neutral'>     * Similar to `reinitializer(1)`, except that functions marked with `initializer` can be nested in the context of a</span>
  79 |     | <span class='neutral'>     * constructor.</span>
  80 |     | <span class='neutral'>     *</span>
  81 |     | <span class='neutral'>     * Emits an {Initialized} event.</span>
  82 |     | <span class='neutral'>     */</span>
  83 |     | <span class='neutral'>    modifier initializer() {</span>
  84 | *   | <span class='executed'>        bool isTopLevelCall = !_initializing;</span>
  85 |     | <span class='neutral'>        require(</span>
  86 | *   | <span class='executed'>            (isTopLevelCall &amp;&amp; _initialized &lt; 1) || (!AddressUpgradeable.isContract(address(this)) &amp;&amp; _initialized == 1),</span>
  87 |     | <span class='neutral'>            &quot;Initializable: contract is already initialized&quot;</span>
  88 |     | <span class='neutral'>        );</span>
  89 |     | <span class='neutral'>        _initialized = 1;</span>
  90 | *   | <span class='executed'>        if (isTopLevelCall) {</span>
  91 |     | <span class='neutral'>            _initializing = true;</span>
  92 |     | <span class='neutral'>        }</span>
  93 |     | <span class='neutral'>        _;</span>
  94 | *   | <span class='executed'>        if (isTopLevelCall) {</span>
  95 |     | <span class='neutral'>            _initializing = false;</span>
  96 | *   | <span class='executed'>            emit Initialized(1);</span>
  97 |     | <span class='neutral'>        }</span>
  98 |     | <span class='neutral'>    }</span>
  99 |     | <span class='neutral'></span>
 100 |     | <span class='neutral'>    /**</span>
 101 |     | <span class='neutral'>     * @dev A modifier that defines a protected reinitializer function that can be invoked at most once, and only if the</span>
 102 |     | <span class='neutral'>     * contract hasn&#39;t been initialized to a greater version before. In its scope, `onlyInitializing` functions can be</span>
 103 |     | <span class='neutral'>     * used to initialize parent contracts.</span>
 104 |     | <span class='neutral'>     *</span>
 105 |     | <span class='neutral'>     * A reinitializer may be used after the original initialization step. This is essential to configure modules that</span>
 106 |     | <span class='neutral'>     * are added through upgrades and that require initialization.</span>
 107 |     | <span class='neutral'>     *</span>
 108 |     | <span class='neutral'>     * When `version` is 1, this modifier is similar to `initializer`, except that functions marked with `reinitializer`</span>
 109 |     | <span class='neutral'>     * cannot be nested. If one is invoked in the context of another, execution will revert.</span>
 110 |     | <span class='neutral'>     *</span>
 111 |     | <span class='neutral'>     * Note that versions can jump in increments greater than 1; this implies that if multiple reinitializers coexist in</span>
 112 |     | <span class='neutral'>     * a contract, executing them in the right order is up to the developer or operator.</span>
 113 |     | <span class='neutral'>     *</span>
 114 |     | <span class='neutral'>     * WARNING: setting the version to 255 will prevent any future reinitialization.</span>
 115 |     | <span class='neutral'>     *</span>
 116 |     | <span class='neutral'>     * Emits an {Initialized} event.</span>
 117 |     | <span class='neutral'>     */</span>
 118 |     | <span class='neutral'>    modifier reinitializer(uint8 version) {</span>
 119 |     | <span class='neutral'>        require(!_initializing &amp;&amp; _initialized &lt; version, &quot;Initializable: contract is already initialized&quot;);</span>
 120 |     | <span class='neutral'>        _initialized = version;</span>
 121 |     | <span class='neutral'>        _initializing = true;</span>
 122 |     | <span class='neutral'>        _;</span>
 123 |     | <span class='neutral'>        _initializing = false;</span>
 124 |     | <span class='neutral'>        emit Initialized(version);</span>
 125 |     | <span class='neutral'>    }</span>
 126 |     | <span class='neutral'></span>
 127 |     | <span class='neutral'>    /**</span>
 128 |     | <span class='neutral'>     * @dev Modifier to protect an initialization function so that it can only be invoked by functions with the</span>
 129 |     | <span class='neutral'>     * {initializer} and {reinitializer} modifiers, directly or indirectly.</span>
 130 |     | <span class='neutral'>     */</span>
 131 |     | <span class='neutral'>    modifier onlyInitializing() {</span>
 132 | *   | <span class='executed'>        require(_initializing, &quot;Initializable: contract is not initializing&quot;);</span>
 133 |     | <span class='neutral'>        _;</span>
 134 |     | <span class='neutral'>    }</span>
 135 |     | <span class='neutral'></span>
 136 |     | <span class='neutral'>    /**</span>
 137 |     | <span class='neutral'>     * @dev Locks the contract, preventing any future reinitialization. This cannot be part of an initializer call.</span>
 138 |     | <span class='neutral'>     * Calling this in the constructor of a contract will prevent that contract from being initialized or reinitialized</span>
 139 |     | <span class='neutral'>     * to any version. It is recommended to use this to lock implementation contracts that are designed to be called</span>
 140 |     | <span class='neutral'>     * through proxies.</span>
 141 |     | <span class='neutral'>     *</span>
 142 |     | <span class='neutral'>     * Emits an {Initialized} event the first time it is successfully executed.</span>
 143 |     | <span class='neutral'>     */</span>
 144 |     | <span class='neutral'>    function _disableInitializers() internal virtual {</span>
 145 |     | <span class='unexecuted'>        require(!_initializing, &quot;Initializable: contract is initializing&quot;);</span>
 146 |     | <span class='unexecuted'>        if (_initialized &lt; type(uint8).max) {</span>
 147 |     | <span class='neutral'>            _initialized = type(uint8).max;</span>
 148 |     | <span class='unexecuted'>            emit Initialized(type(uint8).max);</span>
 149 |     | <span class='neutral'>        }</span>
 150 |     | <span class='neutral'>    }</span>
 151 |     | <span class='neutral'></span>
 152 |     | <span class='neutral'>    /**</span>
 153 |     | <span class='neutral'>     * @dev Returns the highest version that has been initialized. See {reinitializer}.</span>
 154 |     | <span class='neutral'>     */</span>
 155 |     | <span class='neutral'>    function _getInitializedVersion() internal view returns (uint8) {</span>
 156 |     | <span class='neutral'>        return _initialized;</span>
 157 |     | <span class='neutral'>    }</span>
 158 |     | <span class='neutral'></span>
 159 |     | <span class='neutral'>    /**</span>
 160 |     | <span class='neutral'>     * @dev Returns `true` if the contract is currently initializing. See {onlyInitializing}.</span>
 161 |     | <span class='neutral'>     */</span>
 162 |     | <span class='neutral'>    function _isInitializing() internal view returns (bool) {</span>
 163 |     | <span class='neutral'>        return _initializing;</span>
 164 |     | <span class='neutral'>    }</span>
 165 |     | <span class='neutral'>}</span>
 166 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/security/PausableUpgradeable.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.7.0) (security/Pausable.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../utils/ContextUpgradeable.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../proxy/utils/Initializable.sol&quot;;</span>
   8 |     | <span class='neutral'></span>
   9 |     | <span class='neutral'>/**</span>
  10 |     | <span class='neutral'> * @dev Contract module which allows children to implement an emergency stop</span>
  11 |     | <span class='neutral'> * mechanism that can be triggered by an authorized account.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * This module is used through inheritance. It will make available the</span>
  14 |     | <span class='neutral'> * modifiers `whenNotPaused` and `whenPaused`, which can be applied to</span>
  15 |     | <span class='neutral'> * the functions of your contract. Note that they will not be pausable by</span>
  16 |     | <span class='neutral'> * simply including this module, only once the modifiers are put in place.</span>
  17 |     | <span class='neutral'> */</span>
  18 |     | <span class='neutral'>abstract contract PausableUpgradeable is Initializable, ContextUpgradeable {</span>
  19 |     | <span class='neutral'>    /**</span>
  20 |     | <span class='neutral'>     * @dev Emitted when the pause is triggered by `account`.</span>
  21 |     | <span class='neutral'>     */</span>
  22 |     | <span class='neutral'>    event Paused(address account);</span>
  23 |     | <span class='neutral'></span>
  24 |     | <span class='neutral'>    /**</span>
  25 |     | <span class='neutral'>     * @dev Emitted when the pause is lifted by `account`.</span>
  26 |     | <span class='neutral'>     */</span>
  27 |     | <span class='neutral'>    event Unpaused(address account);</span>
  28 |     | <span class='neutral'></span>
  29 |     | <span class='neutral'>    bool private _paused;</span>
  30 |     | <span class='neutral'></span>
  31 |     | <span class='neutral'>    /**</span>
  32 |     | <span class='neutral'>     * @dev Initializes the contract in unpaused state.</span>
  33 |     | <span class='neutral'>     */</span>
  34 |     | <span class='neutral'>    function __Pausable_init() internal onlyInitializing {</span>
  35 |     | <span class='neutral'>        __Pausable_init_unchained();</span>
  36 |     | <span class='neutral'>    }</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    function __Pausable_init_unchained() internal onlyInitializing {</span>
  39 | *   | <span class='executed'>        _paused = false;</span>
  40 |     | <span class='neutral'>    }</span>
  41 |     | <span class='neutral'></span>
  42 |     | <span class='neutral'>    /**</span>
  43 |     | <span class='neutral'>     * @dev Modifier to make a function callable only when the contract is not paused.</span>
  44 |     | <span class='neutral'>     *</span>
  45 |     | <span class='neutral'>     * Requirements:</span>
  46 |     | <span class='neutral'>     *</span>
  47 |     | <span class='neutral'>     * - The contract must not be paused.</span>
  48 |     | <span class='neutral'>     */</span>
  49 | *   | <span class='executed'>    modifier whenNotPaused() {</span>
  50 |     | <span class='neutral'>        _requireNotPaused();</span>
  51 |     | <span class='unexecuted'>        _;</span>
  52 |     | <span class='neutral'>    }</span>
  53 |     | <span class='neutral'></span>
  54 |     | <span class='neutral'>    /**</span>
  55 |     | <span class='neutral'>     * @dev Modifier to make a function callable only when the contract is paused.</span>
  56 |     | <span class='neutral'>     *</span>
  57 |     | <span class='neutral'>     * Requirements:</span>
  58 |     | <span class='neutral'>     *</span>
  59 |     | <span class='neutral'>     * - The contract must be paused.</span>
  60 |     | <span class='neutral'>     */</span>
  61 |     | <span class='neutral'>    modifier whenPaused() {</span>
  62 |     | <span class='neutral'>        _requirePaused();</span>
  63 |     | <span class='neutral'>        _;</span>
  64 |     | <span class='neutral'>    }</span>
  65 |     | <span class='neutral'></span>
  66 |     | <span class='neutral'>    /**</span>
  67 |     | <span class='neutral'>     * @dev Returns true if the contract is paused, and false otherwise.</span>
  68 |     | <span class='neutral'>     */</span>
  69 |     | <span class='neutral'>    function paused() public view virtual returns (bool) {</span>
  70 | *   | <span class='executed'>        return _paused;</span>
  71 |     | <span class='neutral'>    }</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='neutral'>    /**</span>
  74 |     | <span class='neutral'>     * @dev Throws if the contract is paused.</span>
  75 |     | <span class='neutral'>     */</span>
  76 | *   | <span class='executed'>    function _requireNotPaused() internal view virtual {</span>
  77 |     | <span class='neutral'>        require(!paused(), &quot;Pausable: paused&quot;);</span>
  78 |     | <span class='neutral'>    }</span>
  79 |     | <span class='neutral'></span>
  80 |     | <span class='neutral'>    /**</span>
  81 |     | <span class='neutral'>     * @dev Throws if the contract is not paused.</span>
  82 |     | <span class='neutral'>     */</span>
  83 |     | <span class='neutral'>    function _requirePaused() internal view virtual {</span>
  84 |     | <span class='neutral'>        require(paused(), &quot;Pausable: not paused&quot;);</span>
  85 |     | <span class='neutral'>    }</span>
  86 |     | <span class='neutral'></span>
  87 |     | <span class='neutral'>    /**</span>
  88 |     | <span class='neutral'>     * @dev Triggers stopped state.</span>
  89 |     | <span class='neutral'>     *</span>
  90 |     | <span class='neutral'>     * Requirements:</span>
  91 |     | <span class='neutral'>     *</span>
  92 |     | <span class='neutral'>     * - The contract must not be paused.</span>
  93 |     | <span class='neutral'>     */</span>
  94 |     | <span class='neutral'>    function _pause() internal virtual whenNotPaused {</span>
  95 |     | <span class='unexecuted'>        _paused = true;</span>
  96 |     | <span class='unexecuted'>        emit Paused(_msgSender());</span>
  97 |     | <span class='neutral'>    }</span>
  98 |     | <span class='neutral'></span>
  99 |     | <span class='neutral'>    /**</span>
 100 |     | <span class='neutral'>     * @dev Returns to normal state.</span>
 101 |     | <span class='neutral'>     *</span>
 102 |     | <span class='neutral'>     * Requirements:</span>
 103 |     | <span class='neutral'>     *</span>
 104 |     | <span class='neutral'>     * - The contract must be paused.</span>
 105 |     | <span class='neutral'>     */</span>
 106 |     | <span class='neutral'>    function _unpause() internal virtual whenPaused {</span>
 107 |     | <span class='neutral'>        _paused = false;</span>
 108 |     | <span class='unexecuted'>        emit Unpaused(_msgSender());</span>
 109 |     | <span class='neutral'>    }</span>
 110 |     | <span class='neutral'></span>
 111 |     | <span class='neutral'>    /**</span>
 112 |     | <span class='neutral'>     * @dev This empty reserved space is put in place to allow future versions to add new</span>
 113 |     | <span class='neutral'>     * variables without shifting down storage in the inheritance chain.</span>
 114 |     | <span class='neutral'>     * See https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps</span>
 115 |     | <span class='neutral'>     */</span>
 116 |     | <span class='neutral'>    uint256[49] private __gap;</span>
 117 |     | <span class='neutral'>}</span>
 118 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/security/ReentrancyGuardUpgradeable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (security/ReentrancyGuard.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'>import &quot;../proxy/utils/Initializable.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @dev Contract module that helps prevent reentrant calls to a function.</span>
  9 |     | <span class='neutral'> *</span>
 10 |     | <span class='neutral'> * Inheriting from `ReentrancyGuard` will make the {nonReentrant} modifier</span>
 11 |     | <span class='neutral'> * available, which can be applied to functions to make sure there are no nested</span>
 12 |     | <span class='neutral'> * (reentrant) calls to them.</span>
 13 |     | <span class='neutral'> *</span>
 14 |     | <span class='neutral'> * Note that because there is a single `nonReentrant` guard, functions marked as</span>
 15 |     | <span class='neutral'> * `nonReentrant` may not call one another. This can be worked around by making</span>
 16 |     | <span class='neutral'> * those functions `private`, and then adding `external` `nonReentrant` entry</span>
 17 |     | <span class='neutral'> * points to them.</span>
 18 |     | <span class='neutral'> *</span>
 19 |     | <span class='neutral'> * TIP: If you would like to learn more about reentrancy and alternative ways</span>
 20 |     | <span class='neutral'> * to protect against it, check out our blog post</span>
 21 |     | <span class='neutral'> * https://blog.openzeppelin.com/reentrancy-after-istanbul/[Reentrancy After Istanbul].</span>
 22 |     | <span class='neutral'> */</span>
 23 |     | <span class='neutral'>abstract contract ReentrancyGuardUpgradeable is Initializable {</span>
 24 |     | <span class='neutral'>    // Booleans are more expensive than uint256 or any type that takes up a full</span>
 25 |     | <span class='neutral'>    // word because each write operation emits an extra SLOAD to first read the</span>
 26 |     | <span class='neutral'>    // slot&#39;s contents, replace the bits taken up by the boolean, and then write</span>
 27 |     | <span class='neutral'>    // back. This is the compiler&#39;s defense against contract upgrades and</span>
 28 |     | <span class='neutral'>    // pointer aliasing, and it cannot be disabled.</span>
 29 |     | <span class='neutral'></span>
 30 |     | <span class='neutral'>    // The values being non-zero value makes deployment a bit more expensive,</span>
 31 |     | <span class='neutral'>    // but in exchange the refund on every call to nonReentrant will be lower in</span>
 32 |     | <span class='neutral'>    // amount. Since refunds are capped to a percentage of the total</span>
 33 |     | <span class='neutral'>    // transaction&#39;s gas, it is best to keep them low in cases like this one, to</span>
 34 |     | <span class='neutral'>    // increase the likelihood of the full refund coming into effect.</span>
 35 | *   | <span class='executed'>    uint256 private constant _NOT_ENTERED = 1;</span>
 36 | *   | <span class='executed'>    uint256 private constant _ENTERED = 2;</span>
 37 |     | <span class='neutral'></span>
 38 |     | <span class='neutral'>    uint256 private _status;</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='neutral'>    function __ReentrancyGuard_init() internal onlyInitializing {</span>
 41 |     | <span class='neutral'>        __ReentrancyGuard_init_unchained();</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'></span>
 44 |     | <span class='neutral'>    function __ReentrancyGuard_init_unchained() internal onlyInitializing {</span>
 45 |     | <span class='neutral'>        _status = _NOT_ENTERED;</span>
 46 |     | <span class='neutral'>    }</span>
 47 |     | <span class='neutral'></span>
 48 |     | <span class='neutral'>    /**</span>
 49 |     | <span class='neutral'>     * @dev Prevents a contract from calling itself, directly or indirectly.</span>
 50 |     | <span class='neutral'>     * Calling a `nonReentrant` function from another `nonReentrant`</span>
 51 |     | <span class='neutral'>     * function is not supported. It is possible to prevent this from happening</span>
 52 |     | <span class='neutral'>     * by making the `nonReentrant` function external, and making it call a</span>
 53 |     | <span class='neutral'>     * `private` function that does the actual work.</span>
 54 |     | <span class='neutral'>     */</span>
 55 | *   | <span class='executed'>    modifier nonReentrant() {</span>
 56 |     | <span class='neutral'>        _nonReentrantBefore();</span>
 57 | *   | <span class='executed'>        _;</span>
 58 |     | <span class='neutral'>        _nonReentrantAfter();</span>
 59 |     | <span class='neutral'>    }</span>
 60 |     | <span class='neutral'></span>
 61 | *   | <span class='executed'>    function _nonReentrantBefore() private {</span>
 62 |     | <span class='neutral'>        // On the first call to nonReentrant, _status will be _NOT_ENTERED</span>
 63 | *   | <span class='executed'>        require(_status != _ENTERED, &quot;ReentrancyGuard: reentrant call&quot;);</span>
 64 |     | <span class='neutral'></span>
 65 |     | <span class='neutral'>        // Any calls to nonReentrant after this point will fail</span>
 66 |     | <span class='neutral'>        _status = _ENTERED;</span>
 67 |     | <span class='neutral'>    }</span>
 68 |     | <span class='neutral'></span>
 69 |     | <span class='neutral'>    function _nonReentrantAfter() private {</span>
 70 |     | <span class='neutral'>        // By storing the original value once again, a refund is triggered (see</span>
 71 |     | <span class='neutral'>        // https://eips.ethereum.org/EIPS/eip-2200)</span>
 72 | *   | <span class='executed'>        _status = _NOT_ENTERED;</span>
 73 |     | <span class='neutral'>    }</span>
 74 |     | <span class='neutral'></span>
 75 |     | <span class='neutral'>    /**</span>
 76 |     | <span class='neutral'>     * @dev This empty reserved space is put in place to allow future versions to add new</span>
 77 |     | <span class='neutral'>     * variables without shifting down storage in the inheritance chain.</span>
 78 |     | <span class='neutral'>     * See https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps</span>
 79 |     | <span class='neutral'>     */</span>
 80 |     | <span class='neutral'>    uint256[49] private __gap;</span>
 81 |     | <span class='neutral'>}</span>
 82 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/token/ERC20/IERC20Upgradeable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.6.0) (token/ERC20/IERC20.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC20 standard as defined in the EIP.</span>
  8 |     | <span class='neutral'> */</span>
  9 |     | <span class='neutral'>interface IERC20Upgradeable {</span>
 10 |     | <span class='neutral'>    /**</span>
 11 |     | <span class='neutral'>     * @dev Emitted when `value` tokens are moved from one account (`from`) to</span>
 12 |     | <span class='neutral'>     * another (`to`).</span>
 13 |     | <span class='neutral'>     *</span>
 14 |     | <span class='neutral'>     * Note that `value` may be zero.</span>
 15 |     | <span class='neutral'>     */</span>
 16 |     | <span class='neutral'>    event Transfer(address indexed from, address indexed to, uint256 value);</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='neutral'>    /**</span>
 19 |     | <span class='neutral'>     * @dev Emitted when the allowance of a `spender` for an `owner` is set by</span>
 20 |     | <span class='neutral'>     * a call to {approve}. `value` is the new allowance.</span>
 21 |     | <span class='neutral'>     */</span>
 22 |     | <span class='neutral'>    event Approval(address indexed owner, address indexed spender, uint256 value);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the amount of tokens in existence.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function totalSupply() external view returns (uint256);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    /**</span>
 30 |     | <span class='neutral'>     * @dev Returns the amount of tokens owned by `account`.</span>
 31 |     | <span class='neutral'>     */</span>
 32 |     | <span class='neutral'>    function balanceOf(address account) external view returns (uint256);</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    /**</span>
 35 |     | <span class='neutral'>     * @dev Moves `amount` tokens from the caller&#39;s account to `to`.</span>
 36 |     | <span class='neutral'>     *</span>
 37 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 38 |     | <span class='neutral'>     *</span>
 39 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 40 |     | <span class='neutral'>     */</span>
 41 |     | <span class='neutral'>    function transfer(address to, uint256 amount) external returns (bool);</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='neutral'>    /**</span>
 44 |     | <span class='neutral'>     * @dev Returns the remaining number of tokens that `spender` will be</span>
 45 |     | <span class='neutral'>     * allowed to spend on behalf of `owner` through {transferFrom}. This is</span>
 46 |     | <span class='neutral'>     * zero by default.</span>
 47 |     | <span class='neutral'>     *</span>
 48 |     | <span class='neutral'>     * This value changes when {approve} or {transferFrom} are called.</span>
 49 |     | <span class='neutral'>     */</span>
 50 |     | <span class='neutral'>    function allowance(address owner, address spender) external view returns (uint256);</span>
 51 |     | <span class='neutral'></span>
 52 |     | <span class='neutral'>    /**</span>
 53 |     | <span class='neutral'>     * @dev Sets `amount` as the allowance of `spender` over the caller&#39;s tokens.</span>
 54 |     | <span class='neutral'>     *</span>
 55 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 56 |     | <span class='neutral'>     *</span>
 57 |     | <span class='neutral'>     * IMPORTANT: Beware that changing an allowance with this method brings the risk</span>
 58 |     | <span class='neutral'>     * that someone may use both the old and the new allowance by unfortunate</span>
 59 |     | <span class='neutral'>     * transaction ordering. One possible solution to mitigate this race</span>
 60 |     | <span class='neutral'>     * condition is to first reduce the spender&#39;s allowance to 0 and set the</span>
 61 |     | <span class='neutral'>     * desired value afterwards:</span>
 62 |     | <span class='neutral'>     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729</span>
 63 |     | <span class='neutral'>     *</span>
 64 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 65 |     | <span class='neutral'>     */</span>
 66 |     | <span class='neutral'>    function approve(address spender, uint256 amount) external returns (bool);</span>
 67 |     | <span class='neutral'></span>
 68 |     | <span class='neutral'>    /**</span>
 69 |     | <span class='neutral'>     * @dev Moves `amount` tokens from `from` to `to` using the</span>
 70 |     | <span class='neutral'>     * allowance mechanism. `amount` is then deducted from the caller&#39;s</span>
 71 |     | <span class='neutral'>     * allowance.</span>
 72 |     | <span class='neutral'>     *</span>
 73 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 74 |     | <span class='neutral'>     *</span>
 75 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 76 |     | <span class='neutral'>     */</span>
 77 |     | <span class='neutral'>    function transferFrom(</span>
 78 |     | <span class='neutral'>        address from,</span>
 79 |     | <span class='neutral'>        address to,</span>
 80 |     | <span class='neutral'>        uint256 amount</span>
 81 |     | <span class='neutral'>    ) external returns (bool);</span>
 82 |     | <span class='neutral'>}</span>
 83 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (token/ERC20/extensions/IERC20Metadata.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../IERC20Upgradeable.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Interface for the optional metadata functions from the ERC20 standard.</span>
 10 |     | <span class='neutral'> *</span>
 11 |     | <span class='neutral'> * _Available since v4.1._</span>
 12 |     | <span class='neutral'> */</span>
 13 |     | <span class='neutral'>interface IERC20MetadataUpgradeable is IERC20Upgradeable {</span>
 14 |     | <span class='neutral'>    /**</span>
 15 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
 16 |     | <span class='neutral'>     */</span>
 17 |     | <span class='neutral'>    function name() external view returns (string memory);</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    /**</span>
 20 |     | <span class='neutral'>     * @dev Returns the symbol of the token.</span>
 21 |     | <span class='neutral'>     */</span>
 22 |     | <span class='neutral'>    function symbol() external view returns (string memory);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the decimals places of the token.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function decimals() external view returns (uint8);</span>
 28 |     | <span class='neutral'>}</span>
 29 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/token/ERC20/extensions/draft-IERC20PermitUpgradeable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (token/ERC20/extensions/draft-IERC20Permit.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC20 Permit extension allowing approvals to be made via signatures, as defined in</span>
  8 |     | <span class='neutral'> * https://eips.ethereum.org/EIPS/eip-2612[EIP-2612].</span>
  9 |     | <span class='neutral'> *</span>
 10 |     | <span class='neutral'> * Adds the {permit} method, which can be used to change an account&#39;s ERC20 allowance (see {IERC20-allowance}) by</span>
 11 |     | <span class='neutral'> * presenting a message signed by the account. By not relying on {IERC20-approve}, the token holder account doesn&#39;t</span>
 12 |     | <span class='neutral'> * need to send a transaction, and thus is not required to hold Ether at all.</span>
 13 |     | <span class='neutral'> */</span>
 14 |     | <span class='neutral'>interface IERC20PermitUpgradeable {</span>
 15 |     | <span class='neutral'>    /**</span>
 16 |     | <span class='neutral'>     * @dev Sets `value` as the allowance of `spender` over ``owner``&#39;s tokens,</span>
 17 |     | <span class='neutral'>     * given ``owner``&#39;s signed approval.</span>
 18 |     | <span class='neutral'>     *</span>
 19 |     | <span class='neutral'>     * IMPORTANT: The same issues {IERC20-approve} has related to transaction</span>
 20 |     | <span class='neutral'>     * ordering also apply here.</span>
 21 |     | <span class='neutral'>     *</span>
 22 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 23 |     | <span class='neutral'>     *</span>
 24 |     | <span class='neutral'>     * Requirements:</span>
 25 |     | <span class='neutral'>     *</span>
 26 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 27 |     | <span class='neutral'>     * - `deadline` must be a timestamp in the future.</span>
 28 |     | <span class='neutral'>     * - `v`, `r` and `s` must be a valid `secp256k1` signature from `owner`</span>
 29 |     | <span class='neutral'>     * over the EIP712-formatted function arguments.</span>
 30 |     | <span class='neutral'>     * - the signature must use ``owner``&#39;s current nonce (see {nonces}).</span>
 31 |     | <span class='neutral'>     *</span>
 32 |     | <span class='neutral'>     * For more information on the signature format, see the</span>
 33 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-2612#specification[relevant EIP</span>
 34 |     | <span class='neutral'>     * section].</span>
 35 |     | <span class='neutral'>     */</span>
 36 |     | <span class='neutral'>    function permit(</span>
 37 |     | <span class='neutral'>        address owner,</span>
 38 |     | <span class='neutral'>        address spender,</span>
 39 |     | <span class='neutral'>        uint256 value,</span>
 40 |     | <span class='neutral'>        uint256 deadline,</span>
 41 |     | <span class='neutral'>        uint8 v,</span>
 42 |     | <span class='neutral'>        bytes32 r,</span>
 43 |     | <span class='neutral'>        bytes32 s</span>
 44 |     | <span class='neutral'>    ) external;</span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'>    /**</span>
 47 |     | <span class='neutral'>     * @dev Returns the current nonce for `owner`. This value must be</span>
 48 |     | <span class='neutral'>     * included whenever a signature is generated for {permit}.</span>
 49 |     | <span class='neutral'>     *</span>
 50 |     | <span class='neutral'>     * Every successful call to {permit} increases ``owner``&#39;s nonce by one. This</span>
 51 |     | <span class='neutral'>     * prevents a signature from being used multiple times.</span>
 52 |     | <span class='neutral'>     */</span>
 53 |     | <span class='neutral'>    function nonces(address owner) external view returns (uint256);</span>
 54 |     | <span class='neutral'></span>
 55 |     | <span class='neutral'>    /**</span>
 56 |     | <span class='neutral'>     * @dev Returns the domain separator used in the encoding of the signature for {permit}, as defined by {EIP712}.</span>
 57 |     | <span class='neutral'>     */</span>
 58 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
 59 |     | <span class='neutral'>    function DOMAIN_SEPARATOR() external view returns (bytes32);</span>
 60 |     | <span class='neutral'>}</span>
 61 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (token/ERC20/utils/SafeERC20.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../IERC20Upgradeable.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../extensions/draft-IERC20PermitUpgradeable.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../../../utils/AddressUpgradeable.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @title SafeERC20</span>
  12 |     | <span class='neutral'> * @dev Wrappers around ERC20 operations that throw on failure (when the token</span>
  13 |     | <span class='neutral'> * contract returns false). Tokens that return no value (and instead revert or</span>
  14 |     | <span class='neutral'> * throw on failure) are also supported, non-reverting calls are assumed to be</span>
  15 |     | <span class='neutral'> * successful.</span>
  16 |     | <span class='neutral'> * To use this library you can add a `using SafeERC20 for IERC20;` statement to your contract,</span>
  17 |     | <span class='neutral'> * which allows you to call the safe operations as `token.safeTransfer(...)`, etc.</span>
  18 |     | <span class='neutral'> */</span>
  19 |     | <span class='unexecuted'>library SafeERC20Upgradeable {</span>
  20 |     | <span class='neutral'>    using AddressUpgradeable for address;</span>
  21 |     | <span class='neutral'></span>
  22 | *   | <span class='executed'>    function safeTransfer(</span>
  23 |     | <span class='neutral'>        IERC20Upgradeable token,</span>
  24 |     | <span class='neutral'>        address to,</span>
  25 |     | <span class='neutral'>        uint256 value</span>
  26 |     | <span class='neutral'>    ) internal {</span>
  27 | *   | <span class='executed'>        _callOptionalReturn(token, abi.encodeWithSelector(token.transfer.selector, to, value));</span>
  28 |     | <span class='neutral'>    }</span>
  29 |     | <span class='neutral'></span>
  30 | *   | <span class='executed'>    function safeTransferFrom(</span>
  31 |     | <span class='neutral'>        IERC20Upgradeable token,</span>
  32 |     | <span class='neutral'>        address from,</span>
  33 |     | <span class='neutral'>        address to,</span>
  34 |     | <span class='neutral'>        uint256 value</span>
  35 |     | <span class='neutral'>    ) internal {</span>
  36 | *   | <span class='executed'>        _callOptionalReturn(token, abi.encodeWithSelector(token.transferFrom.selector, from, to, value));</span>
  37 |     | <span class='neutral'>    }</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>    /**</span>
  40 |     | <span class='neutral'>     * @dev Deprecated. This function has issues similar to the ones found in</span>
  41 |     | <span class='neutral'>     * {IERC20-approve}, and its usage is discouraged.</span>
  42 |     | <span class='neutral'>     *</span>
  43 |     | <span class='neutral'>     * Whenever possible, use {safeIncreaseAllowance} and</span>
  44 |     | <span class='neutral'>     * {safeDecreaseAllowance} instead.</span>
  45 |     | <span class='neutral'>     */</span>
  46 |     | <span class='neutral'>    function safeApprove(</span>
  47 |     | <span class='neutral'>        IERC20Upgradeable token,</span>
  48 |     | <span class='neutral'>        address spender,</span>
  49 |     | <span class='neutral'>        uint256 value</span>
  50 |     | <span class='neutral'>    ) internal {</span>
  51 |     | <span class='neutral'>        // safeApprove should only be called when setting an initial allowance,</span>
  52 |     | <span class='neutral'>        // or when resetting it to zero. To increase and decrease it, use</span>
  53 |     | <span class='neutral'>        // &#39;safeIncreaseAllowance&#39; and &#39;safeDecreaseAllowance&#39;</span>
  54 |     | <span class='neutral'>        require(</span>
  55 |     | <span class='neutral'>            (value == 0) || (token.allowance(address(this), spender) == 0),</span>
  56 |     | <span class='neutral'>            &quot;SafeERC20: approve from non-zero to non-zero allowance&quot;</span>
  57 |     | <span class='neutral'>        );</span>
  58 |     | <span class='neutral'>        _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, value));</span>
  59 |     | <span class='neutral'>    }</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    function safeIncreaseAllowance(</span>
  62 |     | <span class='neutral'>        IERC20Upgradeable token,</span>
  63 |     | <span class='neutral'>        address spender,</span>
  64 |     | <span class='neutral'>        uint256 value</span>
  65 |     | <span class='neutral'>    ) internal {</span>
  66 |     | <span class='neutral'>        uint256 newAllowance = token.allowance(address(this), spender) + value;</span>
  67 |     | <span class='neutral'>        _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, newAllowance));</span>
  68 |     | <span class='neutral'>    }</span>
  69 |     | <span class='neutral'></span>
  70 |     | <span class='neutral'>    function safeDecreaseAllowance(</span>
  71 |     | <span class='neutral'>        IERC20Upgradeable token,</span>
  72 |     | <span class='neutral'>        address spender,</span>
  73 |     | <span class='neutral'>        uint256 value</span>
  74 |     | <span class='neutral'>    ) internal {</span>
  75 |     | <span class='neutral'>        unchecked {</span>
  76 |     | <span class='neutral'>            uint256 oldAllowance = token.allowance(address(this), spender);</span>
  77 |     | <span class='neutral'>            require(oldAllowance &gt;= value, &quot;SafeERC20: decreased allowance below zero&quot;);</span>
  78 |     | <span class='neutral'>            uint256 newAllowance = oldAllowance - value;</span>
  79 |     | <span class='neutral'>            _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, newAllowance));</span>
  80 |     | <span class='neutral'>        }</span>
  81 |     | <span class='neutral'>    }</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    function safePermit(</span>
  84 |     | <span class='neutral'>        IERC20PermitUpgradeable token,</span>
  85 |     | <span class='neutral'>        address owner,</span>
  86 |     | <span class='neutral'>        address spender,</span>
  87 |     | <span class='neutral'>        uint256 value,</span>
  88 |     | <span class='neutral'>        uint256 deadline,</span>
  89 |     | <span class='neutral'>        uint8 v,</span>
  90 |     | <span class='neutral'>        bytes32 r,</span>
  91 |     | <span class='neutral'>        bytes32 s</span>
  92 |     | <span class='neutral'>    ) internal {</span>
  93 |     | <span class='neutral'>        uint256 nonceBefore = token.nonces(owner);</span>
  94 |     | <span class='neutral'>        token.permit(owner, spender, value, deadline, v, r, s);</span>
  95 |     | <span class='neutral'>        uint256 nonceAfter = token.nonces(owner);</span>
  96 |     | <span class='neutral'>        require(nonceAfter == nonceBefore + 1, &quot;SafeERC20: permit did not succeed&quot;);</span>
  97 |     | <span class='neutral'>    }</span>
  98 |     | <span class='neutral'></span>
  99 |     | <span class='neutral'>    /**</span>
 100 |     | <span class='neutral'>     * @dev Imitates a Solidity high-level call (i.e. a regular function call to a contract), relaxing the requirement</span>
 101 |     | <span class='neutral'>     * on the return value: the return value is optional (but if data is returned, it must not be false).</span>
 102 |     | <span class='neutral'>     * @param token The token targeted by the call.</span>
 103 |     | <span class='neutral'>     * @param data The call data (encoded using abi.encode or one of its variants).</span>
 104 |     | <span class='neutral'>     */</span>
 105 | *   | <span class='executed'>    function _callOptionalReturn(IERC20Upgradeable token, bytes memory data) private {</span>
 106 |     | <span class='neutral'>        // We need to perform a low level call here, to bypass Solidity&#39;s return data size checking mechanism, since</span>
 107 |     | <span class='neutral'>        // we&#39;re implementing it ourselves. We use {Address-functionCall} to perform this call, which verifies that</span>
 108 |     | <span class='neutral'>        // the target address contains contract code and also asserts for success in the low-level call.</span>
 109 |     | <span class='neutral'></span>
 110 |     | <span class='neutral'>        bytes memory returndata = address(token).functionCall(data, &quot;SafeERC20: low-level call failed&quot;);</span>
 111 | *   | <span class='executed'>        if (returndata.length &gt; 0) {</span>
 112 |     | <span class='neutral'>            // Return data is optional</span>
 113 | *   | <span class='executed'>            require(abi.decode(returndata, (bool)), &quot;SafeERC20: ERC20 operation did not succeed&quot;);</span>
 114 |     | <span class='neutral'>        }</span>
 115 |     | <span class='neutral'>    }</span>
 116 |     | <span class='neutral'>}</span>
 117 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/utils/AddressUpgradeable.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/Address.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.1;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>/**</span>
   7 |     | <span class='neutral'> * @dev Collection of functions related to the address type</span>
   8 |     | <span class='neutral'> */</span>
   9 |     | <span class='unexecuted'>library AddressUpgradeable {</span>
  10 |     | <span class='neutral'>    /**</span>
  11 |     | <span class='neutral'>     * @dev Returns true if `account` is a contract.</span>
  12 |     | <span class='neutral'>     *</span>
  13 |     | <span class='neutral'>     * [IMPORTANT]</span>
  14 |     | <span class='neutral'>     * ====</span>
  15 |     | <span class='neutral'>     * It is unsafe to assume that an address for which this function returns</span>
  16 |     | <span class='neutral'>     * false is an externally-owned account (EOA) and not a contract.</span>
  17 |     | <span class='neutral'>     *</span>
  18 |     | <span class='neutral'>     * Among others, `isContract` will return false for the following</span>
  19 |     | <span class='neutral'>     * types of addresses:</span>
  20 |     | <span class='neutral'>     *</span>
  21 |     | <span class='neutral'>     *  - an externally-owned account</span>
  22 |     | <span class='neutral'>     *  - a contract in construction</span>
  23 |     | <span class='neutral'>     *  - an address where a contract will be created</span>
  24 |     | <span class='neutral'>     *  - an address where a contract lived, but was destroyed</span>
  25 |     | <span class='neutral'>     * ====</span>
  26 |     | <span class='neutral'>     *</span>
  27 |     | <span class='neutral'>     * [IMPORTANT]</span>
  28 |     | <span class='neutral'>     * ====</span>
  29 |     | <span class='neutral'>     * You shouldn&#39;t rely on `isContract` to protect against flash loan attacks!</span>
  30 |     | <span class='neutral'>     *</span>
  31 |     | <span class='neutral'>     * Preventing calls from contracts is highly discouraged. It breaks composability, breaks support for smart wallets</span>
  32 |     | <span class='neutral'>     * like Gnosis Safe, and does not provide security since it can be circumvented by calling from a contract</span>
  33 |     | <span class='neutral'>     * constructor.</span>
  34 |     | <span class='neutral'>     * ====</span>
  35 |     | <span class='neutral'>     */</span>
  36 |     | <span class='neutral'>    function isContract(address account) internal view returns (bool) {</span>
  37 |     | <span class='neutral'>        // This method relies on extcodesize/address.code.length, which returns 0</span>
  38 |     | <span class='neutral'>        // for contracts in construction, since the code is only stored at the end</span>
  39 |     | <span class='neutral'>        // of the constructor execution.</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='unexecuted'>        return account.code.length &gt; 0;</span>
  42 |     | <span class='neutral'>    }</span>
  43 |     | <span class='neutral'></span>
  44 |     | <span class='neutral'>    /**</span>
  45 |     | <span class='neutral'>     * @dev Replacement for Solidity&#39;s `transfer`: sends `amount` wei to</span>
  46 |     | <span class='neutral'>     * `recipient`, forwarding all available gas and reverting on errors.</span>
  47 |     | <span class='neutral'>     *</span>
  48 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost</span>
  49 |     | <span class='neutral'>     * of certain opcodes, possibly making contracts go over the 2300 gas limit</span>
  50 |     | <span class='neutral'>     * imposed by `transfer`, making them unable to receive funds via</span>
  51 |     | <span class='neutral'>     * `transfer`. {sendValue} removes this limitation.</span>
  52 |     | <span class='neutral'>     *</span>
  53 |     | <span class='neutral'>     * https://diligence.consensys.net/posts/2019/09/stop-using-soliditys-transfer-now/[Learn more].</span>
  54 |     | <span class='neutral'>     *</span>
  55 |     | <span class='neutral'>     * IMPORTANT: because control is transferred to `recipient`, care must be</span>
  56 |     | <span class='neutral'>     * taken to not create reentrancy vulnerabilities. Consider using</span>
  57 |     | <span class='neutral'>     * {ReentrancyGuard} or the</span>
  58 |     | <span class='neutral'>     * https://solidity.readthedocs.io/en/v0.5.11/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].</span>
  59 |     | <span class='neutral'>     */</span>
  60 |     | <span class='neutral'>    function sendValue(address payable recipient, uint256 amount) internal {</span>
  61 |     | <span class='neutral'>        require(address(this).balance &gt;= amount, &quot;Address: insufficient balance&quot;);</span>
  62 |     | <span class='neutral'></span>
  63 |     | <span class='neutral'>        (bool success, ) = recipient.call{value: amount}(&quot;&quot;);</span>
  64 |     | <span class='neutral'>        require(success, &quot;Address: unable to send value, recipient may have reverted&quot;);</span>
  65 |     | <span class='neutral'>    }</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='neutral'>    /**</span>
  68 |     | <span class='neutral'>     * @dev Performs a Solidity function call using a low level `call`. A</span>
  69 |     | <span class='neutral'>     * plain `call` is an unsafe replacement for a function call: use this</span>
  70 |     | <span class='neutral'>     * function instead.</span>
  71 |     | <span class='neutral'>     *</span>
  72 |     | <span class='neutral'>     * If `target` reverts with a revert reason, it is bubbled up by this</span>
  73 |     | <span class='neutral'>     * function (like regular Solidity function calls).</span>
  74 |     | <span class='neutral'>     *</span>
  75 |     | <span class='neutral'>     * Returns the raw returned data. To convert to the expected return value,</span>
  76 |     | <span class='neutral'>     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].</span>
  77 |     | <span class='neutral'>     *</span>
  78 |     | <span class='neutral'>     * Requirements:</span>
  79 |     | <span class='neutral'>     *</span>
  80 |     | <span class='neutral'>     * - `target` must be a contract.</span>
  81 |     | <span class='neutral'>     * - calling `target` with `data` must not revert.</span>
  82 |     | <span class='neutral'>     *</span>
  83 |     | <span class='neutral'>     * _Available since v3.1._</span>
  84 |     | <span class='neutral'>     */</span>
  85 |     | <span class='neutral'>    function functionCall(address target, bytes memory data) internal returns (bytes memory) {</span>
  86 |     | <span class='neutral'>        return functionCallWithValue(target, data, 0, &quot;Address: low-level call failed&quot;);</span>
  87 |     | <span class='neutral'>    }</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>    /**</span>
  90 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with</span>
  91 |     | <span class='neutral'>     * `errorMessage` as a fallback revert reason when `target` reverts.</span>
  92 |     | <span class='neutral'>     *</span>
  93 |     | <span class='neutral'>     * _Available since v3.1._</span>
  94 |     | <span class='neutral'>     */</span>
  95 |     | <span class='neutral'>    function functionCall(</span>
  96 |     | <span class='neutral'>        address target,</span>
  97 |     | <span class='neutral'>        bytes memory data,</span>
  98 |     | <span class='neutral'>        string memory errorMessage</span>
  99 |     | <span class='neutral'>    ) internal returns (bytes memory) {</span>
 100 |     | <span class='neutral'>        return functionCallWithValue(target, data, 0, errorMessage);</span>
 101 |     | <span class='neutral'>    }</span>
 102 |     | <span class='neutral'></span>
 103 |     | <span class='neutral'>    /**</span>
 104 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 105 |     | <span class='neutral'>     * but also transferring `value` wei to `target`.</span>
 106 |     | <span class='neutral'>     *</span>
 107 |     | <span class='neutral'>     * Requirements:</span>
 108 |     | <span class='neutral'>     *</span>
 109 |     | <span class='neutral'>     * - the calling contract must have an ETH balance of at least `value`.</span>
 110 |     | <span class='neutral'>     * - the called Solidity function must be `payable`.</span>
 111 |     | <span class='neutral'>     *</span>
 112 |     | <span class='neutral'>     * _Available since v3.1._</span>
 113 |     | <span class='neutral'>     */</span>
 114 |     | <span class='neutral'>    function functionCallWithValue(</span>
 115 |     | <span class='neutral'>        address target,</span>
 116 |     | <span class='neutral'>        bytes memory data,</span>
 117 |     | <span class='neutral'>        uint256 value</span>
 118 |     | <span class='neutral'>    ) internal returns (bytes memory) {</span>
 119 |     | <span class='neutral'>        return functionCallWithValue(target, data, value, &quot;Address: low-level call with value failed&quot;);</span>
 120 |     | <span class='neutral'>    }</span>
 121 |     | <span class='neutral'></span>
 122 |     | <span class='neutral'>    /**</span>
 123 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but</span>
 124 |     | <span class='neutral'>     * with `errorMessage` as a fallback revert reason when `target` reverts.</span>
 125 |     | <span class='neutral'>     *</span>
 126 |     | <span class='neutral'>     * _Available since v3.1._</span>
 127 |     | <span class='neutral'>     */</span>
 128 |     | <span class='neutral'>    function functionCallWithValue(</span>
 129 |     | <span class='neutral'>        address target,</span>
 130 |     | <span class='neutral'>        bytes memory data,</span>
 131 |     | <span class='neutral'>        uint256 value,</span>
 132 |     | <span class='neutral'>        string memory errorMessage</span>
 133 |     | <span class='neutral'>    ) internal returns (bytes memory) {</span>
 134 |     | <span class='neutral'>        require(address(this).balance &gt;= value, &quot;Address: insufficient balance for call&quot;);</span>
 135 | *   | <span class='executed'>        (bool success, bytes memory returndata) = target.call{value: value}(data);</span>
 136 | *   | <span class='executed'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 137 |     | <span class='neutral'>    }</span>
 138 |     | <span class='neutral'></span>
 139 |     | <span class='neutral'>    /**</span>
 140 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 141 |     | <span class='neutral'>     * but performing a static call.</span>
 142 |     | <span class='neutral'>     *</span>
 143 |     | <span class='neutral'>     * _Available since v3.3._</span>
 144 |     | <span class='neutral'>     */</span>
 145 |     | <span class='neutral'>    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {</span>
 146 |     | <span class='neutral'>        return functionStaticCall(target, data, &quot;Address: low-level static call failed&quot;);</span>
 147 |     | <span class='neutral'>    }</span>
 148 |     | <span class='neutral'></span>
 149 |     | <span class='neutral'>    /**</span>
 150 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 151 |     | <span class='neutral'>     * but performing a static call.</span>
 152 |     | <span class='neutral'>     *</span>
 153 |     | <span class='neutral'>     * _Available since v3.3._</span>
 154 |     | <span class='neutral'>     */</span>
 155 |     | <span class='neutral'>    function functionStaticCall(</span>
 156 |     | <span class='neutral'>        address target,</span>
 157 |     | <span class='neutral'>        bytes memory data,</span>
 158 |     | <span class='neutral'>        string memory errorMessage</span>
 159 |     | <span class='neutral'>    ) internal view returns (bytes memory) {</span>
 160 |     | <span class='neutral'>        (bool success, bytes memory returndata) = target.staticcall(data);</span>
 161 |     | <span class='neutral'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 162 |     | <span class='neutral'>    }</span>
 163 |     | <span class='neutral'></span>
 164 |     | <span class='neutral'>    /**</span>
 165 |     | <span class='neutral'>     * @dev Tool to verify that a low level call to smart-contract was successful, and revert (either by bubbling</span>
 166 |     | <span class='neutral'>     * the revert reason or using the provided one) in case of unsuccessful call or if target was not a contract.</span>
 167 |     | <span class='neutral'>     *</span>
 168 |     | <span class='neutral'>     * _Available since v4.8._</span>
 169 |     | <span class='neutral'>     */</span>
 170 | *   | <span class='executed'>    function verifyCallResultFromTarget(</span>
 171 |     | <span class='neutral'>        address target,</span>
 172 |     | <span class='neutral'>        bool success,</span>
 173 |     | <span class='neutral'>        bytes memory returndata,</span>
 174 |     | <span class='neutral'>        string memory errorMessage</span>
 175 |     | <span class='neutral'>    ) internal view returns (bytes memory) {</span>
 176 | *   | <span class='executed'>        if (success) {</span>
 177 | *   | <span class='executed'>            if (returndata.length == 0) {</span>
 178 |     | <span class='neutral'>                // only check isContract if the call was successful and the return data is empty</span>
 179 |     | <span class='neutral'>                // otherwise we already know that it was a contract</span>
 180 |     | <span class='neutral'>                require(isContract(target), &quot;Address: call to non-contract&quot;);</span>
 181 |     | <span class='neutral'>            }</span>
 182 | *   | <span class='executed'>            return returndata;</span>
 183 |     | <span class='neutral'>        } else {</span>
 184 |     | <span class='neutral'>            _revert(returndata, errorMessage);</span>
 185 |     | <span class='neutral'>        }</span>
 186 |     | <span class='neutral'>    }</span>
 187 |     | <span class='neutral'></span>
 188 |     | <span class='neutral'>    /**</span>
 189 |     | <span class='neutral'>     * @dev Tool to verify that a low level call was successful, and revert if it wasn&#39;t, either by bubbling the</span>
 190 |     | <span class='neutral'>     * revert reason or using the provided one.</span>
 191 |     | <span class='neutral'>     *</span>
 192 |     | <span class='neutral'>     * _Available since v4.3._</span>
 193 |     | <span class='neutral'>     */</span>
 194 |     | <span class='neutral'>    function verifyCallResult(</span>
 195 |     | <span class='neutral'>        bool success,</span>
 196 |     | <span class='neutral'>        bytes memory returndata,</span>
 197 |     | <span class='neutral'>        string memory errorMessage</span>
 198 |     | <span class='neutral'>    ) internal pure returns (bytes memory) {</span>
 199 |     | <span class='neutral'>        if (success) {</span>
 200 |     | <span class='neutral'>            return returndata;</span>
 201 |     | <span class='neutral'>        } else {</span>
 202 |     | <span class='neutral'>            _revert(returndata, errorMessage);</span>
 203 |     | <span class='neutral'>        }</span>
 204 |     | <span class='neutral'>    }</span>
 205 |     | <span class='neutral'></span>
 206 |     | <span class='neutral'>    function _revert(bytes memory returndata, string memory errorMessage) private pure {</span>
 207 |     | <span class='neutral'>        // Look for revert reason and bubble it up if present</span>
 208 |     | <span class='unexecuted'>        if (returndata.length &gt; 0) {</span>
 209 |     | <span class='neutral'>            // The easiest way to bubble the revert reason is using memory via assembly</span>
 210 |     | <span class='neutral'>            /// @solidity memory-safe-assembly</span>
 211 |     | <span class='unexecuted'>            assembly {</span>
 212 |     | <span class='neutral'>                let returndata_size := mload(returndata)</span>
 213 |     | <span class='neutral'>                revert(add(32, returndata), returndata_size)</span>
 214 |     | <span class='neutral'>            }</span>
 215 |     | <span class='neutral'>        } else {</span>
 216 |     | <span class='unexecuted'>            revert(errorMessage);</span>
 217 |     | <span class='neutral'>        }</span>
 218 |     | <span class='neutral'>    }</span>
 219 |     | <span class='neutral'>}</span>
 220 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/utils/ContextUpgradeable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/Context.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'>import &quot;../proxy/utils/Initializable.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @dev Provides information about the current execution context, including the</span>
  9 |     | <span class='neutral'> * sender of the transaction and its data. While these are generally available</span>
 10 |     | <span class='neutral'> * via msg.sender and msg.data, they should not be accessed in such a direct</span>
 11 |     | <span class='neutral'> * manner, since when dealing with meta-transactions the account sending and</span>
 12 |     | <span class='neutral'> * paying for execution may not be the actual sender (as far as an application</span>
 13 |     | <span class='neutral'> * is concerned).</span>
 14 |     | <span class='neutral'> *</span>
 15 |     | <span class='neutral'> * This contract is only required for intermediate, library-like contracts.</span>
 16 |     | <span class='neutral'> */</span>
 17 |     | <span class='neutral'>abstract contract ContextUpgradeable is Initializable {</span>
 18 |     | <span class='neutral'>    function __Context_init() internal onlyInitializing {</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    function __Context_init_unchained() internal onlyInitializing {</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'>    function _msgSender() internal view virtual returns (address) {</span>
 24 | *   | <span class='executed'>        return msg.sender;</span>
 25 |     | <span class='neutral'>    }</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='neutral'>    function _msgData() internal view virtual returns (bytes calldata) {</span>
 28 |     | <span class='neutral'>        return msg.data;</span>
 29 |     | <span class='neutral'>    }</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>    /**</span>
 32 |     | <span class='neutral'>     * @dev This empty reserved space is put in place to allow future versions to add new</span>
 33 |     | <span class='neutral'>     * variables without shifting down storage in the inheritance chain.</span>
 34 |     | <span class='neutral'>     * See https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps</span>
 35 |     | <span class='neutral'>     */</span>
 36 |     | <span class='neutral'>    uint256[50] private __gap;</span>
 37 |     | <span class='neutral'>}</span>
 38 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/utils/StringsUpgradeable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/Strings.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./math/MathUpgradeable.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev String operations.</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='unexecuted'>library StringsUpgradeable {</span>
 12 |     | <span class='unexecuted'>    bytes16 private constant _SYMBOLS = &quot;0123456789abcdef&quot;;</span>
 13 |     | <span class='neutral'>    uint8 private constant _ADDRESS_LENGTH = 20;</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'>    /**</span>
 16 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span>
 17 |     | <span class='neutral'>     */</span>
 18 |     | <span class='neutral'>    function toString(uint256 value) internal pure returns (string memory) {</span>
 19 |     | <span class='neutral'>        unchecked {</span>
 20 |     | <span class='neutral'>            uint256 length = MathUpgradeable.log10(value) + 1;</span>
 21 |     | <span class='neutral'>            string memory buffer = new string(length);</span>
 22 |     | <span class='neutral'>            uint256 ptr;</span>
 23 |     | <span class='neutral'>            /// @solidity memory-safe-assembly</span>
 24 |     | <span class='neutral'>            assembly {</span>
 25 |     | <span class='neutral'>                ptr := add(buffer, add(32, length))</span>
 26 |     | <span class='neutral'>            }</span>
 27 |     | <span class='neutral'>            while (true) {</span>
 28 |     | <span class='neutral'>                ptr--;</span>
 29 |     | <span class='neutral'>                /// @solidity memory-safe-assembly</span>
 30 |     | <span class='neutral'>                assembly {</span>
 31 |     | <span class='neutral'>                    mstore8(ptr, byte(mod(value, 10), _SYMBOLS))</span>
 32 |     | <span class='neutral'>                }</span>
 33 |     | <span class='neutral'>                value /= 10;</span>
 34 |     | <span class='neutral'>                if (value == 0) break;</span>
 35 |     | <span class='neutral'>            }</span>
 36 |     | <span class='neutral'>            return buffer;</span>
 37 |     | <span class='neutral'>        }</span>
 38 |     | <span class='neutral'>    }</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='neutral'>    /**</span>
 41 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span>
 42 |     | <span class='neutral'>     */</span>
 43 |     | <span class='neutral'>    function toHexString(uint256 value) internal pure returns (string memory) {</span>
 44 |     | <span class='neutral'>        unchecked {</span>
 45 |     | <span class='neutral'>            return toHexString(value, MathUpgradeable.log256(value) + 1);</span>
 46 |     | <span class='neutral'>        }</span>
 47 |     | <span class='neutral'>    }</span>
 48 |     | <span class='neutral'></span>
 49 |     | <span class='neutral'>    /**</span>
 50 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span>
 51 |     | <span class='neutral'>     */</span>
 52 |     | <span class='neutral'>    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {</span>
 53 |     | <span class='neutral'>        bytes memory buffer = new bytes(2 * length + 2);</span>
 54 |     | <span class='unexecuted'>        buffer[0] = &quot;0&quot;;</span>
 55 |     | <span class='unexecuted'>        buffer[1] = &quot;x&quot;;</span>
 56 |     | <span class='unexecuted'>        for (uint256 i = 2 * length + 1; i &gt; 1; --i) {</span>
 57 |     | <span class='unexecuted'>            buffer[i] = _SYMBOLS[value &amp; 0xf];</span>
 58 |     | <span class='unexecuted'>            value &gt;&gt;= 4;</span>
 59 |     | <span class='neutral'>        }</span>
 60 |     | <span class='unexecuted'>        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span>
 61 |     | <span class='unexecuted'>        return string(buffer);</span>
 62 |     | <span class='neutral'>    }</span>
 63 |     | <span class='neutral'></span>
 64 |     | <span class='neutral'>    /**</span>
 65 |     | <span class='neutral'>     * @dev Converts an `address` with fixed length of 20 bytes to its not checksummed ASCII `string` hexadecimal representation.</span>
 66 |     | <span class='neutral'>     */</span>
 67 |     | <span class='neutral'>    function toHexString(address addr) internal pure returns (string memory) {</span>
 68 |     | <span class='neutral'>        return toHexString(uint256(uint160(addr)), _ADDRESS_LENGTH);</span>
 69 |     | <span class='neutral'>    }</span>
 70 |     | <span class='neutral'>}</span>
 71 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/utils/introspection/ERC165Upgradeable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/introspection/ERC165.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./IERC165Upgradeable.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;../../proxy/utils/Initializable.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>/**</span>
 10 |     | <span class='neutral'> * @dev Implementation of the {IERC165} interface.</span>
 11 |     | <span class='neutral'> *</span>
 12 |     | <span class='neutral'> * Contracts that want to implement ERC165 should inherit from this contract and override {supportsInterface} to check</span>
 13 |     | <span class='neutral'> * for the additional interface id that will be supported. For example:</span>
 14 |     | <span class='neutral'> *</span>
 15 |     | <span class='neutral'> * ```solidity</span>
 16 |     | <span class='neutral'> * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 17 |     | <span class='neutral'> *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);</span>
 18 |     | <span class='neutral'> * }</span>
 19 |     | <span class='neutral'> * ```</span>
 20 |     | <span class='neutral'> *</span>
 21 |     | <span class='neutral'> * Alternatively, {ERC165Storage} provides an easier to use but more expensive implementation.</span>
 22 |     | <span class='neutral'> */</span>
 23 |     | <span class='neutral'>abstract contract ERC165Upgradeable is Initializable, IERC165Upgradeable {</span>
 24 |     | <span class='neutral'>    function __ERC165_init() internal onlyInitializing {</span>
 25 |     | <span class='neutral'>    }</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='neutral'>    function __ERC165_init_unchained() internal onlyInitializing {</span>
 28 |     | <span class='neutral'>    }</span>
 29 |     | <span class='neutral'>    /**</span>
 30 |     | <span class='neutral'>     * @dev See {IERC165-supportsInterface}.</span>
 31 |     | <span class='neutral'>     */</span>
 32 |     | <span class='neutral'>    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 33 |     | <span class='unexecuted'>        return interfaceId == type(IERC165Upgradeable).interfaceId;</span>
 34 |     | <span class='neutral'>    }</span>
 35 |     | <span class='neutral'></span>
 36 |     | <span class='neutral'>    /**</span>
 37 |     | <span class='neutral'>     * @dev This empty reserved space is put in place to allow future versions to add new</span>
 38 |     | <span class='neutral'>     * variables without shifting down storage in the inheritance chain.</span>
 39 |     | <span class='neutral'>     * See https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps</span>
 40 |     | <span class='neutral'>     */</span>
 41 |     | <span class='neutral'>    uint256[50] private __gap;</span>
 42 |     | <span class='neutral'>}</span>
 43 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/utils/introspection/IERC165Upgradeable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/introspection/IERC165.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC165 standard, as defined in the</span>
  8 |     | <span class='neutral'> * https://eips.ethereum.org/EIPS/eip-165[EIP].</span>
  9 |     | <span class='neutral'> *</span>
 10 |     | <span class='neutral'> * Implementers can declare support of contract interfaces, which can then be</span>
 11 |     | <span class='neutral'> * queried by others ({ERC165Checker}).</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> * For an implementation, see {ERC165}.</span>
 14 |     | <span class='neutral'> */</span>
 15 |     | <span class='neutral'>interface IERC165Upgradeable {</span>
 16 |     | <span class='neutral'>    /**</span>
 17 |     | <span class='neutral'>     * @dev Returns true if this contract implements the interface defined by</span>
 18 |     | <span class='neutral'>     * `interfaceId`. See the corresponding</span>
 19 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[EIP section]</span>
 20 |     | <span class='neutral'>     * to learn more about how these ids are created.</span>
 21 |     | <span class='neutral'>     *</span>
 22 |     | <span class='neutral'>     * This function call must use less than 30 000 gas.</span>
 23 |     | <span class='neutral'>     */</span>
 24 |     | <span class='neutral'>    function supportsInterface(bytes4 interfaceId) external view returns (bool);</span>
 25 |     | <span class='neutral'>}</span>
 26 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/utils/math/MathUpgradeable.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/math/Math.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>/**</span>
   7 |     | <span class='neutral'> * @dev Standard math utilities missing in the Solidity language.</span>
   8 |     | <span class='neutral'> */</span>
   9 |     | <span class='unexecuted'>library MathUpgradeable {</span>
  10 |     | <span class='neutral'>    enum Rounding {</span>
  11 |     | <span class='neutral'>        Down, // Toward negative infinity</span>
  12 |     | <span class='neutral'>        Up, // Toward infinity</span>
  13 |     | <span class='neutral'>        Zero // Toward zero</span>
  14 |     | <span class='neutral'>    }</span>
  15 |     | <span class='neutral'></span>
  16 |     | <span class='neutral'>    /**</span>
  17 |     | <span class='neutral'>     * @dev Returns the largest of two numbers.</span>
  18 |     | <span class='neutral'>     */</span>
  19 |     | <span class='neutral'>    function max(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  20 |     | <span class='neutral'>        return a &gt; b ? a : b;</span>
  21 |     | <span class='neutral'>    }</span>
  22 |     | <span class='neutral'></span>
  23 |     | <span class='neutral'>    /**</span>
  24 |     | <span class='neutral'>     * @dev Returns the smallest of two numbers.</span>
  25 |     | <span class='neutral'>     */</span>
  26 |     | <span class='neutral'>    function min(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  27 |     | <span class='neutral'>        return a &lt; b ? a : b;</span>
  28 |     | <span class='neutral'>    }</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    /**</span>
  31 |     | <span class='neutral'>     * @dev Returns the average of two numbers. The result is rounded towards</span>
  32 |     | <span class='neutral'>     * zero.</span>
  33 |     | <span class='neutral'>     */</span>
  34 |     | <span class='neutral'>    function average(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  35 |     | <span class='neutral'>        // (a + b) / 2 can overflow.</span>
  36 |     | <span class='neutral'>        return (a &amp; b) + (a ^ b) / 2;</span>
  37 |     | <span class='neutral'>    }</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>    /**</span>
  40 |     | <span class='neutral'>     * @dev Returns the ceiling of the division of two numbers.</span>
  41 |     | <span class='neutral'>     *</span>
  42 |     | <span class='neutral'>     * This differs from standard division with `/` in that it rounds up instead</span>
  43 |     | <span class='neutral'>     * of rounding down.</span>
  44 |     | <span class='neutral'>     */</span>
  45 |     | <span class='neutral'>    function ceilDiv(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  46 |     | <span class='neutral'>        // (a + b - 1) / b can overflow on addition, so we distribute.</span>
  47 |     | <span class='neutral'>        return a == 0 ? 0 : (a - 1) / b + 1;</span>
  48 |     | <span class='neutral'>    }</span>
  49 |     | <span class='neutral'></span>
  50 |     | <span class='neutral'>    /**</span>
  51 |     | <span class='neutral'>     * @notice Calculates floor(x * y / denominator) with full precision. Throws if result overflows a uint256 or denominator == 0</span>
  52 |     | <span class='neutral'>     * @dev Original credit to Remco Bloemen under MIT license (https://xn--2-umb.com/21/muldiv)</span>
  53 |     | <span class='neutral'>     * with further edits by Uniswap Labs also under MIT license.</span>
  54 |     | <span class='neutral'>     */</span>
  55 |     | <span class='neutral'>    function mulDiv(</span>
  56 |     | <span class='neutral'>        uint256 x,</span>
  57 |     | <span class='neutral'>        uint256 y,</span>
  58 |     | <span class='neutral'>        uint256 denominator</span>
  59 |     | <span class='neutral'>    ) internal pure returns (uint256 result) {</span>
  60 |     | <span class='neutral'>        unchecked {</span>
  61 |     | <span class='neutral'>            // 512-bit multiply [prod1 prod0] = x * y. Compute the product mod 2^256 and mod 2^256 - 1, then use</span>
  62 |     | <span class='neutral'>            // use the Chinese Remainder Theorem to reconstruct the 512 bit result. The result is stored in two 256</span>
  63 |     | <span class='neutral'>            // variables such that product = prod1 * 2^256 + prod0.</span>
  64 |     | <span class='neutral'>            uint256 prod0; // Least significant 256 bits of the product</span>
  65 |     | <span class='neutral'>            uint256 prod1; // Most significant 256 bits of the product</span>
  66 |     | <span class='neutral'>            assembly {</span>
  67 |     | <span class='neutral'>                let mm := mulmod(x, y, not(0))</span>
  68 |     | <span class='neutral'>                prod0 := mul(x, y)</span>
  69 |     | <span class='neutral'>                prod1 := sub(sub(mm, prod0), lt(mm, prod0))</span>
  70 |     | <span class='neutral'>            }</span>
  71 |     | <span class='neutral'></span>
  72 |     | <span class='neutral'>            // Handle non-overflow cases, 256 by 256 division.</span>
  73 |     | <span class='neutral'>            if (prod1 == 0) {</span>
  74 |     | <span class='neutral'>                return prod0 / denominator;</span>
  75 |     | <span class='neutral'>            }</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>            // Make sure the result is less than 2^256. Also prevents denominator == 0.</span>
  78 |     | <span class='neutral'>            require(denominator &gt; prod1);</span>
  79 |     | <span class='neutral'></span>
  80 |     | <span class='neutral'>            ///////////////////////////////////////////////</span>
  81 |     | <span class='neutral'>            // 512 by 256 division.</span>
  82 |     | <span class='neutral'>            ///////////////////////////////////////////////</span>
  83 |     | <span class='neutral'></span>
  84 |     | <span class='neutral'>            // Make division exact by subtracting the remainder from [prod1 prod0].</span>
  85 |     | <span class='neutral'>            uint256 remainder;</span>
  86 |     | <span class='neutral'>            assembly {</span>
  87 |     | <span class='neutral'>                // Compute remainder using mulmod.</span>
  88 |     | <span class='neutral'>                remainder := mulmod(x, y, denominator)</span>
  89 |     | <span class='neutral'></span>
  90 |     | <span class='neutral'>                // Subtract 256 bit number from 512 bit number.</span>
  91 |     | <span class='neutral'>                prod1 := sub(prod1, gt(remainder, prod0))</span>
  92 |     | <span class='neutral'>                prod0 := sub(prod0, remainder)</span>
  93 |     | <span class='neutral'>            }</span>
  94 |     | <span class='neutral'></span>
  95 |     | <span class='neutral'>            // Factor powers of two out of denominator and compute largest power of two divisor of denominator. Always &gt;= 1.</span>
  96 |     | <span class='neutral'>            // See https://cs.stackexchange.com/q/138556/92363.</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>            // Does not overflow because the denominator cannot be zero at this stage in the function.</span>
  99 |     | <span class='neutral'>            uint256 twos = denominator &amp; (~denominator + 1);</span>
 100 |     | <span class='neutral'>            assembly {</span>
 101 |     | <span class='neutral'>                // Divide denominator by twos.</span>
 102 |     | <span class='neutral'>                denominator := div(denominator, twos)</span>
 103 |     | <span class='neutral'></span>
 104 |     | <span class='neutral'>                // Divide [prod1 prod0] by twos.</span>
 105 |     | <span class='neutral'>                prod0 := div(prod0, twos)</span>
 106 |     | <span class='neutral'></span>
 107 |     | <span class='neutral'>                // Flip twos such that it is 2^256 / twos. If twos is zero, then it becomes one.</span>
 108 |     | <span class='neutral'>                twos := add(div(sub(0, twos), twos), 1)</span>
 109 |     | <span class='neutral'>            }</span>
 110 |     | <span class='neutral'></span>
 111 |     | <span class='neutral'>            // Shift in bits from prod1 into prod0.</span>
 112 |     | <span class='neutral'>            prod0 |= prod1 * twos;</span>
 113 |     | <span class='neutral'></span>
 114 |     | <span class='neutral'>            // Invert denominator mod 2^256. Now that denominator is an odd number, it has an inverse modulo 2^256 such</span>
 115 |     | <span class='neutral'>            // that denominator * inv = 1 mod 2^256. Compute the inverse by starting with a seed that is correct for</span>
 116 |     | <span class='neutral'>            // four bits. That is, denominator * inv = 1 mod 2^4.</span>
 117 |     | <span class='neutral'>            uint256 inverse = (3 * denominator) ^ 2;</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>            // Use the Newton-Raphson iteration to improve the precision. Thanks to Hensel&#39;s lifting lemma, this also works</span>
 120 |     | <span class='neutral'>            // in modular arithmetic, doubling the correct bits in each step.</span>
 121 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^8</span>
 122 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^16</span>
 123 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^32</span>
 124 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^64</span>
 125 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^128</span>
 126 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^256</span>
 127 |     | <span class='neutral'></span>
 128 |     | <span class='neutral'>            // Because the division is now exact we can divide by multiplying with the modular inverse of denominator.</span>
 129 |     | <span class='neutral'>            // This will give us the correct result modulo 2^256. Since the preconditions guarantee that the outcome is</span>
 130 |     | <span class='neutral'>            // less than 2^256, this is the final result. We don&#39;t need to compute the high bits of the result and prod1</span>
 131 |     | <span class='neutral'>            // is no longer required.</span>
 132 |     | <span class='neutral'>            result = prod0 * inverse;</span>
 133 |     | <span class='neutral'>            return result;</span>
 134 |     | <span class='neutral'>        }</span>
 135 |     | <span class='neutral'>    }</span>
 136 |     | <span class='neutral'></span>
 137 |     | <span class='neutral'>    /**</span>
 138 |     | <span class='neutral'>     * @notice Calculates x * y / denominator with full precision, following the selected rounding direction.</span>
 139 |     | <span class='neutral'>     */</span>
 140 |     | <span class='neutral'>    function mulDiv(</span>
 141 |     | <span class='neutral'>        uint256 x,</span>
 142 |     | <span class='neutral'>        uint256 y,</span>
 143 |     | <span class='neutral'>        uint256 denominator,</span>
 144 |     | <span class='neutral'>        Rounding rounding</span>
 145 |     | <span class='neutral'>    ) internal pure returns (uint256) {</span>
 146 |     | <span class='neutral'>        uint256 result = mulDiv(x, y, denominator);</span>
 147 |     | <span class='neutral'>        if (rounding == Rounding.Up &amp;&amp; mulmod(x, y, denominator) &gt; 0) {</span>
 148 |     | <span class='neutral'>            result += 1;</span>
 149 |     | <span class='neutral'>        }</span>
 150 |     | <span class='neutral'>        return result;</span>
 151 |     | <span class='neutral'>    }</span>
 152 |     | <span class='neutral'></span>
 153 |     | <span class='neutral'>    /**</span>
 154 |     | <span class='neutral'>     * @dev Returns the square root of a number. If the number is not a perfect square, the value is rounded down.</span>
 155 |     | <span class='neutral'>     *</span>
 156 |     | <span class='neutral'>     * Inspired by Henry S. Warren, Jr.&#39;s &quot;Hacker&#39;s Delight&quot; (Chapter 11).</span>
 157 |     | <span class='neutral'>     */</span>
 158 |     | <span class='neutral'>    function sqrt(uint256 a) internal pure returns (uint256) {</span>
 159 |     | <span class='neutral'>        if (a == 0) {</span>
 160 |     | <span class='neutral'>            return 0;</span>
 161 |     | <span class='neutral'>        }</span>
 162 |     | <span class='neutral'></span>
 163 |     | <span class='neutral'>        // For our first guess, we get the biggest power of 2 which is smaller than the square root of the target.</span>
 164 |     | <span class='neutral'>        //</span>
 165 |     | <span class='neutral'>        // We know that the &quot;msb&quot; (most significant bit) of our target number `a` is a power of 2 such that we have</span>
 166 |     | <span class='neutral'>        // `msb(a) &lt;= a &lt; 2*msb(a)`. This value can be written `msb(a)=2**k` with `k=log2(a)`.</span>
 167 |     | <span class='neutral'>        //</span>
 168 |     | <span class='neutral'>        // This can be rewritten `2**log2(a) &lt;= a &lt; 2**(log2(a) + 1)`</span>
 169 |     | <span class='neutral'>        //  `sqrt(2**k) &lt;= sqrt(a) &lt; sqrt(2**(k+1))`</span>
 170 |     | <span class='neutral'>        //  `2**(k/2) &lt;= sqrt(a) &lt; 2**((k+1)/2) &lt;= 2**(k/2 + 1)`</span>
 171 |     | <span class='neutral'>        //</span>
 172 |     | <span class='neutral'>        // Consequently, `2**(log2(a) / 2)` is a good first approximation of `sqrt(a)` with at least 1 correct bit.</span>
 173 |     | <span class='neutral'>        uint256 result = 1 &lt;&lt; (log2(a) &gt;&gt; 1);</span>
 174 |     | <span class='neutral'></span>
 175 |     | <span class='neutral'>        // At this point `result` is an estimation with one bit of precision. We know the true value is a uint128,</span>
 176 |     | <span class='neutral'>        // since it is the square root of a uint256. Newton&#39;s method converges quadratically (precision doubles at</span>
 177 |     | <span class='neutral'>        // every iteration). We thus need at most 7 iteration to turn our partial result with one bit of precision</span>
 178 |     | <span class='neutral'>        // into the expected uint128 result.</span>
 179 |     | <span class='neutral'>        unchecked {</span>
 180 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 181 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 182 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 183 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 184 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 185 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 186 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 187 |     | <span class='neutral'>            return min(result, a / result);</span>
 188 |     | <span class='neutral'>        }</span>
 189 |     | <span class='neutral'>    }</span>
 190 |     | <span class='neutral'></span>
 191 |     | <span class='neutral'>    /**</span>
 192 |     | <span class='neutral'>     * @notice Calculates sqrt(a), following the selected rounding direction.</span>
 193 |     | <span class='neutral'>     */</span>
 194 |     | <span class='neutral'>    function sqrt(uint256 a, Rounding rounding) internal pure returns (uint256) {</span>
 195 |     | <span class='neutral'>        unchecked {</span>
 196 |     | <span class='neutral'>            uint256 result = sqrt(a);</span>
 197 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; result * result &lt; a ? 1 : 0);</span>
 198 |     | <span class='neutral'>        }</span>
 199 |     | <span class='neutral'>    }</span>
 200 |     | <span class='neutral'></span>
 201 |     | <span class='neutral'>    /**</span>
 202 |     | <span class='neutral'>     * @dev Return the log in base 2, rounded down, of a positive value.</span>
 203 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 204 |     | <span class='neutral'>     */</span>
 205 |     | <span class='neutral'>    function log2(uint256 value) internal pure returns (uint256) {</span>
 206 |     | <span class='neutral'>        uint256 result = 0;</span>
 207 |     | <span class='neutral'>        unchecked {</span>
 208 |     | <span class='neutral'>            if (value &gt;&gt; 128 &gt; 0) {</span>
 209 |     | <span class='neutral'>                value &gt;&gt;= 128;</span>
 210 |     | <span class='neutral'>                result += 128;</span>
 211 |     | <span class='neutral'>            }</span>
 212 |     | <span class='neutral'>            if (value &gt;&gt; 64 &gt; 0) {</span>
 213 |     | <span class='neutral'>                value &gt;&gt;= 64;</span>
 214 |     | <span class='neutral'>                result += 64;</span>
 215 |     | <span class='neutral'>            }</span>
 216 |     | <span class='neutral'>            if (value &gt;&gt; 32 &gt; 0) {</span>
 217 |     | <span class='neutral'>                value &gt;&gt;= 32;</span>
 218 |     | <span class='neutral'>                result += 32;</span>
 219 |     | <span class='neutral'>            }</span>
 220 |     | <span class='neutral'>            if (value &gt;&gt; 16 &gt; 0) {</span>
 221 |     | <span class='neutral'>                value &gt;&gt;= 16;</span>
 222 |     | <span class='neutral'>                result += 16;</span>
 223 |     | <span class='neutral'>            }</span>
 224 |     | <span class='neutral'>            if (value &gt;&gt; 8 &gt; 0) {</span>
 225 |     | <span class='neutral'>                value &gt;&gt;= 8;</span>
 226 |     | <span class='neutral'>                result += 8;</span>
 227 |     | <span class='neutral'>            }</span>
 228 |     | <span class='neutral'>            if (value &gt;&gt; 4 &gt; 0) {</span>
 229 |     | <span class='neutral'>                value &gt;&gt;= 4;</span>
 230 |     | <span class='neutral'>                result += 4;</span>
 231 |     | <span class='neutral'>            }</span>
 232 |     | <span class='neutral'>            if (value &gt;&gt; 2 &gt; 0) {</span>
 233 |     | <span class='neutral'>                value &gt;&gt;= 2;</span>
 234 |     | <span class='neutral'>                result += 2;</span>
 235 |     | <span class='neutral'>            }</span>
 236 |     | <span class='neutral'>            if (value &gt;&gt; 1 &gt; 0) {</span>
 237 |     | <span class='neutral'>                result += 1;</span>
 238 |     | <span class='neutral'>            }</span>
 239 |     | <span class='neutral'>        }</span>
 240 |     | <span class='neutral'>        return result;</span>
 241 |     | <span class='neutral'>    }</span>
 242 |     | <span class='neutral'></span>
 243 |     | <span class='neutral'>    /**</span>
 244 |     | <span class='neutral'>     * @dev Return the log in base 2, following the selected rounding direction, of a positive value.</span>
 245 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 246 |     | <span class='neutral'>     */</span>
 247 |     | <span class='neutral'>    function log2(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 248 |     | <span class='neutral'>        unchecked {</span>
 249 |     | <span class='neutral'>            uint256 result = log2(value);</span>
 250 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; 1 &lt;&lt; result &lt; value ? 1 : 0);</span>
 251 |     | <span class='neutral'>        }</span>
 252 |     | <span class='neutral'>    }</span>
 253 |     | <span class='neutral'></span>
 254 |     | <span class='neutral'>    /**</span>
 255 |     | <span class='neutral'>     * @dev Return the log in base 10, rounded down, of a positive value.</span>
 256 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 257 |     | <span class='neutral'>     */</span>
 258 |     | <span class='neutral'>    function log10(uint256 value) internal pure returns (uint256) {</span>
 259 |     | <span class='neutral'>        uint256 result = 0;</span>
 260 |     | <span class='neutral'>        unchecked {</span>
 261 |     | <span class='neutral'>            if (value &gt;= 10**64) {</span>
 262 |     | <span class='neutral'>                value /= 10**64;</span>
 263 |     | <span class='neutral'>                result += 64;</span>
 264 |     | <span class='neutral'>            }</span>
 265 |     | <span class='neutral'>            if (value &gt;= 10**32) {</span>
 266 |     | <span class='neutral'>                value /= 10**32;</span>
 267 |     | <span class='neutral'>                result += 32;</span>
 268 |     | <span class='neutral'>            }</span>
 269 |     | <span class='neutral'>            if (value &gt;= 10**16) {</span>
 270 |     | <span class='neutral'>                value /= 10**16;</span>
 271 |     | <span class='neutral'>                result += 16;</span>
 272 |     | <span class='neutral'>            }</span>
 273 |     | <span class='neutral'>            if (value &gt;= 10**8) {</span>
 274 |     | <span class='neutral'>                value /= 10**8;</span>
 275 |     | <span class='neutral'>                result += 8;</span>
 276 |     | <span class='neutral'>            }</span>
 277 |     | <span class='neutral'>            if (value &gt;= 10**4) {</span>
 278 |     | <span class='neutral'>                value /= 10**4;</span>
 279 |     | <span class='neutral'>                result += 4;</span>
 280 |     | <span class='neutral'>            }</span>
 281 |     | <span class='neutral'>            if (value &gt;= 10**2) {</span>
 282 |     | <span class='neutral'>                value /= 10**2;</span>
 283 |     | <span class='neutral'>                result += 2;</span>
 284 |     | <span class='neutral'>            }</span>
 285 |     | <span class='neutral'>            if (value &gt;= 10**1) {</span>
 286 |     | <span class='neutral'>                result += 1;</span>
 287 |     | <span class='neutral'>            }</span>
 288 |     | <span class='neutral'>        }</span>
 289 |     | <span class='neutral'>        return result;</span>
 290 |     | <span class='neutral'>    }</span>
 291 |     | <span class='neutral'></span>
 292 |     | <span class='neutral'>    /**</span>
 293 |     | <span class='neutral'>     * @dev Return the log in base 10, following the selected rounding direction, of a positive value.</span>
 294 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 295 |     | <span class='neutral'>     */</span>
 296 |     | <span class='neutral'>    function log10(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 297 |     | <span class='neutral'>        unchecked {</span>
 298 |     | <span class='neutral'>            uint256 result = log10(value);</span>
 299 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; 10**result &lt; value ? 1 : 0);</span>
 300 |     | <span class='neutral'>        }</span>
 301 |     | <span class='neutral'>    }</span>
 302 |     | <span class='neutral'></span>
 303 |     | <span class='neutral'>    /**</span>
 304 |     | <span class='neutral'>     * @dev Return the log in base 256, rounded down, of a positive value.</span>
 305 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 306 |     | <span class='neutral'>     *</span>
 307 |     | <span class='neutral'>     * Adding one to the result gives the number of pairs of hex symbols needed to represent `value` as a hex string.</span>
 308 |     | <span class='neutral'>     */</span>
 309 |     | <span class='neutral'>    function log256(uint256 value) internal pure returns (uint256) {</span>
 310 |     | <span class='neutral'>        uint256 result = 0;</span>
 311 |     | <span class='neutral'>        unchecked {</span>
 312 |     | <span class='neutral'>            if (value &gt;&gt; 128 &gt; 0) {</span>
 313 |     | <span class='neutral'>                value &gt;&gt;= 128;</span>
 314 |     | <span class='neutral'>                result += 16;</span>
 315 |     | <span class='neutral'>            }</span>
 316 |     | <span class='neutral'>            if (value &gt;&gt; 64 &gt; 0) {</span>
 317 |     | <span class='neutral'>                value &gt;&gt;= 64;</span>
 318 |     | <span class='neutral'>                result += 8;</span>
 319 |     | <span class='neutral'>            }</span>
 320 |     | <span class='neutral'>            if (value &gt;&gt; 32 &gt; 0) {</span>
 321 |     | <span class='neutral'>                value &gt;&gt;= 32;</span>
 322 |     | <span class='neutral'>                result += 4;</span>
 323 |     | <span class='neutral'>            }</span>
 324 |     | <span class='neutral'>            if (value &gt;&gt; 16 &gt; 0) {</span>
 325 |     | <span class='neutral'>                value &gt;&gt;= 16;</span>
 326 |     | <span class='neutral'>                result += 2;</span>
 327 |     | <span class='neutral'>            }</span>
 328 |     | <span class='neutral'>            if (value &gt;&gt; 8 &gt; 0) {</span>
 329 |     | <span class='neutral'>                result += 1;</span>
 330 |     | <span class='neutral'>            }</span>
 331 |     | <span class='neutral'>        }</span>
 332 |     | <span class='neutral'>        return result;</span>
 333 |     | <span class='neutral'>    }</span>
 334 |     | <span class='neutral'></span>
 335 |     | <span class='neutral'>    /**</span>
 336 |     | <span class='neutral'>     * @dev Return the log in base 10, following the selected rounding direction, of a positive value.</span>
 337 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 338 |     | <span class='neutral'>     */</span>
 339 |     | <span class='neutral'>    function log256(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 340 |     | <span class='neutral'>        unchecked {</span>
 341 |     | <span class='neutral'>            uint256 result = log256(value);</span>
 342 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; 1 &lt;&lt; (result * 8) &lt; value ? 1 : 0);</span>
 343 |     | <span class='neutral'>        }</span>
 344 |     | <span class='neutral'>    }</span>
 345 |     | <span class='neutral'>}</span>
 346 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts-upgradeable/utils/structs/EnumerableSetUpgradeable.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/structs/EnumerableSet.sol)</span>
   3 |     | <span class='neutral'>// This file was procedurally generated from scripts/generate/templates/EnumerableSet.js.</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   6 |     | <span class='neutral'></span>
   7 |     | <span class='neutral'>/**</span>
   8 |     | <span class='neutral'> * @dev Library for managing</span>
   9 |     | <span class='neutral'> * https://en.wikipedia.org/wiki/Set_(abstract_data_type)[sets] of primitive</span>
  10 |     | <span class='neutral'> * types.</span>
  11 |     | <span class='neutral'> *</span>
  12 |     | <span class='neutral'> * Sets have the following properties:</span>
  13 |     | <span class='neutral'> *</span>
  14 |     | <span class='neutral'> * - Elements are added, removed, and checked for existence in constant time</span>
  15 |     | <span class='neutral'> * (O(1)).</span>
  16 |     | <span class='neutral'> * - Elements are enumerated in O(n). No guarantees are made on the ordering.</span>
  17 |     | <span class='neutral'> *</span>
  18 |     | <span class='neutral'> * ```</span>
  19 |     | <span class='neutral'> * contract Example {</span>
  20 |     | <span class='neutral'> *     // Add the library methods</span>
  21 |     | <span class='neutral'> *     using EnumerableSet for EnumerableSet.AddressSet;</span>
  22 |     | <span class='neutral'> *</span>
  23 |     | <span class='neutral'> *     // Declare a set state variable</span>
  24 |     | <span class='neutral'> *     EnumerableSet.AddressSet private mySet;</span>
  25 |     | <span class='neutral'> * }</span>
  26 |     | <span class='neutral'> * ```</span>
  27 |     | <span class='neutral'> *</span>
  28 |     | <span class='neutral'> * As of v3.3.0, sets of type `bytes32` (`Bytes32Set`), `address` (`AddressSet`)</span>
  29 |     | <span class='neutral'> * and `uint256` (`UintSet`) are supported.</span>
  30 |     | <span class='neutral'> *</span>
  31 |     | <span class='neutral'> * [WARNING]</span>
  32 |     | <span class='neutral'> * ====</span>
  33 |     | <span class='neutral'> * Trying to delete such a structure from storage will likely result in data corruption, rendering the structure</span>
  34 |     | <span class='neutral'> * unusable.</span>
  35 |     | <span class='neutral'> * See https://github.com/ethereum/solidity/pull/11843[ethereum/solidity#11843] for more info.</span>
  36 |     | <span class='neutral'> *</span>
  37 |     | <span class='neutral'> * In order to clean an EnumerableSet, you can either remove all elements one by one or create a fresh instance using an</span>
  38 |     | <span class='neutral'> * array of EnumerableSet.</span>
  39 |     | <span class='neutral'> * ====</span>
  40 |     | <span class='neutral'> */</span>
  41 |     | <span class='unexecuted'>library EnumerableSetUpgradeable {</span>
  42 |     | <span class='neutral'>    // To implement this library for multiple types with as little code</span>
  43 |     | <span class='neutral'>    // repetition as possible, we write it in terms of a generic Set type with</span>
  44 |     | <span class='neutral'>    // bytes32 values.</span>
  45 |     | <span class='neutral'>    // The Set implementation uses private functions, and user-facing</span>
  46 |     | <span class='neutral'>    // implementations (such as AddressSet) are just wrappers around the</span>
  47 |     | <span class='neutral'>    // underlying Set.</span>
  48 |     | <span class='neutral'>    // This means that we can only create new EnumerableSets for types that fit</span>
  49 |     | <span class='neutral'>    // in bytes32.</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>    struct Set {</span>
  52 |     | <span class='neutral'>        // Storage of set values</span>
  53 |     | <span class='neutral'>        bytes32[] _values;</span>
  54 |     | <span class='neutral'>        // Position of the value in the `values` array, plus 1 because index 0</span>
  55 |     | <span class='neutral'>        // means a value is not in the set.</span>
  56 |     | <span class='neutral'>        mapping(bytes32 =&gt; uint256) _indexes;</span>
  57 |     | <span class='neutral'>    }</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    /**</span>
  60 |     | <span class='neutral'>     * @dev Add a value to a set. O(1).</span>
  61 |     | <span class='neutral'>     *</span>
  62 |     | <span class='neutral'>     * Returns true if the value was added to the set, that is if it was not</span>
  63 |     | <span class='neutral'>     * already present.</span>
  64 |     | <span class='neutral'>     */</span>
  65 | *   | <span class='executed'>    function _add(Set storage set, bytes32 value) private returns (bool) {</span>
  66 | *   | <span class='executed'>        if (!_contains(set, value)) {</span>
  67 |     | <span class='neutral'>            set._values.push(value);</span>
  68 |     | <span class='neutral'>            // The value is stored at length-1, but we add 1 to all indexes</span>
  69 |     | <span class='neutral'>            // and use 0 as a sentinel value</span>
  70 |     | <span class='neutral'>            set._indexes[value] = set._values.length;</span>
  71 | *   | <span class='executed'>            return true;</span>
  72 |     | <span class='neutral'>        } else {</span>
  73 |     | <span class='unexecuted'>            return false;</span>
  74 |     | <span class='neutral'>        }</span>
  75 |     | <span class='neutral'>    }</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>    /**</span>
  78 |     | <span class='neutral'>     * @dev Removes a value from a set. O(1).</span>
  79 |     | <span class='neutral'>     *</span>
  80 |     | <span class='neutral'>     * Returns true if the value was removed from the set, that is if it was</span>
  81 |     | <span class='neutral'>     * present.</span>
  82 |     | <span class='neutral'>     */</span>
  83 |     | <span class='unexecuted'>    function _remove(Set storage set, bytes32 value) private returns (bool) {</span>
  84 |     | <span class='neutral'>        // We read and store the value&#39;s index to prevent multiple reads from the same storage slot</span>
  85 |     | <span class='unexecuted'>        uint256 valueIndex = set._indexes[value];</span>
  86 |     | <span class='neutral'></span>
  87 |     | <span class='unexecuted'>        if (valueIndex != 0) {</span>
  88 |     | <span class='neutral'>            // Equivalent to contains(set, value)</span>
  89 |     | <span class='neutral'>            // To delete an element from the _values array in O(1), we swap the element to delete with the last one in</span>
  90 |     | <span class='neutral'>            // the array, and then remove the last element (sometimes called as &#39;swap and pop&#39;).</span>
  91 |     | <span class='neutral'>            // This modifies the order of the array, as noted in {at}.</span>
  92 |     | <span class='neutral'></span>
  93 |     | <span class='neutral'>            uint256 toDeleteIndex = valueIndex - 1;</span>
  94 |     | <span class='neutral'>            uint256 lastIndex = set._values.length - 1;</span>
  95 |     | <span class='neutral'></span>
  96 |     | <span class='unexecuted'>            if (lastIndex != toDeleteIndex) {</span>
  97 |     | <span class='unexecuted'>                bytes32 lastValue = set._values[lastIndex];</span>
  98 |     | <span class='neutral'></span>
  99 |     | <span class='neutral'>                // Move the last value to the index where the value to delete is</span>
 100 |     | <span class='unexecuted'>                set._values[toDeleteIndex] = lastValue;</span>
 101 |     | <span class='neutral'>                // Update the index for the moved value</span>
 102 |     | <span class='neutral'>                set._indexes[lastValue] = valueIndex; // Replace lastValue&#39;s index to valueIndex</span>
 103 |     | <span class='neutral'>            }</span>
 104 |     | <span class='neutral'></span>
 105 |     | <span class='neutral'>            // Delete the slot where the moved value was stored</span>
 106 |     | <span class='neutral'>            set._values.pop();</span>
 107 |     | <span class='neutral'></span>
 108 |     | <span class='neutral'>            // Delete the index for the deleted slot</span>
 109 |     | <span class='neutral'>            delete set._indexes[value];</span>
 110 |     | <span class='neutral'></span>
 111 |     | <span class='unexecuted'>            return true;</span>
 112 |     | <span class='neutral'>        } else {</span>
 113 |     | <span class='unexecuted'>            return false;</span>
 114 |     | <span class='neutral'>        }</span>
 115 |     | <span class='neutral'>    }</span>
 116 |     | <span class='neutral'></span>
 117 |     | <span class='neutral'>    /**</span>
 118 |     | <span class='neutral'>     * @dev Returns true if the value is in the set. O(1).</span>
 119 |     | <span class='neutral'>     */</span>
 120 | *   | <span class='executed'>    function _contains(Set storage set, bytes32 value) private view returns (bool) {</span>
 121 | *   | <span class='executed'>        return set._indexes[value] != 0;</span>
 122 |     | <span class='neutral'>    }</span>
 123 |     | <span class='neutral'></span>
 124 |     | <span class='neutral'>    /**</span>
 125 |     | <span class='neutral'>     * @dev Returns the number of values on the set. O(1).</span>
 126 |     | <span class='neutral'>     */</span>
 127 |     | <span class='neutral'>    function _length(Set storage set) private view returns (uint256) {</span>
 128 |     | <span class='neutral'>        return set._values.length;</span>
 129 |     | <span class='neutral'>    }</span>
 130 |     | <span class='neutral'></span>
 131 |     | <span class='neutral'>    /**</span>
 132 |     | <span class='neutral'>     * @dev Returns the value stored at position `index` in the set. O(1).</span>
 133 |     | <span class='neutral'>     *</span>
 134 |     | <span class='neutral'>     * Note that there are no guarantees on the ordering of values inside the</span>
 135 |     | <span class='neutral'>     * array, and it may change when more values are added or removed.</span>
 136 |     | <span class='neutral'>     *</span>
 137 |     | <span class='neutral'>     * Requirements:</span>
 138 |     | <span class='neutral'>     *</span>
 139 |     | <span class='neutral'>     * - `index` must be strictly less than {length}.</span>
 140 |     | <span class='neutral'>     */</span>
 141 |     | <span class='neutral'>    function _at(Set storage set, uint256 index) private view returns (bytes32) {</span>
 142 |     | <span class='neutral'>        return set._values[index];</span>
 143 |     | <span class='neutral'>    }</span>
 144 |     | <span class='neutral'></span>
 145 |     | <span class='neutral'>    /**</span>
 146 |     | <span class='neutral'>     * @dev Return the entire set in an array</span>
 147 |     | <span class='neutral'>     *</span>
 148 |     | <span class='neutral'>     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed</span>
 149 |     | <span class='neutral'>     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that</span>
 150 |     | <span class='neutral'>     * this function has an unbounded cost, and using it as part of a state-changing function may render the function</span>
 151 |     | <span class='neutral'>     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.</span>
 152 |     | <span class='neutral'>     */</span>
 153 |     | <span class='neutral'>    function _values(Set storage set) private view returns (bytes32[] memory) {</span>
 154 |     | <span class='neutral'>        return set._values;</span>
 155 |     | <span class='neutral'>    }</span>
 156 |     | <span class='neutral'></span>
 157 |     | <span class='neutral'>    // Bytes32Set</span>
 158 |     | <span class='neutral'></span>
 159 |     | <span class='neutral'>    struct Bytes32Set {</span>
 160 |     | <span class='neutral'>        Set _inner;</span>
 161 |     | <span class='neutral'>    }</span>
 162 |     | <span class='neutral'></span>
 163 |     | <span class='neutral'>    /**</span>
 164 |     | <span class='neutral'>     * @dev Add a value to a set. O(1).</span>
 165 |     | <span class='neutral'>     *</span>
 166 |     | <span class='neutral'>     * Returns true if the value was added to the set, that is if it was not</span>
 167 |     | <span class='neutral'>     * already present.</span>
 168 |     | <span class='neutral'>     */</span>
 169 |     | <span class='neutral'>    function add(Bytes32Set storage set, bytes32 value) internal returns (bool) {</span>
 170 |     | <span class='neutral'>        return _add(set._inner, value);</span>
 171 |     | <span class='neutral'>    }</span>
 172 |     | <span class='neutral'></span>
 173 |     | <span class='neutral'>    /**</span>
 174 |     | <span class='neutral'>     * @dev Removes a value from a set. O(1).</span>
 175 |     | <span class='neutral'>     *</span>
 176 |     | <span class='neutral'>     * Returns true if the value was removed from the set, that is if it was</span>
 177 |     | <span class='neutral'>     * present.</span>
 178 |     | <span class='neutral'>     */</span>
 179 |     | <span class='neutral'>    function remove(Bytes32Set storage set, bytes32 value) internal returns (bool) {</span>
 180 |     | <span class='neutral'>        return _remove(set._inner, value);</span>
 181 |     | <span class='neutral'>    }</span>
 182 |     | <span class='neutral'></span>
 183 |     | <span class='neutral'>    /**</span>
 184 |     | <span class='neutral'>     * @dev Returns true if the value is in the set. O(1).</span>
 185 |     | <span class='neutral'>     */</span>
 186 |     | <span class='neutral'>    function contains(Bytes32Set storage set, bytes32 value) internal view returns (bool) {</span>
 187 |     | <span class='neutral'>        return _contains(set._inner, value);</span>
 188 |     | <span class='neutral'>    }</span>
 189 |     | <span class='neutral'></span>
 190 |     | <span class='neutral'>    /**</span>
 191 |     | <span class='neutral'>     * @dev Returns the number of values in the set. O(1).</span>
 192 |     | <span class='neutral'>     */</span>
 193 |     | <span class='neutral'>    function length(Bytes32Set storage set) internal view returns (uint256) {</span>
 194 |     | <span class='neutral'>        return _length(set._inner);</span>
 195 |     | <span class='neutral'>    }</span>
 196 |     | <span class='neutral'></span>
 197 |     | <span class='neutral'>    /**</span>
 198 |     | <span class='neutral'>     * @dev Returns the value stored at position `index` in the set. O(1).</span>
 199 |     | <span class='neutral'>     *</span>
 200 |     | <span class='neutral'>     * Note that there are no guarantees on the ordering of values inside the</span>
 201 |     | <span class='neutral'>     * array, and it may change when more values are added or removed.</span>
 202 |     | <span class='neutral'>     *</span>
 203 |     | <span class='neutral'>     * Requirements:</span>
 204 |     | <span class='neutral'>     *</span>
 205 |     | <span class='neutral'>     * - `index` must be strictly less than {length}.</span>
 206 |     | <span class='neutral'>     */</span>
 207 |     | <span class='neutral'>    function at(Bytes32Set storage set, uint256 index) internal view returns (bytes32) {</span>
 208 |     | <span class='neutral'>        return _at(set._inner, index);</span>
 209 |     | <span class='neutral'>    }</span>
 210 |     | <span class='neutral'></span>
 211 |     | <span class='neutral'>    /**</span>
 212 |     | <span class='neutral'>     * @dev Return the entire set in an array</span>
 213 |     | <span class='neutral'>     *</span>
 214 |     | <span class='neutral'>     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed</span>
 215 |     | <span class='neutral'>     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that</span>
 216 |     | <span class='neutral'>     * this function has an unbounded cost, and using it as part of a state-changing function may render the function</span>
 217 |     | <span class='neutral'>     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.</span>
 218 |     | <span class='neutral'>     */</span>
 219 |     | <span class='neutral'>    function values(Bytes32Set storage set) internal view returns (bytes32[] memory) {</span>
 220 |     | <span class='neutral'>        bytes32[] memory store = _values(set._inner);</span>
 221 |     | <span class='neutral'>        bytes32[] memory result;</span>
 222 |     | <span class='neutral'></span>
 223 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 224 |     | <span class='neutral'>        assembly {</span>
 225 |     | <span class='neutral'>            result := store</span>
 226 |     | <span class='neutral'>        }</span>
 227 |     | <span class='neutral'></span>
 228 |     | <span class='neutral'>        return result;</span>
 229 |     | <span class='neutral'>    }</span>
 230 |     | <span class='neutral'></span>
 231 |     | <span class='neutral'>    // AddressSet</span>
 232 |     | <span class='neutral'></span>
 233 |     | <span class='neutral'>    struct AddressSet {</span>
 234 |     | <span class='neutral'>        Set _inner;</span>
 235 |     | <span class='neutral'>    }</span>
 236 |     | <span class='neutral'></span>
 237 |     | <span class='neutral'>    /**</span>
 238 |     | <span class='neutral'>     * @dev Add a value to a set. O(1).</span>
 239 |     | <span class='neutral'>     *</span>
 240 |     | <span class='neutral'>     * Returns true if the value was added to the set, that is if it was not</span>
 241 |     | <span class='neutral'>     * already present.</span>
 242 |     | <span class='neutral'>     */</span>
 243 |     | <span class='neutral'>    function add(AddressSet storage set, address value) internal returns (bool) {</span>
 244 | *   | <span class='executed'>        return _add(set._inner, bytes32(uint256(uint160(value))));</span>
 245 |     | <span class='neutral'>    }</span>
 246 |     | <span class='neutral'></span>
 247 |     | <span class='neutral'>    /**</span>
 248 |     | <span class='neutral'>     * @dev Removes a value from a set. O(1).</span>
 249 |     | <span class='neutral'>     *</span>
 250 |     | <span class='neutral'>     * Returns true if the value was removed from the set, that is if it was</span>
 251 |     | <span class='neutral'>     * present.</span>
 252 |     | <span class='neutral'>     */</span>
 253 |     | <span class='neutral'>    function remove(AddressSet storage set, address value) internal returns (bool) {</span>
 254 |     | <span class='unexecuted'>        return _remove(set._inner, bytes32(uint256(uint160(value))));</span>
 255 |     | <span class='neutral'>    }</span>
 256 |     | <span class='neutral'></span>
 257 |     | <span class='neutral'>    /**</span>
 258 |     | <span class='neutral'>     * @dev Returns true if the value is in the set. O(1).</span>
 259 |     | <span class='neutral'>     */</span>
 260 |     | <span class='neutral'>    function contains(AddressSet storage set, address value) internal view returns (bool) {</span>
 261 | *   | <span class='executed'>        return _contains(set._inner, bytes32(uint256(uint160(value))));</span>
 262 |     | <span class='neutral'>    }</span>
 263 |     | <span class='neutral'></span>
 264 |     | <span class='neutral'>    /**</span>
 265 |     | <span class='neutral'>     * @dev Returns the number of values in the set. O(1).</span>
 266 |     | <span class='neutral'>     */</span>
 267 |     | <span class='neutral'>    function length(AddressSet storage set) internal view returns (uint256) {</span>
 268 |     | <span class='neutral'>        return _length(set._inner);</span>
 269 |     | <span class='neutral'>    }</span>
 270 |     | <span class='neutral'></span>
 271 |     | <span class='neutral'>    /**</span>
 272 |     | <span class='neutral'>     * @dev Returns the value stored at position `index` in the set. O(1).</span>
 273 |     | <span class='neutral'>     *</span>
 274 |     | <span class='neutral'>     * Note that there are no guarantees on the ordering of values inside the</span>
 275 |     | <span class='neutral'>     * array, and it may change when more values are added or removed.</span>
 276 |     | <span class='neutral'>     *</span>
 277 |     | <span class='neutral'>     * Requirements:</span>
 278 |     | <span class='neutral'>     *</span>
 279 |     | <span class='neutral'>     * - `index` must be strictly less than {length}.</span>
 280 |     | <span class='neutral'>     */</span>
 281 |     | <span class='neutral'>    function at(AddressSet storage set, uint256 index) internal view returns (address) {</span>
 282 |     | <span class='neutral'>        return address(uint160(uint256(_at(set._inner, index))));</span>
 283 |     | <span class='neutral'>    }</span>
 284 |     | <span class='neutral'></span>
 285 |     | <span class='neutral'>    /**</span>
 286 |     | <span class='neutral'>     * @dev Return the entire set in an array</span>
 287 |     | <span class='neutral'>     *</span>
 288 |     | <span class='neutral'>     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed</span>
 289 |     | <span class='neutral'>     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that</span>
 290 |     | <span class='neutral'>     * this function has an unbounded cost, and using it as part of a state-changing function may render the function</span>
 291 |     | <span class='neutral'>     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.</span>
 292 |     | <span class='neutral'>     */</span>
 293 |     | <span class='neutral'>    function values(AddressSet storage set) internal view returns (address[] memory) {</span>
 294 |     | <span class='neutral'>        bytes32[] memory store = _values(set._inner);</span>
 295 |     | <span class='neutral'>        address[] memory result;</span>
 296 |     | <span class='neutral'></span>
 297 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 298 |     | <span class='neutral'>        assembly {</span>
 299 |     | <span class='neutral'>            result := store</span>
 300 |     | <span class='neutral'>        }</span>
 301 |     | <span class='neutral'></span>
 302 |     | <span class='neutral'>        return result;</span>
 303 |     | <span class='neutral'>    }</span>
 304 |     | <span class='neutral'></span>
 305 |     | <span class='neutral'>    // UintSet</span>
 306 |     | <span class='neutral'></span>
 307 |     | <span class='neutral'>    struct UintSet {</span>
 308 |     | <span class='neutral'>        Set _inner;</span>
 309 |     | <span class='neutral'>    }</span>
 310 |     | <span class='neutral'></span>
 311 |     | <span class='neutral'>    /**</span>
 312 |     | <span class='neutral'>     * @dev Add a value to a set. O(1).</span>
 313 |     | <span class='neutral'>     *</span>
 314 |     | <span class='neutral'>     * Returns true if the value was added to the set, that is if it was not</span>
 315 |     | <span class='neutral'>     * already present.</span>
 316 |     | <span class='neutral'>     */</span>
 317 |     | <span class='neutral'>    function add(UintSet storage set, uint256 value) internal returns (bool) {</span>
 318 |     | <span class='neutral'>        return _add(set._inner, bytes32(value));</span>
 319 |     | <span class='neutral'>    }</span>
 320 |     | <span class='neutral'></span>
 321 |     | <span class='neutral'>    /**</span>
 322 |     | <span class='neutral'>     * @dev Removes a value from a set. O(1).</span>
 323 |     | <span class='neutral'>     *</span>
 324 |     | <span class='neutral'>     * Returns true if the value was removed from the set, that is if it was</span>
 325 |     | <span class='neutral'>     * present.</span>
 326 |     | <span class='neutral'>     */</span>
 327 |     | <span class='neutral'>    function remove(UintSet storage set, uint256 value) internal returns (bool) {</span>
 328 |     | <span class='neutral'>        return _remove(set._inner, bytes32(value));</span>
 329 |     | <span class='neutral'>    }</span>
 330 |     | <span class='neutral'></span>
 331 |     | <span class='neutral'>    /**</span>
 332 |     | <span class='neutral'>     * @dev Returns true if the value is in the set. O(1).</span>
 333 |     | <span class='neutral'>     */</span>
 334 |     | <span class='neutral'>    function contains(UintSet storage set, uint256 value) internal view returns (bool) {</span>
 335 |     | <span class='neutral'>        return _contains(set._inner, bytes32(value));</span>
 336 |     | <span class='neutral'>    }</span>
 337 |     | <span class='neutral'></span>
 338 |     | <span class='neutral'>    /**</span>
 339 |     | <span class='neutral'>     * @dev Returns the number of values in the set. O(1).</span>
 340 |     | <span class='neutral'>     */</span>
 341 |     | <span class='neutral'>    function length(UintSet storage set) internal view returns (uint256) {</span>
 342 |     | <span class='neutral'>        return _length(set._inner);</span>
 343 |     | <span class='neutral'>    }</span>
 344 |     | <span class='neutral'></span>
 345 |     | <span class='neutral'>    /**</span>
 346 |     | <span class='neutral'>     * @dev Returns the value stored at position `index` in the set. O(1).</span>
 347 |     | <span class='neutral'>     *</span>
 348 |     | <span class='neutral'>     * Note that there are no guarantees on the ordering of values inside the</span>
 349 |     | <span class='neutral'>     * array, and it may change when more values are added or removed.</span>
 350 |     | <span class='neutral'>     *</span>
 351 |     | <span class='neutral'>     * Requirements:</span>
 352 |     | <span class='neutral'>     *</span>
 353 |     | <span class='neutral'>     * - `index` must be strictly less than {length}.</span>
 354 |     | <span class='neutral'>     */</span>
 355 |     | <span class='neutral'>    function at(UintSet storage set, uint256 index) internal view returns (uint256) {</span>
 356 |     | <span class='neutral'>        return uint256(_at(set._inner, index));</span>
 357 |     | <span class='neutral'>    }</span>
 358 |     | <span class='neutral'></span>
 359 |     | <span class='neutral'>    /**</span>
 360 |     | <span class='neutral'>     * @dev Return the entire set in an array</span>
 361 |     | <span class='neutral'>     *</span>
 362 |     | <span class='neutral'>     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed</span>
 363 |     | <span class='neutral'>     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that</span>
 364 |     | <span class='neutral'>     * this function has an unbounded cost, and using it as part of a state-changing function may render the function</span>
 365 |     | <span class='neutral'>     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.</span>
 366 |     | <span class='neutral'>     */</span>
 367 |     | <span class='neutral'>    function values(UintSet storage set) internal view returns (uint256[] memory) {</span>
 368 |     | <span class='neutral'>        bytes32[] memory store = _values(set._inner);</span>
 369 |     | <span class='neutral'>        uint256[] memory result;</span>
 370 |     | <span class='neutral'></span>
 371 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 372 |     | <span class='neutral'>        assembly {</span>
 373 |     | <span class='neutral'>            result := store</span>
 374 |     | <span class='neutral'>        }</span>
 375 |     | <span class='neutral'></span>
 376 |     | <span class='neutral'>        return result;</span>
 377 |     | <span class='neutral'>    }</span>
 378 |     | <span class='neutral'>}</span>
 379 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts/token/ERC20/ERC20.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (token/ERC20/ERC20.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./IERC20.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;./extensions/IERC20Metadata.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../../utils/Context.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @dev Implementation of the {IERC20} interface.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * This implementation is agnostic to the way tokens are created. This means</span>
  14 |     | <span class='neutral'> * that a supply mechanism has to be added in a derived contract using {_mint}.</span>
  15 |     | <span class='neutral'> * For a generic mechanism see {ERC20PresetMinterPauser}.</span>
  16 |     | <span class='neutral'> *</span>
  17 |     | <span class='neutral'> * TIP: For a detailed writeup see our guide</span>
  18 |     | <span class='neutral'> * https://forum.openzeppelin.com/t/how-to-implement-erc20-supply-mechanisms/226[How</span>
  19 |     | <span class='neutral'> * to implement supply mechanisms].</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> * We have followed general OpenZeppelin Contracts guidelines: functions revert</span>
  22 |     | <span class='neutral'> * instead returning `false` on failure. This behavior is nonetheless</span>
  23 |     | <span class='neutral'> * conventional and does not conflict with the expectations of ERC20</span>
  24 |     | <span class='neutral'> * applications.</span>
  25 |     | <span class='neutral'> *</span>
  26 |     | <span class='neutral'> * Additionally, an {Approval} event is emitted on calls to {transferFrom}.</span>
  27 |     | <span class='neutral'> * This allows applications to reconstruct the allowance for all accounts just</span>
  28 |     | <span class='neutral'> * by listening to said events. Other implementations of the EIP may not emit</span>
  29 |     | <span class='neutral'> * these events, as it isn&#39;t required by the specification.</span>
  30 |     | <span class='neutral'> *</span>
  31 |     | <span class='neutral'> * Finally, the non-standard {decreaseAllowance} and {increaseAllowance}</span>
  32 |     | <span class='neutral'> * functions have been added to mitigate the well-known issues around setting</span>
  33 |     | <span class='neutral'> * allowances. See {IERC20-approve}.</span>
  34 |     | <span class='neutral'> */</span>
  35 |     | <span class='unexecuted'>contract ERC20 is Context, IERC20, IERC20Metadata {</span>
  36 |     | <span class='neutral'>    mapping(address =&gt; uint256) private _balances;</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    mapping(address =&gt; mapping(address =&gt; uint256)) private _allowances;</span>
  39 |     | <span class='neutral'></span>
  40 |     | <span class='neutral'>    uint256 private _totalSupply;</span>
  41 |     | <span class='neutral'></span>
  42 |     | <span class='neutral'>    string private _name;</span>
  43 |     | <span class='neutral'>    string private _symbol;</span>
  44 |     | <span class='neutral'></span>
  45 |     | <span class='neutral'>    /**</span>
  46 |     | <span class='neutral'>     * @dev Sets the values for {name} and {symbol}.</span>
  47 |     | <span class='neutral'>     *</span>
  48 |     | <span class='neutral'>     * The default value of {decimals} is 18. To select a different value for</span>
  49 |     | <span class='neutral'>     * {decimals} you should overload it.</span>
  50 |     | <span class='neutral'>     *</span>
  51 |     | <span class='neutral'>     * All two of these values are immutable: they can only be set once during</span>
  52 |     | <span class='neutral'>     * construction.</span>
  53 |     | <span class='neutral'>     */</span>
  54 |     | <span class='neutral'>    constructor(string memory name_, string memory symbol_) {</span>
  55 | *   | <span class='executed'>        _name = name_;</span>
  56 | *   | <span class='executed'>        _symbol = symbol_;</span>
  57 |     | <span class='neutral'>    }</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    /**</span>
  60 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
  61 |     | <span class='neutral'>     */</span>
  62 |     | <span class='neutral'>    function name() public view virtual override returns (string memory) {</span>
  63 |     | <span class='unexecuted'>        return _name;</span>
  64 |     | <span class='neutral'>    }</span>
  65 |     | <span class='neutral'></span>
  66 |     | <span class='neutral'>    /**</span>
  67 |     | <span class='neutral'>     * @dev Returns the symbol of the token, usually a shorter version of the</span>
  68 |     | <span class='neutral'>     * name.</span>
  69 |     | <span class='neutral'>     */</span>
  70 |     | <span class='neutral'>    function symbol() public view virtual override returns (string memory) {</span>
  71 |     | <span class='neutral'>        return _symbol;</span>
  72 |     | <span class='neutral'>    }</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='neutral'>    /**</span>
  75 |     | <span class='neutral'>     * @dev Returns the number of decimals used to get its user representation.</span>
  76 |     | <span class='neutral'>     * For example, if `decimals` equals `2`, a balance of `505` tokens should</span>
  77 |     | <span class='neutral'>     * be displayed to a user as `5.05` (`505 / 10 ** 2`).</span>
  78 |     | <span class='neutral'>     *</span>
  79 |     | <span class='neutral'>     * Tokens usually opt for a value of 18, imitating the relationship between</span>
  80 |     | <span class='neutral'>     * Ether and Wei. This is the value {ERC20} uses, unless this function is</span>
  81 |     | <span class='neutral'>     * overridden;</span>
  82 |     | <span class='neutral'>     *</span>
  83 |     | <span class='neutral'>     * NOTE: This information is only used for _display_ purposes: it in</span>
  84 |     | <span class='neutral'>     * no way affects any of the arithmetic of the contract, including</span>
  85 |     | <span class='neutral'>     * {IERC20-balanceOf} and {IERC20-transfer}.</span>
  86 |     | <span class='neutral'>     */</span>
  87 |     | <span class='neutral'>    function decimals() public view virtual override returns (uint8) {</span>
  88 |     | <span class='unexecuted'>        return 18;</span>
  89 |     | <span class='neutral'>    }</span>
  90 |     | <span class='neutral'></span>
  91 |     | <span class='neutral'>    /**</span>
  92 |     | <span class='neutral'>     * @dev See {IERC20-totalSupply}.</span>
  93 |     | <span class='neutral'>     */</span>
  94 |     | <span class='neutral'>    function totalSupply() public view virtual override returns (uint256) {</span>
  95 |     | <span class='unexecuted'>        return _totalSupply;</span>
  96 |     | <span class='neutral'>    }</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>    /**</span>
  99 |     | <span class='neutral'>     * @dev See {IERC20-balanceOf}.</span>
 100 |     | <span class='neutral'>     */</span>
 101 |     | <span class='neutral'>    function balanceOf(address account) public view virtual override returns (uint256) {</span>
 102 |     | <span class='neutral'>        return _balances[account];</span>
 103 |     | <span class='neutral'>    }</span>
 104 |     | <span class='neutral'></span>
 105 |     | <span class='neutral'>    /**</span>
 106 |     | <span class='neutral'>     * @dev See {IERC20-transfer}.</span>
 107 |     | <span class='neutral'>     *</span>
 108 |     | <span class='neutral'>     * Requirements:</span>
 109 |     | <span class='neutral'>     *</span>
 110 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 111 |     | <span class='neutral'>     * - the caller must have a balance of at least `amount`.</span>
 112 |     | <span class='neutral'>     */</span>
 113 |     | <span class='neutral'>    function transfer(address to, uint256 amount) public virtual override returns (bool) {</span>
 114 |     | <span class='neutral'>        address owner = _msgSender();</span>
 115 | *   | <span class='executed'>        _transfer(owner, to, amount);</span>
 116 |     | <span class='neutral'>        return true;</span>
 117 |     | <span class='neutral'>    }</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>    /**</span>
 120 |     | <span class='neutral'>     * @dev See {IERC20-allowance}.</span>
 121 |     | <span class='neutral'>     */</span>
 122 |     | <span class='neutral'>    function allowance(address owner, address spender) public view virtual override returns (uint256) {</span>
 123 |     | <span class='neutral'>        return _allowances[owner][spender];</span>
 124 |     | <span class='neutral'>    }</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    /**</span>
 127 |     | <span class='neutral'>     * @dev See {IERC20-approve}.</span>
 128 |     | <span class='neutral'>     *</span>
 129 |     | <span class='neutral'>     * NOTE: If `amount` is the maximum `uint256`, the allowance is not updated on</span>
 130 |     | <span class='neutral'>     * `transferFrom`. This is semantically equivalent to an infinite approval.</span>
 131 |     | <span class='neutral'>     *</span>
 132 |     | <span class='neutral'>     * Requirements:</span>
 133 |     | <span class='neutral'>     *</span>
 134 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 135 |     | <span class='neutral'>     */</span>
 136 |     | <span class='neutral'>    function approve(address spender, uint256 amount) public virtual override returns (bool) {</span>
 137 |     | <span class='neutral'>        address owner = _msgSender();</span>
 138 | *   | <span class='executed'>        _approve(owner, spender, amount);</span>
 139 |     | <span class='neutral'>        return true;</span>
 140 |     | <span class='neutral'>    }</span>
 141 |     | <span class='neutral'></span>
 142 |     | <span class='neutral'>    /**</span>
 143 |     | <span class='neutral'>     * @dev See {IERC20-transferFrom}.</span>
 144 |     | <span class='neutral'>     *</span>
 145 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance. This is not</span>
 146 |     | <span class='neutral'>     * required by the EIP. See the note at the beginning of {ERC20}.</span>
 147 |     | <span class='neutral'>     *</span>
 148 |     | <span class='neutral'>     * NOTE: Does not update the allowance if the current allowance</span>
 149 |     | <span class='neutral'>     * is the maximum `uint256`.</span>
 150 |     | <span class='neutral'>     *</span>
 151 |     | <span class='neutral'>     * Requirements:</span>
 152 |     | <span class='neutral'>     *</span>
 153 |     | <span class='neutral'>     * - `from` and `to` cannot be the zero address.</span>
 154 |     | <span class='neutral'>     * - `from` must have a balance of at least `amount`.</span>
 155 |     | <span class='neutral'>     * - the caller must have allowance for ``from``&#39;s tokens of at least</span>
 156 |     | <span class='neutral'>     * `amount`.</span>
 157 |     | <span class='neutral'>     */</span>
 158 |     | <span class='neutral'>    function transferFrom(</span>
 159 |     | <span class='neutral'>        address from,</span>
 160 |     | <span class='neutral'>        address to,</span>
 161 |     | <span class='neutral'>        uint256 amount</span>
 162 |     | <span class='neutral'>    ) public virtual override returns (bool) {</span>
 163 |     | <span class='neutral'>        address spender = _msgSender();</span>
 164 |     | <span class='neutral'>        _spendAllowance(from, spender, amount);</span>
 165 | *   | <span class='executed'>        _transfer(from, to, amount);</span>
 166 |     | <span class='neutral'>        return true;</span>
 167 |     | <span class='neutral'>    }</span>
 168 |     | <span class='neutral'></span>
 169 |     | <span class='neutral'>    /**</span>
 170 |     | <span class='neutral'>     * @dev Atomically increases the allowance granted to `spender` by the caller.</span>
 171 |     | <span class='neutral'>     *</span>
 172 |     | <span class='neutral'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 173 |     | <span class='neutral'>     * problems described in {IERC20-approve}.</span>
 174 |     | <span class='neutral'>     *</span>
 175 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance.</span>
 176 |     | <span class='neutral'>     *</span>
 177 |     | <span class='neutral'>     * Requirements:</span>
 178 |     | <span class='neutral'>     *</span>
 179 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 180 |     | <span class='neutral'>     */</span>
 181 |     | <span class='neutral'>    function increaseAllowance(address spender, uint256 addedValue) public virtual returns (bool) {</span>
 182 |     | <span class='neutral'>        address owner = _msgSender();</span>
 183 |     | <span class='unexecuted'>        _approve(owner, spender, allowance(owner, spender) + addedValue);</span>
 184 |     | <span class='neutral'>        return true;</span>
 185 |     | <span class='neutral'>    }</span>
 186 |     | <span class='neutral'></span>
 187 |     | <span class='neutral'>    /**</span>
 188 |     | <span class='neutral'>     * @dev Atomically decreases the allowance granted to `spender` by the caller.</span>
 189 |     | <span class='neutral'>     *</span>
 190 |     | <span class='neutral'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 191 |     | <span class='neutral'>     * problems described in {IERC20-approve}.</span>
 192 |     | <span class='neutral'>     *</span>
 193 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance.</span>
 194 |     | <span class='neutral'>     *</span>
 195 |     | <span class='neutral'>     * Requirements:</span>
 196 |     | <span class='neutral'>     *</span>
 197 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 198 |     | <span class='neutral'>     * - `spender` must have allowance for the caller of at least</span>
 199 |     | <span class='neutral'>     * `subtractedValue`.</span>
 200 |     | <span class='neutral'>     */</span>
 201 |     | <span class='neutral'>    function decreaseAllowance(address spender, uint256 subtractedValue) public virtual returns (bool) {</span>
 202 |     | <span class='neutral'>        address owner = _msgSender();</span>
 203 |     | <span class='neutral'>        uint256 currentAllowance = allowance(owner, spender);</span>
 204 |     | <span class='unexecuted'>        require(currentAllowance &gt;= subtractedValue, &quot;ERC20: decreased allowance below zero&quot;);</span>
 205 |     | <span class='neutral'>        unchecked {</span>
 206 |     | <span class='unexecuted'>            _approve(owner, spender, currentAllowance - subtractedValue);</span>
 207 |     | <span class='neutral'>        }</span>
 208 |     | <span class='neutral'></span>
 209 |     | <span class='neutral'>        return true;</span>
 210 |     | <span class='neutral'>    }</span>
 211 |     | <span class='neutral'></span>
 212 |     | <span class='neutral'>    /**</span>
 213 |     | <span class='neutral'>     * @dev Moves `amount` of tokens from `from` to `to`.</span>
 214 |     | <span class='neutral'>     *</span>
 215 |     | <span class='neutral'>     * This internal function is equivalent to {transfer}, and can be used to</span>
 216 |     | <span class='neutral'>     * e.g. implement automatic token fees, slashing mechanisms, etc.</span>
 217 |     | <span class='neutral'>     *</span>
 218 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 219 |     | <span class='neutral'>     *</span>
 220 |     | <span class='neutral'>     * Requirements:</span>
 221 |     | <span class='neutral'>     *</span>
 222 |     | <span class='neutral'>     * - `from` cannot be the zero address.</span>
 223 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 224 |     | <span class='neutral'>     * - `from` must have a balance of at least `amount`.</span>
 225 |     | <span class='neutral'>     */</span>
 226 | *   | <span class='executed'>    function _transfer(</span>
 227 |     | <span class='neutral'>        address from,</span>
 228 |     | <span class='neutral'>        address to,</span>
 229 |     | <span class='neutral'>        uint256 amount</span>
 230 |     | <span class='neutral'>    ) internal virtual {</span>
 231 | *   | <span class='executed'>        require(from != address(0), &quot;ERC20: transfer from the zero address&quot;);</span>
 232 | *   | <span class='executed'>        require(to != address(0), &quot;ERC20: transfer to the zero address&quot;);</span>
 233 |     | <span class='neutral'></span>
 234 |     | <span class='neutral'>        _beforeTokenTransfer(from, to, amount);</span>
 235 |     | <span class='neutral'></span>
 236 |     | <span class='neutral'>        uint256 fromBalance = _balances[from];</span>
 237 | *   | <span class='executed'>        require(fromBalance &gt;= amount, &quot;ERC20: transfer amount exceeds balance&quot;);</span>
 238 |     | <span class='neutral'>        unchecked {</span>
 239 |     | <span class='neutral'>            _balances[from] = fromBalance - amount;</span>
 240 |     | <span class='neutral'>            // Overflow not possible: the sum of all balances is capped by totalSupply, and the sum is preserved by</span>
 241 |     | <span class='neutral'>            // decrementing then incrementing.</span>
 242 |     | <span class='neutral'>            _balances[to] += amount;</span>
 243 |     | <span class='neutral'>        }</span>
 244 |     | <span class='neutral'></span>
 245 | *   | <span class='executed'>        emit Transfer(from, to, amount);</span>
 246 |     | <span class='neutral'></span>
 247 |     | <span class='neutral'>        _afterTokenTransfer(from, to, amount);</span>
 248 |     | <span class='neutral'>    }</span>
 249 |     | <span class='neutral'></span>
 250 |     | <span class='neutral'>    /** @dev Creates `amount` tokens and assigns them to `account`, increasing</span>
 251 |     | <span class='neutral'>     * the total supply.</span>
 252 |     | <span class='neutral'>     *</span>
 253 |     | <span class='neutral'>     * Emits a {Transfer} event with `from` set to the zero address.</span>
 254 |     | <span class='neutral'>     *</span>
 255 |     | <span class='neutral'>     * Requirements:</span>
 256 |     | <span class='neutral'>     *</span>
 257 |     | <span class='neutral'>     * - `account` cannot be the zero address.</span>
 258 |     | <span class='neutral'>     */</span>
 259 |     | <span class='neutral'>    function _mint(address account, uint256 amount) internal virtual {</span>
 260 | *   | <span class='executed'>        require(account != address(0), &quot;ERC20: mint to the zero address&quot;);</span>
 261 |     | <span class='neutral'></span>
 262 |     | <span class='neutral'>        _beforeTokenTransfer(address(0), account, amount);</span>
 263 |     | <span class='neutral'></span>
 264 | *   | <span class='executed'>        _totalSupply += amount;</span>
 265 |     | <span class='neutral'>        unchecked {</span>
 266 |     | <span class='neutral'>            // Overflow not possible: balance + amount is at most totalSupply + amount, which is checked above.</span>
 267 |     | <span class='neutral'>            _balances[account] += amount;</span>
 268 |     | <span class='neutral'>        }</span>
 269 | *   | <span class='executed'>        emit Transfer(address(0), account, amount);</span>
 270 |     | <span class='neutral'></span>
 271 |     | <span class='neutral'>        _afterTokenTransfer(address(0), account, amount);</span>
 272 |     | <span class='neutral'>    }</span>
 273 |     | <span class='neutral'></span>
 274 |     | <span class='neutral'>    /**</span>
 275 |     | <span class='neutral'>     * @dev Destroys `amount` tokens from `account`, reducing the</span>
 276 |     | <span class='neutral'>     * total supply.</span>
 277 |     | <span class='neutral'>     *</span>
 278 |     | <span class='neutral'>     * Emits a {Transfer} event with `to` set to the zero address.</span>
 279 |     | <span class='neutral'>     *</span>
 280 |     | <span class='neutral'>     * Requirements:</span>
 281 |     | <span class='neutral'>     *</span>
 282 |     | <span class='neutral'>     * - `account` cannot be the zero address.</span>
 283 |     | <span class='neutral'>     * - `account` must have at least `amount` tokens.</span>
 284 |     | <span class='neutral'>     */</span>
 285 |     | <span class='neutral'>    function _burn(address account, uint256 amount) internal virtual {</span>
 286 |     | <span class='neutral'>        require(account != address(0), &quot;ERC20: burn from the zero address&quot;);</span>
 287 |     | <span class='neutral'></span>
 288 |     | <span class='neutral'>        _beforeTokenTransfer(account, address(0), amount);</span>
 289 |     | <span class='neutral'></span>
 290 |     | <span class='neutral'>        uint256 accountBalance = _balances[account];</span>
 291 |     | <span class='neutral'>        require(accountBalance &gt;= amount, &quot;ERC20: burn amount exceeds balance&quot;);</span>
 292 |     | <span class='neutral'>        unchecked {</span>
 293 |     | <span class='neutral'>            _balances[account] = accountBalance - amount;</span>
 294 |     | <span class='neutral'>            // Overflow not possible: amount &lt;= accountBalance &lt;= totalSupply.</span>
 295 |     | <span class='neutral'>            _totalSupply -= amount;</span>
 296 |     | <span class='neutral'>        }</span>
 297 |     | <span class='neutral'></span>
 298 |     | <span class='neutral'>        emit Transfer(account, address(0), amount);</span>
 299 |     | <span class='neutral'></span>
 300 |     | <span class='neutral'>        _afterTokenTransfer(account, address(0), amount);</span>
 301 |     | <span class='neutral'>    }</span>
 302 |     | <span class='neutral'></span>
 303 |     | <span class='neutral'>    /**</span>
 304 |     | <span class='neutral'>     * @dev Sets `amount` as the allowance of `spender` over the `owner` s tokens.</span>
 305 |     | <span class='neutral'>     *</span>
 306 |     | <span class='neutral'>     * This internal function is equivalent to `approve`, and can be used to</span>
 307 |     | <span class='neutral'>     * e.g. set automatic allowances for certain subsystems, etc.</span>
 308 |     | <span class='neutral'>     *</span>
 309 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 310 |     | <span class='neutral'>     *</span>
 311 |     | <span class='neutral'>     * Requirements:</span>
 312 |     | <span class='neutral'>     *</span>
 313 |     | <span class='neutral'>     * - `owner` cannot be the zero address.</span>
 314 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 315 |     | <span class='neutral'>     */</span>
 316 | *   | <span class='executed'>    function _approve(</span>
 317 |     | <span class='neutral'>        address owner,</span>
 318 |     | <span class='neutral'>        address spender,</span>
 319 |     | <span class='neutral'>        uint256 amount</span>
 320 |     | <span class='neutral'>    ) internal virtual {</span>
 321 | *   | <span class='executed'>        require(owner != address(0), &quot;ERC20: approve from the zero address&quot;);</span>
 322 | *   | <span class='executed'>        require(spender != address(0), &quot;ERC20: approve to the zero address&quot;);</span>
 323 |     | <span class='neutral'></span>
 324 | *   | <span class='executed'>        _allowances[owner][spender] = amount;</span>
 325 | *   | <span class='executed'>        emit Approval(owner, spender, amount);</span>
 326 |     | <span class='neutral'>    }</span>
 327 |     | <span class='neutral'></span>
 328 |     | <span class='neutral'>    /**</span>
 329 |     | <span class='neutral'>     * @dev Updates `owner` s allowance for `spender` based on spent `amount`.</span>
 330 |     | <span class='neutral'>     *</span>
 331 |     | <span class='neutral'>     * Does not update the allowance amount in case of infinite allowance.</span>
 332 |     | <span class='neutral'>     * Revert if not enough allowance is available.</span>
 333 |     | <span class='neutral'>     *</span>
 334 |     | <span class='neutral'>     * Might emit an {Approval} event.</span>
 335 |     | <span class='neutral'>     */</span>
 336 |     | <span class='neutral'>    function _spendAllowance(</span>
 337 |     | <span class='neutral'>        address owner,</span>
 338 |     | <span class='neutral'>        address spender,</span>
 339 |     | <span class='neutral'>        uint256 amount</span>
 340 |     | <span class='neutral'>    ) internal virtual {</span>
 341 |     | <span class='neutral'>        uint256 currentAllowance = allowance(owner, spender);</span>
 342 | *   | <span class='executed'>        if (currentAllowance != type(uint256).max) {</span>
 343 |     | <span class='unexecuted'>            require(currentAllowance &gt;= amount, &quot;ERC20: insufficient allowance&quot;);</span>
 344 |     | <span class='neutral'>            unchecked {</span>
 345 |     | <span class='unexecuted'>                _approve(owner, spender, currentAllowance - amount);</span>
 346 |     | <span class='neutral'>            }</span>
 347 |     | <span class='neutral'>        }</span>
 348 |     | <span class='neutral'>    }</span>
 349 |     | <span class='neutral'></span>
 350 |     | <span class='neutral'>    /**</span>
 351 |     | <span class='neutral'>     * @dev Hook that is called before any transfer of tokens. This includes</span>
 352 |     | <span class='neutral'>     * minting and burning.</span>
 353 |     | <span class='neutral'>     *</span>
 354 |     | <span class='neutral'>     * Calling conditions:</span>
 355 |     | <span class='neutral'>     *</span>
 356 |     | <span class='neutral'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 357 |     | <span class='neutral'>     * will be transferred to `to`.</span>
 358 |     | <span class='neutral'>     * - when `from` is zero, `amount` tokens will be minted for `to`.</span>
 359 |     | <span class='neutral'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens will be burned.</span>
 360 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 361 |     | <span class='neutral'>     *</span>
 362 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 363 |     | <span class='neutral'>     */</span>
 364 |     | <span class='neutral'>    function _beforeTokenTransfer(</span>
 365 |     | <span class='neutral'>        address from,</span>
 366 |     | <span class='neutral'>        address to,</span>
 367 |     | <span class='neutral'>        uint256 amount</span>
 368 |     | <span class='neutral'>    ) internal virtual {}</span>
 369 |     | <span class='neutral'></span>
 370 |     | <span class='neutral'>    /**</span>
 371 |     | <span class='neutral'>     * @dev Hook that is called after any transfer of tokens. This includes</span>
 372 |     | <span class='neutral'>     * minting and burning.</span>
 373 |     | <span class='neutral'>     *</span>
 374 |     | <span class='neutral'>     * Calling conditions:</span>
 375 |     | <span class='neutral'>     *</span>
 376 |     | <span class='neutral'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 377 |     | <span class='neutral'>     * has been transferred to `to`.</span>
 378 |     | <span class='neutral'>     * - when `from` is zero, `amount` tokens have been minted for `to`.</span>
 379 |     | <span class='neutral'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens have been burned.</span>
 380 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 381 |     | <span class='neutral'>     *</span>
 382 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 383 |     | <span class='neutral'>     */</span>
 384 |     | <span class='neutral'>    function _afterTokenTransfer(</span>
 385 |     | <span class='neutral'>        address from,</span>
 386 |     | <span class='neutral'>        address to,</span>
 387 |     | <span class='neutral'>        uint256 amount</span>
 388 |     | <span class='neutral'>    ) internal virtual {}</span>
 389 |     | <span class='neutral'>}</span>
 390 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts/token/ERC20/IERC20.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.6.0) (token/ERC20/IERC20.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC20 standard as defined in the EIP.</span>
  8 |     | <span class='neutral'> */</span>
  9 |     | <span class='neutral'>interface IERC20 {</span>
 10 |     | <span class='neutral'>    /**</span>
 11 |     | <span class='neutral'>     * @dev Emitted when `value` tokens are moved from one account (`from`) to</span>
 12 |     | <span class='neutral'>     * another (`to`).</span>
 13 |     | <span class='neutral'>     *</span>
 14 |     | <span class='neutral'>     * Note that `value` may be zero.</span>
 15 |     | <span class='neutral'>     */</span>
 16 |     | <span class='neutral'>    event Transfer(address indexed from, address indexed to, uint256 value);</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='neutral'>    /**</span>
 19 |     | <span class='neutral'>     * @dev Emitted when the allowance of a `spender` for an `owner` is set by</span>
 20 |     | <span class='neutral'>     * a call to {approve}. `value` is the new allowance.</span>
 21 |     | <span class='neutral'>     */</span>
 22 |     | <span class='neutral'>    event Approval(address indexed owner, address indexed spender, uint256 value);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the amount of tokens in existence.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function totalSupply() external view returns (uint256);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    /**</span>
 30 |     | <span class='neutral'>     * @dev Returns the amount of tokens owned by `account`.</span>
 31 |     | <span class='neutral'>     */</span>
 32 |     | <span class='neutral'>    function balanceOf(address account) external view returns (uint256);</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    /**</span>
 35 |     | <span class='neutral'>     * @dev Moves `amount` tokens from the caller&#39;s account to `to`.</span>
 36 |     | <span class='neutral'>     *</span>
 37 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 38 |     | <span class='neutral'>     *</span>
 39 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 40 |     | <span class='neutral'>     */</span>
 41 |     | <span class='neutral'>    function transfer(address to, uint256 amount) external returns (bool);</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='neutral'>    /**</span>
 44 |     | <span class='neutral'>     * @dev Returns the remaining number of tokens that `spender` will be</span>
 45 |     | <span class='neutral'>     * allowed to spend on behalf of `owner` through {transferFrom}. This is</span>
 46 |     | <span class='neutral'>     * zero by default.</span>
 47 |     | <span class='neutral'>     *</span>
 48 |     | <span class='neutral'>     * This value changes when {approve} or {transferFrom} are called.</span>
 49 |     | <span class='neutral'>     */</span>
 50 |     | <span class='neutral'>    function allowance(address owner, address spender) external view returns (uint256);</span>
 51 |     | <span class='neutral'></span>
 52 |     | <span class='neutral'>    /**</span>
 53 |     | <span class='neutral'>     * @dev Sets `amount` as the allowance of `spender` over the caller&#39;s tokens.</span>
 54 |     | <span class='neutral'>     *</span>
 55 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 56 |     | <span class='neutral'>     *</span>
 57 |     | <span class='neutral'>     * IMPORTANT: Beware that changing an allowance with this method brings the risk</span>
 58 |     | <span class='neutral'>     * that someone may use both the old and the new allowance by unfortunate</span>
 59 |     | <span class='neutral'>     * transaction ordering. One possible solution to mitigate this race</span>
 60 |     | <span class='neutral'>     * condition is to first reduce the spender&#39;s allowance to 0 and set the</span>
 61 |     | <span class='neutral'>     * desired value afterwards:</span>
 62 |     | <span class='neutral'>     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729</span>
 63 |     | <span class='neutral'>     *</span>
 64 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 65 |     | <span class='neutral'>     */</span>
 66 |     | <span class='neutral'>    function approve(address spender, uint256 amount) external returns (bool);</span>
 67 |     | <span class='neutral'></span>
 68 |     | <span class='neutral'>    /**</span>
 69 |     | <span class='neutral'>     * @dev Moves `amount` tokens from `from` to `to` using the</span>
 70 |     | <span class='neutral'>     * allowance mechanism. `amount` is then deducted from the caller&#39;s</span>
 71 |     | <span class='neutral'>     * allowance.</span>
 72 |     | <span class='neutral'>     *</span>
 73 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 74 |     | <span class='neutral'>     *</span>
 75 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 76 |     | <span class='neutral'>     */</span>
 77 |     | <span class='neutral'>    function transferFrom(</span>
 78 |     | <span class='neutral'>        address from,</span>
 79 |     | <span class='neutral'>        address to,</span>
 80 |     | <span class='neutral'>        uint256 amount</span>
 81 |     | <span class='neutral'>    ) external returns (bool);</span>
 82 |     | <span class='neutral'>}</span>
 83 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (token/ERC20/extensions/IERC20Metadata.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../IERC20.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Interface for the optional metadata functions from the ERC20 standard.</span>
 10 |     | <span class='neutral'> *</span>
 11 |     | <span class='neutral'> * _Available since v4.1._</span>
 12 |     | <span class='neutral'> */</span>
 13 |     | <span class='neutral'>interface IERC20Metadata is IERC20 {</span>
 14 |     | <span class='neutral'>    /**</span>
 15 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
 16 |     | <span class='neutral'>     */</span>
 17 |     | <span class='neutral'>    function name() external view returns (string memory);</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    /**</span>
 20 |     | <span class='neutral'>     * @dev Returns the symbol of the token.</span>
 21 |     | <span class='neutral'>     */</span>
 22 |     | <span class='neutral'>    function symbol() external view returns (string memory);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the decimals places of the token.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function decimals() external view returns (uint8);</span>
 28 |     | <span class='neutral'>}</span>
 29 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/@openzeppelin/contracts/utils/Context.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/Context.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Provides information about the current execution context, including the</span>
  8 |     | <span class='neutral'> * sender of the transaction and its data. While these are generally available</span>
  9 |     | <span class='neutral'> * via msg.sender and msg.data, they should not be accessed in such a direct</span>
 10 |     | <span class='neutral'> * manner, since when dealing with meta-transactions the account sending and</span>
 11 |     | <span class='neutral'> * paying for execution may not be the actual sender (as far as an application</span>
 12 |     | <span class='neutral'> * is concerned).</span>
 13 |     | <span class='neutral'> *</span>
 14 |     | <span class='neutral'> * This contract is only required for intermediate, library-like contracts.</span>
 15 |     | <span class='neutral'> */</span>
 16 |     | <span class='neutral'>abstract contract Context {</span>
 17 |     | <span class='neutral'>    function _msgSender() internal view virtual returns (address) {</span>
 18 | *   | <span class='executed'>        return msg.sender;</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    function _msgData() internal view virtual returns (bytes calldata) {</span>
 22 |     | <span class='neutral'>        return msg.data;</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='neutral'>}</span>
 25 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/chimera/src/Asserts.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>abstract contract Asserts {</span>
  5 |     | <span class='neutral'>    function gt(uint256 a, uint256 b, string memory reason) internal virtual;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>    function gte(uint256 a, uint256 b, string memory reason) internal virtual;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    function lt(uint256 a, uint256 b, string memory reason) internal virtual;</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    function lte(uint256 a, uint256 b, string memory reason) internal virtual;</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    function eq(uint256 a, uint256 b, string memory reason) internal virtual;</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'>    function t(bool b, string memory reason) internal virtual;</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    function between(uint256 value, uint256 low, uint256 high) internal virtual returns (uint256);</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    function between(int256 value, int256 low, int256 high) internal virtual returns (int256);</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    function precondition(bool p) internal virtual;</span>
 22 |     | <span class='neutral'>}</span>
 23 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/chimera/src/BaseProperties.sol</b>
<code>
 1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
 2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
 3 |     | <span class='neutral'></span>
 4 |     | <span class='neutral'>import {BaseSetup} from &quot;./BaseSetup.sol&quot;;</span>
 5 |     | <span class='neutral'></span>
 6 |     | <span class='neutral'>abstract contract BaseProperties is BaseSetup {}</span>
 7 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/chimera/src/BaseSetup.sol</b>
<code>
 1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
 2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
 3 |     | <span class='neutral'></span>
 4 |     | <span class='neutral'>abstract contract BaseSetup {</span>
 5 |     | <span class='neutral'>    function setup() internal virtual;</span>
 6 |     | <span class='neutral'>}</span>
 7 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/chimera/src/BaseTargetFunctions.sol</b>
<code>
 1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
 2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
 3 |     | <span class='neutral'></span>
 4 |     | <span class='neutral'>import {BaseProperties} from &quot;./BaseProperties.sol&quot;;</span>
 5 |     | <span class='neutral'>import {Asserts} from &quot;./Asserts.sol&quot;;</span>
 6 |     | <span class='neutral'></span>
 7 |     | <span class='neutral'>abstract contract BaseTargetFunctions is BaseProperties, Asserts {}</span>
 8 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/chimera/src/CryticAsserts.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {Asserts} from &quot;./Asserts.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract CryticAsserts is Asserts {</span>
  7 |     | <span class='neutral'>    event Log(string);</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    function gt(uint256 a, uint256 b, string memory reason) internal virtual override {</span>
 10 |     | <span class='neutral'>        if (!(a &gt; b)) {</span>
 11 |     | <span class='neutral'>            emit Log(reason);</span>
 12 |     | <span class='neutral'>            assert(false);</span>
 13 |     | <span class='neutral'>        }</span>
 14 |     | <span class='neutral'>    }</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    function gte(uint256 a, uint256 b, string memory reason) internal virtual override {</span>
 17 |     | <span class='neutral'>        if (!(a &gt;= b)) {</span>
 18 |     | <span class='neutral'>            emit Log(reason);</span>
 19 |     | <span class='neutral'>            assert(false);</span>
 20 |     | <span class='neutral'>        }</span>
 21 |     | <span class='neutral'>    }</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>    function lt(uint256 a, uint256 b, string memory reason) internal virtual override {</span>
 24 |     | <span class='neutral'>        if (!(a &lt; b)) {</span>
 25 |     | <span class='neutral'>            emit Log(reason);</span>
 26 |     | <span class='neutral'>            assert(false);</span>
 27 |     | <span class='neutral'>        }</span>
 28 |     | <span class='neutral'>    }</span>
 29 |     | <span class='neutral'></span>
 30 |     | <span class='neutral'>    function lte(uint256 a, uint256 b, string memory reason) internal virtual override {</span>
 31 |     | <span class='neutral'>        if (!(a &lt;= b)) {</span>
 32 |     | <span class='neutral'>            emit Log(reason);</span>
 33 |     | <span class='neutral'>            assert(false);</span>
 34 |     | <span class='neutral'>        }</span>
 35 |     | <span class='neutral'>    }</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>    function eq(uint256 a, uint256 b, string memory reason) internal virtual override {</span>
 38 |     | <span class='neutral'>        if (!(a == b)) {</span>
 39 |     | <span class='neutral'>            emit Log(reason);</span>
 40 |     | <span class='neutral'>            assert(false);</span>
 41 |     | <span class='neutral'>        }</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'></span>
 44 |     | <span class='neutral'>    function t(bool b, string memory reason) internal virtual override {</span>
 45 |     | <span class='neutral'>        if (!b) {</span>
 46 |     | <span class='neutral'>            emit Log(reason);</span>
 47 |     | <span class='neutral'>            assert(false);</span>
 48 |     | <span class='neutral'>        }</span>
 49 |     | <span class='neutral'>    }</span>
 50 |     | <span class='neutral'></span>
 51 |     | <span class='neutral'>    function between(uint256 value, uint256 low, uint256 high) internal virtual override returns (uint256) {</span>
 52 |     | <span class='neutral'>        if (value &lt; low || value &gt; high) {</span>
 53 |     | <span class='neutral'>            uint256 ans = low + (value % (high - low + 1));</span>
 54 |     | <span class='neutral'>            return ans;</span>
 55 |     | <span class='neutral'>        }</span>
 56 |     | <span class='neutral'>        return value;</span>
 57 |     | <span class='neutral'>    }</span>
 58 |     | <span class='neutral'></span>
 59 |     | <span class='neutral'>    function between(int256 value, int256 low, int256 high) internal virtual override returns (int256) {</span>
 60 |     | <span class='neutral'>        if (value &lt; low || value &gt; high) {</span>
 61 |     | <span class='neutral'>            int256 range = high - low + 1;</span>
 62 |     | <span class='neutral'>            int256 clamped = (value - low) % (range);</span>
 63 |     | <span class='neutral'>            if (clamped &lt; 0) clamped += range;</span>
 64 |     | <span class='neutral'>            int256 ans = low + clamped;</span>
 65 |     | <span class='neutral'>            return ans;</span>
 66 |     | <span class='neutral'>        }</span>
 67 |     | <span class='neutral'>        return value;</span>
 68 |     | <span class='neutral'>    }</span>
 69 |     | <span class='neutral'></span>
 70 |     | <span class='neutral'>    function precondition(bool p) internal virtual override {</span>
 71 |     | <span class='neutral'>        require(p);</span>
 72 |     | <span class='neutral'>    }</span>
 73 |     | <span class='neutral'>}</span>
 74 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/node_modules/chimera/src/Hevm.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>// slither-disable-start shadowing-local</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>interface IHevm {</span>
  7 |     | <span class='neutral'>    // Set block.timestamp to newTimestamp</span>
  8 |     | <span class='neutral'>    function warp(uint256 newTimestamp) external;</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'>    // Set block.number to newNumber</span>
 11 |     | <span class='neutral'>    function roll(uint256 newNumber) external;</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    // Add the condition b to the assumption base for the current branch</span>
 14 |     | <span class='neutral'>    // This function is almost identical to require</span>
 15 |     | <span class='neutral'>    function assume(bool b) external;</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    // Sets the eth balance of usr to amt</span>
 18 |     | <span class='neutral'>    function deal(address usr, uint256 amt) external;</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    // Loads a storage slot from an address</span>
 21 |     | <span class='neutral'>    function load(address where, bytes32 slot) external returns (bytes32);</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>    // Stores a value to an address&#39; storage slot</span>
 24 |     | <span class='neutral'>    function store(address where, bytes32 slot, bytes32 value) external;</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'>    // Signs data (privateKey, digest) =&gt; (v, r, s)</span>
 27 |     | <span class='neutral'>    function sign(uint256 privateKey, bytes32 digest) external returns (uint8 v, bytes32 r, bytes32 s);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    // Gets address for a given private key</span>
 30 |     | <span class='neutral'>    function addr(uint256 privateKey) external returns (address addr);</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    // Performs a foreign function call via terminal</span>
 33 |     | <span class='neutral'>    function ffi(string[] calldata inputs) external returns (bytes memory result);</span>
 34 |     | <span class='neutral'></span>
 35 |     | <span class='neutral'>    // Performs the next smart contract call with specified `msg.sender`</span>
 36 |     | <span class='neutral'>    function prank(address newSender) external;</span>
 37 |     | <span class='neutral'></span>
 38 |     | <span class='neutral'>    // Creates a new fork with the given endpoint and the latest block and returns the identifier of the fork</span>
 39 |     | <span class='neutral'>    function createFork(string calldata urlOrAlias) external returns (uint256);</span>
 40 |     | <span class='neutral'></span>
 41 |     | <span class='neutral'>    // Takes a fork identifier created by createFork and sets the corresponding forked state as active</span>
 42 |     | <span class='neutral'>    function selectFork(uint256 forkId) external;</span>
 43 |     | <span class='neutral'></span>
 44 |     | <span class='neutral'>    // Returns the identifier of the current fork</span>
 45 |     | <span class='neutral'>    function activeFork() external returns (uint256);</span>
 46 |     | <span class='neutral'></span>
 47 |     | <span class='neutral'>    // Labels the address in traces</span>
 48 |     | <span class='neutral'>    function label(address addr, string calldata label) external;</span>
 49 |     | <span class='neutral'></span>
 50 |     | <span class='neutral'>    /// Sets an address&#39; code.</span>
 51 |     | <span class='neutral'>    function etch(address target, bytes calldata newRuntimeBytecode) external;</span>
 52 |     | <span class='neutral'>}</span>
 53 |     | <span class='neutral'></span>
 54 | *r  | <span class='executed'>IHevm constant vm = IHevm(0x7109709ECfa91a80626fF3989D68f67F5b1DD12D);</span>
 55 |     | <span class='neutral'></span>
 56 |     | <span class='neutral'>// slither-disable-end shadowing-local</span>
 57 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/src/IPriceFeed.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>interface IPriceFeed {</span>
  5 |     | <span class='neutral'>    function latestRoundData() external view returns (</span>
  6 |     | <span class='neutral'>        uint80 roundId,</span>
  7 |     | <span class='neutral'>        int256 answer,</span>
  8 |     | <span class='neutral'>        uint256 startedAt,</span>
  9 |     | <span class='neutral'>        uint256 updatedAt,</span>
 10 |     | <span class='neutral'>        uint80 answeredInRound</span>
 11 |     | <span class='neutral'>    );</span>
 12 |     | <span class='neutral'>}</span>
 13 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/src/IStakedAvax.sol</b>
<code>
 1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
 2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
 3 |     | <span class='neutral'></span>
 4 |     | <span class='neutral'></span>
 5 |     | <span class='neutral'>interface IStakedAvax {</span>
 6 |     | <span class='neutral'>    function accrueRewards(uint amount) external;</span>
 7 |     | <span class='neutral'>}</span>
 8 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/src/Ignite.sol</b>
<code>
    1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
    2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
    3 |     | <span class='neutral'></span>
    4 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/token/ERC20/IERC20Upgradeable.sol&quot;;</span>
    5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol&quot;;</span>
    6 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol&quot;;</span>
    7 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/access/AccessControlUpgradeable.sol&quot;;</span>
    8 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/security/ReentrancyGuardUpgradeable.sol&quot;;</span>
    9 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/security/PausableUpgradeable.sol&quot;;</span>
   10 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/utils/structs/EnumerableSetUpgradeable.sol&quot;;</span>
   11 |     | <span class='neutral'></span>
   12 |     | <span class='neutral'>import &quot;./IgniteStorage.sol&quot;;</span>
   13 |     | <span class='neutral'>import &quot;./IPriceFeed.sol&quot;;</span>
   14 |     | <span class='neutral'>import &quot;./IStakedAvax.sol&quot;;</span>
   15 |     | <span class='neutral'>import &quot;./ValidatorRewarder.sol&quot;;</span>
   16 |     | <span class='neutral'></span>
   17 |     | <span class='neutral'></span>
   18 | *   | <span class='executed'>contract Ignite is</span>
   19 |     | <span class='neutral'>    AccessControlUpgradeable,</span>
   20 |     | <span class='neutral'>    ReentrancyGuardUpgradeable,</span>
   21 |     | <span class='neutral'>    PausableUpgradeable,</span>
   22 |     | <span class='neutral'>    IgniteStorage</span>
   23 |     | <span class='neutral'>{</span>
   24 |     | <span class='neutral'>    using SafeERC20Upgradeable for IERC20Upgradeable;</span>
   25 |     | <span class='neutral'>    using SafeERC20Upgradeable for IERC20MetadataUpgradeable;</span>
   26 |     | <span class='neutral'>    using EnumerableSetUpgradeable for EnumerableSetUpgradeable.AddressSet;</span>
   27 |     | <span class='neutral'></span>
   28 | *   | <span class='executed'>    bytes32 public constant ROLE_WITHDRAW = keccak256(&quot;ROLE_WITHDRAW&quot;);</span>
   29 | *   | <span class='executed'>    bytes32 public constant ROLE_REGISTER_WITHOUT_COLLATERAL = keccak256(&quot;ROLE_REGISTER_WITHOUT_COLLATERAL&quot;);</span>
   30 |     | <span class='unexecuted'>    bytes32 public constant ROLE_RELEASE_LOCKED_TOKENS = keccak256(&quot;ROLE_RELEASE_LOCKED_TOKENS&quot;);</span>
   31 |     | <span class='unexecuted'>    bytes32 public constant ROLE_PAUSE = keccak256(&quot;ROLE_PAUSE&quot;);</span>
   32 |     | <span class='unexecuted'>    bytes32 public constant ROLE_UNPAUSE = keccak256(&quot;ROLE_UNPAUSE&quot;);</span>
   33 |     | <span class='unexecuted'>    bytes32 public constant ROLE_REGISTER_WITH_FLEXIBLE_PRICE_CHECK = keccak256(&quot;ROLE_REGISTER_WITH_FLEXIBLE_PRICE_CHECK&quot;);</span>
   34 |     | <span class='neutral'></span>
   35 | *   | <span class='executed'>    uint public constant VALIDATION_DURATION_TWO_WEEKS = 86400 * 7 * 2;</span>
   36 | *   | <span class='executed'>    uint public constant VALIDATION_DURATION_FOUR_WEEKS = 86400 * 7 * 4;</span>
   37 | *   | <span class='executed'>    uint public constant VALIDATION_DURATION_EIGHT_WEEKS = 86400 * 7 * 8;</span>
   38 | *   | <span class='executed'>    uint public constant VALIDATION_DURATION_TWELVE_WEEKS = 86400 * 7 * 12;</span>
   39 | *   | <span class='executed'>    uint public constant VALIDATION_DURATION_ONE_YEAR = 86400 * 365;</span>
   40 |     | <span class='neutral'></span>
   41 |     | <span class='neutral'>    address public constant AVAX = 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE;</span>
   42 |     | <span class='neutral'></span>
   43 | *   | <span class='executed'>    address public constant FEE_RECIPIENT = 0xaAaAaAaaAaAaAaaAaAAAAAAAAaaaAaAaAaaAaaAa;</span>
   44 |     | <span class='unexecuted'>    address public constant SLASHED_TOKEN_RECIPIENT = 0xbBbBBBBbbBBBbbbBbbBbbbbBBbBbbbbBbBbbBBbB;</span>
   45 |     | <span class='neutral'></span>
   46 |     | <span class='neutral'>    /// @dev Emitted when a user request validation to be started for a node</span>
   47 |     | <span class='neutral'>    event NewRegistration(</span>
   48 |     | <span class='neutral'>        address registerer,</span>
   49 |     | <span class='neutral'>        string nodeId,</span>
   50 |     | <span class='neutral'>        bytes blsProofOfPossession,</span>
   51 |     | <span class='neutral'>        uint validationDuration,</span>
   52 |     | <span class='neutral'>        bool feePaid,</span>
   53 |     | <span class='neutral'>        uint avaxAmount,</span>
   54 |     | <span class='neutral'>        address token,</span>
   55 |     | <span class='neutral'>        uint tokenAmount</span>
   56 |     | <span class='neutral'>    );</span>
   57 |     | <span class='neutral'></span>
   58 |     | <span class='neutral'>    /// @dev Emitted when a registration is removed from the array of registrations</span>
   59 |     | <span class='neutral'>    event RegistrationDeleted(string nodeId);</span>
   60 |     | <span class='neutral'></span>
   61 |     | <span class='neutral'>    /// @dev Emitted when AVAX is withdrawn from the contract for validation</span>
   62 |     | <span class='neutral'>    event Withdraw(uint amount);</span>
   63 |     | <span class='neutral'></span>
   64 |     | <span class='neutral'>    /// @dev Emitted when a validator is slashed for misbehaving</span>
   65 |     | <span class='neutral'>    event ValidatorSlashed(string nodeId, uint qiAmount, uint avaxAmount);</span>
   66 |     | <span class='neutral'></span>
   67 |     | <span class='neutral'>    /// @dev Emitted when the validation period for a node expires and the tokens are redeemable</span>
   68 |     | <span class='neutral'>    event RegistrationExpired(string nodeId);</span>
   69 |     | <span class='neutral'></span>
   70 |     | <span class='neutral'>    /// @dev Emitted when a user redeems their tokens after validation expiry or failed validation start attempt</span>
   71 |     | <span class='neutral'>    event Redeem(string nodeId, uint avaxAmount, address token, uint tokenAmount);</span>
   72 |     | <span class='neutral'></span>
   73 |     | <span class='neutral'>    /// @dev Emitted when a validator is rewarded</span>
   74 |     | <span class='neutral'>    event ValidatorRewarded(string nodeId, uint amount);</span>
   75 |     | <span class='neutral'></span>
   76 |     | <span class='neutral'>    /// @dev Emitted when QI slash percentage is updated</span>
   77 |     | <span class='neutral'>    event QiSlashPercentageChanged(uint oldPercentage, uint newPercentage);</span>
   78 |     | <span class='neutral'></span>
   79 |     | <span class='neutral'>    /// @dev Emitted when AVAX slash percentage is updated</span>
   80 |     | <span class='neutral'>    event AvaxSlashPercentageChanged(uint oldPercentage, uint newPercentage);</span>
   81 |     | <span class='neutral'></span>
   82 |     | <span class='neutral'>    /// @dev Emitted when the maximum protocol AVAX subsidisation amount is updated</span>
   83 |     | <span class='neutral'>    event MaximumSubsidisationAmountChanged(</span>
   84 |     | <span class='neutral'>        uint oldMaximumSubsidisationAmount,</span>
   85 |     | <span class='neutral'>        uint newMaximumSubsidisationAmount</span>
   86 |     | <span class='neutral'>    );</span>
   87 |     | <span class='neutral'></span>
   88 |     | <span class='neutral'>    /// @dev Emitted when a new fee payment option is added</span>
   89 |     | <span class='neutral'>    event PaymentTokenAdded(address token);</span>
   90 |     | <span class='neutral'></span>
   91 |     | <span class='neutral'>    /// @dev Emitted when an existing fee payment option is removed</span>
   92 |     | <span class='neutral'>    event PaymentTokenRemoved(address token);</span>
   93 |     | <span class='neutral'></span>
   94 |     | <span class='neutral'>    /// @dev Emitted when a price feed address is updated</span>
   95 |     | <span class='neutral'>    event PriceFeedChanged(</span>
   96 |     | <span class='neutral'>        address token,</span>
   97 |     | <span class='neutral'>        address oldFeed,</span>
   98 |     | <span class='neutral'>        address newFeed,</span>
   99 |     | <span class='neutral'>        uint oldMaxPriceAge,</span>
  100 |     | <span class='neutral'>        uint newMaxPriceAge</span>
  101 |     | <span class='neutral'>    );</span>
  102 |     | <span class='neutral'></span>
  103 |     | <span class='neutral'>    /// @dev Emitted when the registration AVAX requirement is updated</span>
  104 |     | <span class='neutral'>    event AvaxDepositRangeUpdated(</span>
  105 |     | <span class='neutral'>        uint oldMinimumAvaxDeposit,</span>
  106 |     | <span class='neutral'>        uint newMinimumAvaxDeposit,</span>
  107 |     | <span class='neutral'>        uint oldMaximumAvaxDeposit,</span>
  108 |     | <span class='neutral'>        uint newMaximumAvaxDeposit</span>
  109 |     | <span class='neutral'>    );</span>
  110 |     | <span class='neutral'></span>
  111 |     | <span class='neutral'>    /// @dev Emitted when the QI price multiplier for fee payments is updated</span>
  112 |     | <span class='neutral'>    event QiPriceMultiplierUpdated(uint oldQiPriceMultiplier, uint newQiPriceMultiplier);</span>
  113 |     | <span class='neutral'></span>
  114 |     | <span class='neutral'></span>
  115 |     | <span class='neutral'>    /// @custom:oz-upgrades-unsafe-allow constructor</span>
  116 |     | <span class='neutral'>    constructor() {</span>
  117 |     | <span class='neutral'>        // _disableInitializers();</span>
  118 |     | <span class='neutral'>    }</span>
  119 |     | <span class='neutral'></span>
  120 |     | <span class='neutral'>    function initialize(</span>
  121 |     | <span class='neutral'>        address _sAVAX,</span>
  122 |     | <span class='neutral'>        address _qi,</span>
  123 |     | <span class='neutral'>        address _avaxPriceFeed,</span>
  124 |     | <span class='neutral'>        uint _maxAvaxPriceAge,</span>
  125 |     | <span class='neutral'>        address _qiPriceFeed,</span>
  126 |     | <span class='neutral'>        uint _maxQiPriceAge,</span>
  127 |     | <span class='neutral'>        uint _minimumAvaxDeposit,</span>
  128 |     | <span class='neutral'>        uint _maximumAvaxDeposit</span>
  129 |     | <span class='neutral'>    ) initializer public {</span>
  130 | *   | <span class='executed'>        require(_minimumAvaxDeposit &lt;= _maximumAvaxDeposit);</span>
  131 |     | <span class='neutral'></span>
  132 |     | <span class='neutral'>        __AccessControl_init();</span>
  133 |     | <span class='neutral'>        __ReentrancyGuard_init();</span>
  134 |     | <span class='neutral'>        __Pausable_init();</span>
  135 |     | <span class='neutral'></span>
  136 | *   | <span class='executed'>        _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);</span>
  137 |     | <span class='neutral'></span>
  138 |     | <span class='neutral'>        sAVAX = IStakedAvax(_sAVAX);</span>
  139 |     | <span class='neutral'>        qi = IERC20Upgradeable(_qi);</span>
  140 |     | <span class='neutral'></span>
  141 |     | <span class='neutral'>        _initialisePriceFeeds(_avaxPriceFeed, _maxAvaxPriceAge, _qi, _qiPriceFeed, _maxQiPriceAge);</span>
  142 |     | <span class='neutral'></span>
  143 | *   | <span class='executed'>        minimumAvaxDeposit = _minimumAvaxDeposit;</span>
  144 | *   | <span class='executed'>        maximumAvaxDeposit = _maximumAvaxDeposit;</span>
  145 |     | <span class='neutral'></span>
  146 | *   | <span class='executed'>        qiSlashPercentage = 5_000;</span>
  147 |     | <span class='neutral'>        //@audit missing avaxSlashPercentage initialization </span>
  148 | *   | <span class='executed'>        maximumSubsidisationAmount = 50_000e18;</span>
  149 |     | <span class='neutral'></span>
  150 | *   | <span class='executed'>        qiPriceMultiplier = 10_000;</span>
  151 |     | <span class='neutral'></span>
  152 | *   | <span class='executed'>        registrations.push(</span>
  153 | *   | <span class='executed'>            Registration(</span>
  154 |     | <span class='neutral'>                address(0),</span>
  155 |     | <span class='neutral'>                &quot;&quot;,</span>
  156 |     | <span class='neutral'>                0,</span>
  157 |     | <span class='neutral'>                false,</span>
  158 | *   | <span class='executed'>                TokenDepositDetails(</span>
  159 |     | <span class='neutral'>                    0,</span>
  160 |     | <span class='neutral'>                    address(0),</span>
  161 |     | <span class='neutral'>                    0</span>
  162 |     | <span class='neutral'>                ),</span>
  163 |     | <span class='neutral'>                0,</span>
  164 |     | <span class='neutral'>                0,</span>
  165 |     | <span class='neutral'>                0,</span>
  166 |     | <span class='neutral'>                false,</span>
  167 |     | <span class='neutral'>                false</span>
  168 |     | <span class='neutral'>            )</span>
  169 |     | <span class='neutral'>        );</span>
  170 |     | <span class='neutral'>    }</span>
  171 |     | <span class='neutral'></span>
  172 |     | <span class='neutral'>    function _initialisePriceFeeds(</span>
  173 |     | <span class='neutral'>        address _avaxPriceFeed,</span>
  174 |     | <span class='neutral'>        uint _maxAvaxPriceAge,</span>
  175 |     | <span class='neutral'>        address _qi,</span>
  176 |     | <span class='neutral'>        address _qiPriceFeed,</span>
  177 |     | <span class='neutral'>        uint _maxQiPriceAge</span>
  178 |     | <span class='neutral'>    ) internal onlyInitializing {</span>
  179 |     | <span class='neutral'>        IPriceFeed avaxPriceFeed = IPriceFeed(_avaxPriceFeed);</span>
  180 |     | <span class='neutral'>        IPriceFeed qiPriceFeed = IPriceFeed(_qiPriceFeed);</span>
  181 |     | <span class='neutral'></span>
  182 | *   | <span class='executed'>        priceFeeds[AVAX] = avaxPriceFeed;</span>
  183 |     | <span class='neutral'>        priceFeeds[_qi] = qiPriceFeed;</span>
  184 |     | <span class='neutral'></span>
  185 | *   | <span class='executed'>        maxPriceAges[AVAX] = _maxAvaxPriceAge;</span>
  186 |     | <span class='neutral'>        maxPriceAges[_qi] = _maxQiPriceAge;</span>
  187 |     | <span class='neutral'></span>
  188 | *   | <span class='executed'>        (, int256 avaxPrice, , uint avaxPriceUpdatedAt, ) = avaxPriceFeed.latestRoundData();</span>
  189 | *   | <span class='executed'>        require(avaxPrice &gt; 0);</span>
  190 | *   | <span class='executed'>        require(block.timestamp - avaxPriceUpdatedAt &lt;= _maxAvaxPriceAge);</span>
  191 |     | <span class='neutral'></span>
  192 | *   | <span class='executed'>        (, int256 qiPrice, , uint qiPriceUpdatedAt, ) = qiPriceFeed.latestRoundData();</span>
  193 | *   | <span class='executed'>        require(qiPrice &gt; 0);</span>
  194 | *   | <span class='executed'>        require(block.timestamp - qiPriceUpdatedAt &lt;= _maxQiPriceAge);</span>
  195 |     | <span class='neutral'>    }</span>
  196 |     | <span class='neutral'></span>
  197 |     | <span class='neutral'>    /**</span>
  198 |     | <span class='neutral'>     * @notice Register a new node for validation and lock up QI and AVAX</span>
  199 |     | <span class='neutral'>     * @param  nodeId Node ID of the validator</span>
  200 |     | <span class='neutral'>     * @param  blsProofOfPossession BLS proof of possession (public key + signature)</span>
  201 |     | <span class='neutral'>     * @param  validationDuration Duration of the validation in seconds</span>
  202 |     | <span class='neutral'>     */</span>
  203 |     | <span class='neutral'>    function registerWithStake(</span>
  204 |     | <span class='neutral'>        string calldata nodeId,</span>
  205 |     | <span class='neutral'>        bytes calldata blsProofOfPossession,</span>
  206 |     | <span class='neutral'>        uint validationDuration</span>
  207 |     | <span class='neutral'>    ) external payable nonReentrant {</span>
  208 |     | <span class='neutral'>        require(</span>
  209 | *   | <span class='executed'>            msg.value &gt;= minimumAvaxDeposit &amp;&amp;</span>
  210 | *   | <span class='executed'>            msg.value &lt;= maximumAvaxDeposit &amp;&amp;</span>
  211 | *   | <span class='executed'>            msg.value % 1e9 == 0,</span>
  212 |     | <span class='neutral'>            &quot;Invalid value&quot;</span>
  213 |     | <span class='neutral'>        );</span>
  214 |     | <span class='neutral'></span>
  215 |     | <span class='neutral'>        // Verify that the sender can receive AVAX</span>
  216 | *   | <span class='executed'>        (bool success, ) = msg.sender.call(&quot;&quot;);</span>
  217 |     | <span class='neutral'>        require(success);</span>
  218 |     | <span class='neutral'></span>
  219 | *   | <span class='executed'>        (, int256 avaxPrice, , uint avaxPriceUpdatedAt, ) = priceFeeds[AVAX].latestRoundData();</span>
  220 | *   | <span class='executed'>        (, int256 qiPrice, , uint qiPriceUpdatedAt, ) = priceFeeds[address(qi)].latestRoundData();</span>
  221 |     | <span class='neutral'></span>
  222 | *   | <span class='executed'>        require(qiPrice &gt; 0 &amp;&amp; avaxPrice &gt; qiPrice); // @audit q what if the qi price surpass avax price ?</span>
  223 | *   | <span class='executed'>        require(block.timestamp - avaxPriceUpdatedAt &lt;= maxPriceAges[AVAX]);</span>
  224 | *   | <span class='executed'>        require(block.timestamp - qiPriceUpdatedAt &lt;= maxPriceAges[address(qi)]);</span>
  225 |     | <span class='neutral'></span>
  226 |     | <span class='neutral'>        // QI deposit amount is 10 % (thus, note the divider) of the AVAX value</span>
  227 |     | <span class='neutral'>        // that BENQI subsidises for the validator.</span>
  228 | *   | <span class='executed'>        uint qiAmount = uint(avaxPrice) * (2000e18 - msg.value) / uint(qiPrice) / 10;</span>
  229 |     | <span class='neutral'></span>
  230 | *   | <span class='executed'>        require(qiAmount &gt; 0);</span>
  231 |     | <span class='neutral'></span>
  232 | *   | <span class='executed'>        qi.safeTransferFrom(msg.sender, address(this), qiAmount);</span>
  233 |     | <span class='neutral'></span>
  234 |     | <span class='neutral'>        _registerWithChecks(</span>
  235 |     | <span class='neutral'>            msg.sender,</span>
  236 |     | <span class='neutral'>            nodeId,</span>
  237 |     | <span class='neutral'>            blsProofOfPossession,</span>
  238 |     | <span class='neutral'>            validationDuration,</span>
  239 |     | <span class='neutral'>            false,</span>
  240 |     | <span class='neutral'>            address(qi),</span>
  241 |     | <span class='neutral'>            qiAmount,</span>
  242 |     | <span class='neutral'>            false</span>
  243 |     | <span class='neutral'>        );</span>
  244 |     | <span class='neutral'>    }</span>
  245 |     | <span class='neutral'></span>
  246 |     | <span class='neutral'>    /**</span>
  247 |     | <span class='neutral'>     * @notice Register a node by paying a non-refundable fee in AVAX</span>
  248 |     | <span class='neutral'>     * @param  nodeId Node ID of the validator</span>
  249 |     | <span class='neutral'>     * @param  blsProofOfPossession BLS proof of possession (public key + signature)</span>
  250 |     | <span class='neutral'>     * @param  validationDuration Duration of the validation in seconds</span>
  251 |     | <span class='neutral'>     */</span>
  252 |     | <span class='neutral'>    function registerWithAvaxFee(</span>
  253 |     | <span class='neutral'>        string calldata nodeId,</span>
  254 |     | <span class='neutral'>        bytes calldata blsProofOfPossession,</span>
  255 |     | <span class='neutral'>        uint validationDuration</span>
  256 |     | <span class='neutral'>    ) external payable nonReentrant whenNotPaused {</span>
  257 | *   | <span class='executed'>        uint registrationFee = _getRegistrationFee(validationDuration);</span>
  258 | *   | <span class='executed'>        require(msg.value == registrationFee);</span>
  259 |     | <span class='neutral'></span>
  260 |     | <span class='neutral'>        // Verify that the sender can receive AVAX</span>
  261 | *   | <span class='executed'>        (bool success, ) = msg.sender.call(&quot;&quot;);</span>
  262 |     | <span class='neutral'>        require(success);</span>
  263 |     | <span class='neutral'></span>
  264 |     | <span class='neutral'>        // Fees cannot be withdrawn from the contract until the registration is released</span>
  265 | *   | <span class='executed'>        minimumContractBalance += registrationFee;</span>
  266 |     | <span class='neutral'></span>
  267 |     | <span class='neutral'>        _registerWithChecks(</span>
  268 |     | <span class='neutral'>            msg.sender,</span>
  269 |     | <span class='neutral'>            nodeId,</span>
  270 |     | <span class='neutral'>            blsProofOfPossession,</span>
  271 |     | <span class='neutral'>            validationDuration,</span>
  272 | *   | <span class='executed'>            true,</span>
  273 |     | <span class='neutral'>            address(0),</span>
  274 |     | <span class='neutral'>            0,</span>
  275 |     | <span class='neutral'>            false</span>
  276 |     | <span class='neutral'>        );</span>
  277 |     | <span class='neutral'>    }</span>
  278 |     | <span class='neutral'></span>
  279 |     | <span class='neutral'>    /**</span>
  280 |     | <span class='neutral'>     * @notice Register a node by paying a non-refundable fee in a supported ERC-20 token</span>
  281 |     | <span class='neutral'>     * @param  tokenAddress ERC-20 payment token address</span>
  282 |     | <span class='neutral'>     * @param  nodeId Node ID of the validator</span>
  283 |     | <span class='neutral'>     * @param  blsProofOfPossession BLS proof of possession (public key + signature)</span>
  284 |     | <span class='neutral'>     * @param  validationDuration Duration of the validation in seconds</span>
  285 |     | <span class='neutral'>     */</span>
  286 |     | <span class='neutral'>    function registerWithErc20Fee(</span>
  287 |     | <span class='neutral'>        address tokenAddress,</span>
  288 |     | <span class='neutral'>        string calldata nodeId,</span>
  289 |     | <span class='neutral'>        bytes calldata blsProofOfPossession,</span>
  290 |     | <span class='neutral'>        uint validationDuration</span>
  291 |     | <span class='neutral'>    ) external nonReentrant whenNotPaused {</span>
  292 |     | <span class='neutral'>        require(paymentTokens.contains(tokenAddress));</span>
  293 |     | <span class='neutral'></span>
  294 |     | <span class='neutral'>        IERC20MetadataUpgradeable token = IERC20MetadataUpgradeable(tokenAddress);</span>
  295 |     | <span class='neutral'></span>
  296 | *   | <span class='executed'>        (, int256 avaxPrice, , uint avaxPriceUpdatedAt, ) = priceFeeds[AVAX].latestRoundData();</span>
  297 | *   | <span class='executed'>        (, int256 tokenPrice, , uint tokenPriceUpdatedAt, ) = priceFeeds[tokenAddress].latestRoundData();</span>
  298 |     | <span class='neutral'></span>
  299 | *   | <span class='executed'>        require(avaxPrice &gt; 0 &amp;&amp; tokenPrice &gt; 0);</span>
  300 | *   | <span class='executed'>        require(block.timestamp - avaxPriceUpdatedAt &lt;= maxPriceAges[AVAX]);</span>
  301 | *   | <span class='executed'>        require(block.timestamp - tokenPriceUpdatedAt &lt;= maxPriceAges[tokenAddress]);</span>
  302 |     | <span class='neutral'></span>
  303 | *   | <span class='executed'>        uint registrationFee = _getRegistrationFee(validationDuration);</span>
  304 | *   | <span class='executed'>        uint tokenAmount = uint(avaxPrice) * registrationFee / uint(tokenPrice) / 10 ** (18 - token.decimals());</span>
  305 |     | <span class='neutral'></span>
  306 | *   | <span class='executed'>        if (tokenAddress == address(qi)) {</span>
  307 | *   | <span class='executed'>            tokenAmount = tokenAmount * qiPriceMultiplier / 10_000;</span>
  308 |     | <span class='neutral'>        }</span>
  309 |     | <span class='neutral'></span>
  310 | *   | <span class='executed'>        require(tokenAmount &gt; 0);</span>
  311 |     | <span class='neutral'></span>
  312 | *   | <span class='executed'>        token.safeTransferFrom(msg.sender, address(this), tokenAmount);</span>
  313 |     | <span class='neutral'></span>
  314 |     | <span class='neutral'>        _registerWithChecks(</span>
  315 |     | <span class='neutral'>            msg.sender,</span>
  316 |     | <span class='neutral'>            nodeId,</span>
  317 |     | <span class='neutral'>            blsProofOfPossession,</span>
  318 |     | <span class='neutral'>            validationDuration,</span>
  319 |     | <span class='neutral'>            true,</span>
  320 |     | <span class='neutral'>            tokenAddress,</span>
  321 |     | <span class='neutral'>            tokenAmount,</span>
  322 |     | <span class='neutral'>            false</span>
  323 |     | <span class='neutral'>        );</span>
  324 |     | <span class='neutral'>    }</span>
  325 |     | <span class='neutral'></span>
  326 |     | <span class='neutral'>    /**</span>
  327 |     | <span class='neutral'>     * @notice Register a new node for validation without locking up tokens</span>
  328 |     | <span class='neutral'>     * @param  nodeId Node ID of the validator</span>
  329 |     | <span class='neutral'>     * @param  blsProofOfPossession BLS proof of possession (public key + signature)</span>
  330 |     | <span class='neutral'>     * @param  validationDuration Duration of the validation in seconds</span>
  331 |     | <span class='neutral'>     */</span>
  332 |     | <span class='neutral'>    function registerWithoutCollateral(</span>
  333 |     | <span class='neutral'>        string calldata nodeId,</span>
  334 |     | <span class='neutral'>        bytes calldata blsProofOfPossession,</span>
  335 |     | <span class='neutral'>        uint validationDuration</span>
  336 |     | <span class='neutral'>    ) external {</span>
  337 | *   | <span class='executed'>        require(hasRole(ROLE_REGISTER_WITHOUT_COLLATERAL, msg.sender));</span>
  338 |     | <span class='neutral'>        require(</span>
  339 | *   | <span class='executed'>            validationDuration &gt;= VALIDATION_DURATION_TWO_WEEKS &amp;&amp;</span>
  340 | *   | <span class='executed'>            validationDuration &lt;= VALIDATION_DURATION_ONE_YEAR,</span>
  341 |     | <span class='neutral'>            &quot;Invalid validation duration&quot;</span>
  342 |     | <span class='neutral'>        );</span>
  343 |     | <span class='neutral'></span>
  344 |     | <span class='neutral'>        // Note that registering without collateral does not enforce the subsidisation cap</span>
  345 |     | <span class='neutral'>        // or the validation duration limits.</span>
  346 |     | <span class='neutral'>        _register(</span>
  347 |     | <span class='neutral'>            msg.sender,</span>
  348 |     | <span class='neutral'>            nodeId,</span>
  349 |     | <span class='neutral'>            blsProofOfPossession,</span>
  350 |     | <span class='neutral'>            validationDuration,</span>
  351 |     | <span class='neutral'>            false,</span>
  352 |     | <span class='neutral'>            address(0),</span>
  353 |     | <span class='neutral'>            0,</span>
  354 |     | <span class='neutral'>            false</span>
  355 |     | <span class='neutral'>        );</span>
  356 |     | <span class='neutral'>    }</span>
  357 |     | <span class='neutral'></span>
  358 |     | <span class='neutral'>    /**</span>
  359 |     | <span class='neutral'>     * @notice Register a new node with a prevalidated QI deposit amount</span>
  360 |     | <span class='neutral'>     * @param  beneficiary User on whose behalf the registration is made</span>
  361 |     | <span class='neutral'>     * @param  nodeId Node ID of the validator</span>
  362 |     | <span class='neutral'>     * @param  blsProofOfPossession BLS proof of possession (public key + signature)</span>
  363 |     | <span class='neutral'>     * @param  validationDuration Duration of the validation in seconds</span>
  364 |     | <span class='neutral'>     * @param  qiAmount The amount of QI that was staked</span>
  365 |     | <span class='neutral'>     */</span>
  366 |     | <span class='neutral'>    function registerWithPrevalidatedQiStake(</span>
  367 |     | <span class='neutral'>        address beneficiary,</span>
  368 |     | <span class='neutral'>        string calldata nodeId,</span>
  369 |     | <span class='neutral'>        bytes calldata blsProofOfPossession,</span>
  370 |     | <span class='neutral'>        uint validationDuration,</span>
  371 |     | <span class='neutral'>        uint qiAmount</span>
  372 |     | <span class='neutral'>    ) external {</span>
  373 |     | <span class='neutral'>        require(</span>
  374 | *   | <span class='executed'>            hasRole(ROLE_REGISTER_WITH_FLEXIBLE_PRICE_CHECK, msg.sender),</span>
  375 |     | <span class='neutral'>            &quot;ROLE_REGISTER_WITH_FLEXIBLE_PRICE_CHECK&quot;</span>
  376 |     | <span class='neutral'>        );</span>
  377 |     | <span class='neutral'></span>
  378 | *   | <span class='executed'>        (, int256 avaxPrice, , uint avaxPriceUpdatedAt, ) = priceFeeds[AVAX].latestRoundData();</span>
  379 | *   | <span class='executed'>        (, int256 qiPrice, , uint qiPriceUpdatedAt, ) = priceFeeds[address(qi)].latestRoundData();</span>
  380 |     | <span class='neutral'></span>
  381 | *   | <span class='executed'>        require(avaxPrice &gt; 0 &amp;&amp; qiPrice &gt; 0);</span>
  382 | *   | <span class='executed'>        require(block.timestamp - avaxPriceUpdatedAt &lt;= maxPriceAges[AVAX]);</span>
  383 | *   | <span class='executed'>        require(block.timestamp - qiPriceUpdatedAt &lt;= maxPriceAges[address(qi)]);</span>
  384 |     | <span class='neutral'></span>
  385 |     | <span class='neutral'>        // 200 AVAX + 1 AVAX fee</span>
  386 | *   | <span class='executed'>        uint expectedQiAmount = uint(avaxPrice) * 201e18 / uint(qiPrice);</span>
  387 |     | <span class='neutral'></span>
  388 | *   | <span class='executed'>        require(qiAmount &gt;= expectedQiAmount * 9 / 10);</span>
  389 |     | <span class='neutral'></span>
  390 | *   | <span class='executed'>        qi.safeTransferFrom(msg.sender, address(this), qiAmount);</span>
  391 |     | <span class='neutral'></span>
  392 |     | <span class='neutral'>        _registerWithChecks(</span>
  393 |     | <span class='neutral'>            beneficiary,</span>
  394 |     | <span class='neutral'>            nodeId,</span>
  395 |     | <span class='neutral'>            blsProofOfPossession,</span>
  396 |     | <span class='neutral'>            validationDuration,</span>
  397 |     | <span class='neutral'>            false,</span>
  398 |     | <span class='neutral'>            address(qi),</span>
  399 |     | <span class='neutral'>            qiAmount,</span>
  400 | *   | <span class='executed'>            true</span>
  401 |     | <span class='neutral'>        );</span>
  402 |     | <span class='neutral'>    }</span>
  403 |     | <span class='neutral'></span>
  404 |     | <span class='neutral'>    /**</span>
  405 |     | <span class='neutral'>     * @notice To be called after the validation period has expired and the staker</span>
  406 |     | <span class='neutral'>     *         wants to redeem their deposited tokens and potential rewards.</span>
  407 |     | <span class='neutral'>     * @param  nodeId Node ID of the validator</span>
  408 |     | <span class='neutral'>     */</span>
  409 |     | <span class='unexecuted'>    function redeemAfterExpiry(string calldata nodeId) external nonReentrant whenNotPaused {</span>
  410 |     | <span class='unexecuted'>        uint registrationIndex = registrationIndicesByNodeId[nodeId];</span>
  411 |     | <span class='unexecuted'>        require(registrationIndex != 0);</span>
  412 |     | <span class='neutral'></span>
  413 |     | <span class='unexecuted'>        Registration storage registration = registrations[registrationIndex];</span>
  414 |     | <span class='neutral'></span>
  415 |     | <span class='unexecuted'>        require(registration.registerer == msg.sender);</span>
  416 |     | <span class='unexecuted'>        require(registration.withdrawable);</span>
  417 |     | <span class='neutral'></span>
  418 |     | <span class='neutral'>        // If feePaid is true and the registration is withdrawable, it must have been released</span>
  419 |     | <span class='neutral'>        // with the failed flag set, meaning that the validator could not be started and the</span>
  420 |     | <span class='neutral'>        // fee should be refunded.</span>
  421 |     | <span class='unexecuted'>        if (registration.feePaid) {</span>
  422 |     | <span class='unexecuted'>            if (registration.tokenDeposits.avaxAmount &gt; 0) {</span>
  423 |     | <span class='neutral'>                uint avaxDepositAmount = registration.tokenDeposits.avaxAmount;</span>
  424 |     | <span class='neutral'></span>
  425 |     | <span class='unexecuted'>                minimumContractBalance -= avaxDepositAmount;</span>
  426 |     | <span class='neutral'></span>
  427 |     | <span class='unexecuted'>                _deleteRegistration(nodeId);</span>
  428 |     | <span class='neutral'></span>
  429 |     | <span class='unexecuted'>                (bool success, ) = payable(msg.sender).call{ value: avaxDepositAmount }(&quot;&quot;);</span>
  430 |     | <span class='neutral'>                require(success);</span>
  431 |     | <span class='neutral'></span>
  432 |     | <span class='unexecuted'>                emit Redeem(nodeId, avaxDepositAmount, address(0), 0);</span>
  433 |     | <span class='neutral'>            } else {</span>
  434 |     | <span class='unexecuted'>                IERC20Upgradeable token = IERC20Upgradeable(registration.tokenDeposits.token);</span>
  435 |     | <span class='unexecuted'>                uint tokenDepositAmount = registration.tokenDeposits.tokenAmount;</span>
  436 |     | <span class='neutral'></span>
  437 |     | <span class='unexecuted'>                _deleteRegistration(nodeId);</span>
  438 |     | <span class='neutral'></span>
  439 |     | <span class='unexecuted'>                token.safeTransfer(msg.sender, tokenDepositAmount);</span>
  440 |     | <span class='neutral'></span>
  441 |     | <span class='unexecuted'>                emit Redeem(nodeId, 0, address(token), tokenDepositAmount);</span>
  442 |     | <span class='neutral'>            }</span>
  443 |     | <span class='neutral'></span>
  444 |     | <span class='unexecuted'>            return;</span>
  445 |     | <span class='neutral'>        }</span>
  446 |     | <span class='neutral'></span>
  447 |     | <span class='neutral'>        // tokenAmount is always denominated in QI tokens for stake model registrations</span>
  448 |     | <span class='unexecuted'>        uint qiDepositAmount = registration.tokenDeposits.tokenAmount;</span>
  449 |     | <span class='neutral'>        uint avaxDepositAmount = registration.tokenDeposits.avaxAmount;</span>
  450 |     | <span class='neutral'></span>
  451 |     | <span class='unexecuted'>        uint avaxRedemptionAmount;</span>
  452 |     | <span class='neutral'>        uint qiRedemptionAmount;</span>
  453 |     | <span class='neutral'></span>
  454 |     | <span class='neutral'>        // If a validator was slashed, the slash amount was already transferred to the</span>
  455 |     | <span class='neutral'>        // slashed token recipient. The remaining QI tokens are held in this contract.</span>
  456 |     | <span class='unexecuted'>        if (registration.slashed) {</span>
  457 |     | <span class='unexecuted'>            avaxRedemptionAmount = avaxDepositAmount - avaxDepositAmount * registration.avaxSlashPercentage / 10_000;</span>
  458 |     | <span class='unexecuted'>            qiRedemptionAmount = qiDepositAmount - qiDepositAmount * registration.qiSlashPercentage / 10_000;</span>
  459 |     | <span class='neutral'></span>
  460 |     | <span class='unexecuted'>            minimumContractBalance -= avaxRedemptionAmount;</span>
  461 |     | <span class='neutral'>        } else {</span>
  462 |     | <span class='unexecuted'>            avaxRedemptionAmount = avaxDepositAmount + registration.rewardAmount;</span>
  463 |     | <span class='unexecuted'>            qiRedemptionAmount = qiDepositAmount;</span>
  464 |     | <span class='neutral'></span>
  465 |     | <span class='unexecuted'>            if (qiRewardEligibilityByNodeId[nodeId]) {</span>
  466 |     | <span class='unexecuted'>                qiRedemptionAmount += validatorRewarder.claimRewards(</span>
  467 |     | <span class='unexecuted'>                    registration.validationDuration,</span>
  468 |     | <span class='neutral'>                    qiDepositAmount</span>
  469 |     | <span class='neutral'>                );</span>
  470 |     | <span class='neutral'>            }</span>
  471 |     | <span class='neutral'></span>
  472 |     | <span class='unexecuted'>            minimumContractBalance -= avaxRedemptionAmount;</span>
  473 |     | <span class='neutral'>        }</span>
  474 |     | <span class='neutral'></span>
  475 |     | <span class='unexecuted'>        _deleteRegistration(nodeId);</span>
  476 |     | <span class='neutral'></span>
  477 |     | <span class='unexecuted'>        qi.safeTransfer(msg.sender, qiRedemptionAmount);</span>
  478 |     | <span class='neutral'></span>
  479 |     | <span class='unexecuted'>        if (avaxRedemptionAmount &gt; 0) {</span>
  480 |     | <span class='unexecuted'>            (bool success, ) = msg.sender.call{ value: avaxRedemptionAmount}(&quot;&quot;);</span>
  481 |     | <span class='neutral'>            require(success);</span>
  482 |     | <span class='neutral'>        }</span>
  483 |     | <span class='neutral'></span>
  484 |     | <span class='unexecuted'>        emit Redeem(nodeId, avaxRedemptionAmount, address(qi), qiRedemptionAmount);</span>
  485 |     | <span class='neutral'>    }</span>
  486 |     | <span class='neutral'></span>
  487 |     | <span class='neutral'>    /**</span>
  488 |     | <span class='neutral'>     * @notice Returns the number of registrations</span>
  489 |     | <span class='neutral'>     * @return Number of registrations</span>
  490 |     | <span class='neutral'>     */</span>
  491 |     | <span class='neutral'>    function getTotalRegistrations() external view returns (uint) {</span>
  492 |     | <span class='neutral'>        // Subtract 1 because the first registration is a dummy registration</span>
  493 |     | <span class='unexecuted'>        return registrations.length - 1;</span>
  494 |     | <span class='neutral'>    }</span>
  495 |     | <span class='neutral'></span>
  496 |     | <span class='neutral'>    /**</span>
  497 |     | <span class='neutral'>     * @notice Returns the number of available ERC-20 payment tokens for the fee model</span>
  498 |     | <span class='neutral'>     * @return Number of payment methods</span>
  499 |     | <span class='neutral'>     */</span>
  500 |     | <span class='neutral'>    function getTotalErc20PaymentMethods() external view returns (uint) {</span>
  501 |     | <span class='unexecuted'>        return paymentTokens.length();</span>
  502 |     | <span class='neutral'>    }</span>
  503 |     | <span class='neutral'></span>
  504 |     | <span class='neutral'>    /**</span>
  505 |     | <span class='neutral'>     * @notice Get a list of all supported ERC-20 payment token for the fee model</span>
  506 |     | <span class='neutral'>     * @return A list of supported payment token addresses</span>
  507 |     | <span class='neutral'>     */</span>
  508 |     | <span class='neutral'>    function getErc20PaymentMethods() external view returns (address[] memory) {</span>
  509 |     | <span class='unexecuted'>        return paymentTokens.values();</span>
  510 |     | <span class='neutral'>    }</span>
  511 |     | <span class='neutral'></span>
  512 |     | <span class='neutral'>    /**</span>
  513 |     | <span class='neutral'>     * @notice Returns an array of registrations made by the given account</span>
  514 |     | <span class='neutral'>     * @param  account Account to query</span>
  515 |     | <span class='neutral'>     * @param  from Index of the first registration to return (inclusive)</span>
  516 |     | <span class='neutral'>     * @param  to Index of the last registration to return (exclusive)</span>
  517 |     | <span class='neutral'>     * @return Array of registrations</span>
  518 |     | <span class='neutral'>     */</span>
  519 |     | <span class='neutral'>    function getRegistrationsByAccount(</span>
  520 |     | <span class='neutral'>        address account,</span>
  521 |     | <span class='neutral'>        uint from,</span>
  522 |     | <span class='neutral'>        uint to</span>
  523 |     | <span class='neutral'>    ) external view returns (Registration[] memory) {</span>
  524 |     | <span class='unexecuted'>        Registration[] memory accountRegistrations = new Registration[](to - from);</span>
  525 |     | <span class='neutral'></span>
  526 |     | <span class='unexecuted'>        for (uint i = from; i &lt; to; ++i) {</span>
  527 | *   | <span class='executed'>            accountRegistrations[i - from] = registrations[registrationIndicesByNodeId[registeredNodeIdsByAccount[account][i]]];</span>
  528 |     | <span class='neutral'>        }</span>
  529 |     | <span class='neutral'></span>
  530 |     | <span class='neutral'>        return accountRegistrations;</span>
  531 |     | <span class='neutral'>    }</span>
  532 |     | <span class='neutral'></span>
  533 |     | <span class='neutral'>    /**</span>
  534 |     | <span class='neutral'>     * @notice Returns the number of registrations made by the given account</span>
  535 |     | <span class='neutral'>     * @param  account Account to query</span>
  536 |     | <span class='neutral'>     * @return Number of registrations</span>
  537 |     | <span class='neutral'>     */</span>
  538 |     | <span class='neutral'>    function getAccountRegistrationCount(address account) external view returns (uint) {</span>
  539 |     | <span class='unexecuted'>        return registeredNodeIdsByAccount[account].length;</span>
  540 |     | <span class='neutral'>    }</span>
  541 |     | <span class='neutral'></span>
  542 |     | <span class='neutral'>    /**</span>
  543 |     | <span class='neutral'>     * @notice Get the registration fee in AVAX for a given validation duration</span>
  544 |     | <span class='neutral'>     * @param  validationDuration Validation duration in seconds</span>
  545 |     | <span class='neutral'>     * @return Registration fee in AVAX</span>
  546 |     | <span class='neutral'>     */</span>
  547 |     | <span class='neutral'>    function getRegistrationFee(uint validationDuration) external view returns (uint) {</span>
  548 | *   | <span class='executed'>        return _getRegistrationFee(validationDuration);</span>
  549 |     | <span class='neutral'>    }</span>
  550 |     | <span class='neutral'></span>
  551 |     | <span class='neutral'>    /**</span>
  552 |     | <span class='neutral'>     * @notice Called to withdraw AVAX from the contract to start validation</span>
  553 |     | <span class='neutral'>     * @param  amount Amount of AVAX to be withdrawn</span>
  554 |     | <span class='neutral'>     */</span>
  555 |     | <span class='neutral'>    function withdraw(uint amount) external whenNotPaused {</span>
  556 | *   | <span class='executed'>        require(hasRole(ROLE_WITHDRAW, msg.sender));</span>
  557 |     | <span class='neutral'></span>
  558 | *   | <span class='executed'>        (bool success, ) = msg.sender.call{ value: amount }(&quot;&quot;);</span>
  559 |     | <span class='neutral'>        require(success);</span>
  560 |     | <span class='neutral'></span>
  561 |     | <span class='neutral'>        require(</span>
  562 | *   | <span class='executed'>            address(this).balance &gt;= minimumContractBalance,</span>
  563 |     | <span class='neutral'>            &quot;Withdrawal amount too big&quot;</span>
  564 |     | <span class='neutral'>        );</span>
  565 |     | <span class='neutral'></span>
  566 | *   | <span class='executed'>        emit Withdraw(amount);</span>
  567 |     | <span class='neutral'>    }</span>
  568 |     | <span class='neutral'></span>
  569 |     | <span class='neutral'>    /**</span>
  570 |     | <span class='neutral'>     * @notice Called after the validation period has expired and the tokens become</span>
  571 |     | <span class='neutral'>     *         redeemable by the original staker.</span>
  572 |     | <span class='neutral'>     * @param  nodeId Node ID of the expired validator</span>
  573 |     | <span class='neutral'>     * @param  failed True if the validator could not be started, false otherwise</span>
  574 |     | <span class='neutral'>     */</span>
  575 | *   | <span class='executed'>    function releaseLockedTokens(</span>
  576 |     | <span class='neutral'>        string calldata nodeId,</span>
  577 |     | <span class='neutral'>        bool failed</span>
  578 |     | <span class='neutral'>    ) external payable whenNotPaused nonReentrant {</span>
  579 | *   | <span class='executed'>        require(hasRole(ROLE_RELEASE_LOCKED_TOKENS, msg.sender),&quot;role error &quot;);</span>
  580 |     | <span class='neutral'></span>
  581 | *   | <span class='executed'>        uint registrationIndex = registrationIndicesByNodeId[nodeId];</span>
  582 | *   | <span class='executed'>        require(registrationIndex != 0,&quot;registrationIndex != 0&quot;);</span>
  583 |     | <span class='neutral'></span>
  584 | *   | <span class='executed'>        Registration storage registration = registrations[registrationIndex];</span>
  585 |     | <span class='neutral'></span>
  586 | *   | <span class='executed'>        require(!registration.withdrawable,&quot;!registration.withdrawable&quot;);</span>
  587 |     | <span class='neutral'></span>
  588 | *   | <span class='executed'>        emit RegistrationExpired(nodeId);</span>
  589 |     | <span class='neutral'></span>
  590 |     | <span class='neutral'>        // If the failed flag is set, this means that a validator could not be started for the</span>
  591 |     | <span class='neutral'>        // given node ID and the principal stake or fee should be returned to the user in whole.</span>
  592 | *   | <span class='executed'>        if (failed) {</span>
  593 | *   | <span class='executed'>            if (registration.feePaid) {</span>
  594 | *   | <span class='executed'>                require(msg.value == 0);</span>
  595 |     | <span class='neutral'></span>
  596 | *   | <span class='executed'>                totalSubsidisedAmount -= 2000e18;</span>
  597 |     | <span class='neutral'>            } else {</span>
  598 |     | <span class='neutral'>                require(</span>
  599 | *   | <span class='executed'>                    msg.value == registration.tokenDeposits.avaxAmount,</span>
  600 |     | <span class='neutral'>                    &quot;Message value must match the AVAX deposit amount&quot;</span>
  601 |     | <span class='neutral'>                );</span>
  602 |     | <span class='neutral'></span>
  603 |     | <span class='neutral'>                // Non-tokenised registrations do not count towards the subsidisation cap</span>
  604 |     | <span class='neutral'>                // nor can have a non-zero AVAX deposit and should be deleted immediately.</span>
  605 | *   | <span class='executed'>                if (registration.tokenDeposits.tokenAmount == 0) {  // @audit if msg.value is greater than 0 and tokenAmount is zero that the withdrawal is not toggled</span>
  606 | *   | <span class='executed'>                    _deleteRegistration(nodeId);                  // @audit  registration.tokenDeposits.tokenAmount == 0  this should be registration.tokenDeposits.avaxAmount == 0 </span>
  607 |     | <span class='neutral'></span>
  608 |     | <span class='neutral'>                    return;</span>
  609 |     | <span class='neutral'>                } else {</span>
  610 |     | <span class='unexecuted'>                    minimumContractBalance += msg.value;</span>
  611 |     | <span class='unexecuted'>                    totalSubsidisedAmount -= 2000e18 - msg.value;</span>
  612 |     | <span class='unexecuted'>                    qiRewardEligibilityByNodeId[nodeId] = false;</span>
  613 |     | <span class='neutral'>                }</span>
  614 |     | <span class='neutral'>            }</span>
  615 |     | <span class='neutral'></span>
  616 |     | <span class='neutral'>            registration.withdrawable = true;</span>
  617 |     | <span class='neutral'></span>
  618 | *   | <span class='executed'>            return;</span>
  619 |     | <span class='neutral'>        }</span>
  620 |     | <span class='neutral'></span>
  621 |     | <span class='neutral'>        // If a fee was paid, the registration can be deleted immediately because</span>
  622 |     | <span class='neutral'>        // there is nothing for the user to claim afterwards.</span>
  623 | *   | <span class='executed'>        if (registration.feePaid) {</span>
  624 | *   | <span class='executed'>            require(msg.value == 0);</span>
  625 |     | <span class='neutral'></span>
  626 | *   | <span class='executed'>            totalSubsidisedAmount -= 2000e18;</span>
  627 |     | <span class='neutral'></span>
  628 | *   | <span class='executed'>            if (registration.tokenDeposits.avaxAmount &gt; 0) {</span>
  629 |     | <span class='neutral'>                uint avaxDepositAmount = registration.tokenDeposits.avaxAmount;</span>
  630 |     | <span class='neutral'></span>
  631 | *   | <span class='executed'>                minimumContractBalance -= avaxDepositAmount;</span>
  632 |     | <span class='neutral'></span>
  633 | *   | <span class='executed'>                _deleteRegistration(nodeId);</span>
  634 |     | <span class='neutral'></span>
  635 | *   | <span class='executed'>                (bool success, ) = FEE_RECIPIENT.call{ value: avaxDepositAmount }(&quot;&quot;);</span>
  636 |     | <span class='neutral'>                require(success);</span>
  637 |     | <span class='neutral'>            } else {</span>
  638 | *   | <span class='executed'>                IERC20Upgradeable token = IERC20Upgradeable(registration.tokenDeposits.token);</span>
  639 | *   | <span class='executed'>                uint tokenDepositAmount = registration.tokenDeposits.tokenAmount;</span>
  640 |     | <span class='neutral'></span>
  641 | *   | <span class='executed'>                _deleteRegistration(nodeId);</span>
  642 |     | <span class='neutral'></span>
  643 | *   | <span class='executed'>                token.safeTransfer(FEE_RECIPIENT, tokenDepositAmount);</span>
  644 |     | <span class='neutral'>            }</span>
  645 |     | <span class='neutral'></span>
  646 | *   | <span class='executed'>            return;</span>
  647 |     | <span class='neutral'>        }</span>
  648 |     | <span class='neutral'></span>
  649 |     | <span class='neutral'>        // If a token deposit was not made, this is a registration by a privileged</span>
  650 |     | <span class='neutral'>        // account. These registrations cannot be rewarded nor can they be slashed.</span>
  651 |     | <span class='neutral'>        // Non-tokenised registrations do not count towards the subsidisation cap.</span>
  652 | *   | <span class='executed'>        if (registration.tokenDeposits.avaxAmount == 0 &amp;&amp; registration.tokenDeposits.tokenAmount == 0) {</span>
  653 | *   | <span class='executed'>            require(msg.value == 0);</span>
  654 |     | <span class='neutral'></span>
  655 |     | <span class='unexecuted'>            _deleteRegistration(nodeId);</span>
  656 |     | <span class='neutral'></span>
  657 |     | <span class='neutral'>            return;</span>
  658 |     | <span class='neutral'>        }</span>
  659 |     | <span class='neutral'></span>
  660 |     | <span class='unexecuted'>        registration.withdrawable = true;</span>
  661 |     | <span class='neutral'></span>
  662 | *   | <span class='executed'>        totalSubsidisedAmount -= 2000e18 - registration.tokenDeposits.avaxAmount;</span>
  663 |     | <span class='neutral'></span>
  664 | *   | <span class='executed'>        if (qiRewardEligibilityByNodeId[nodeId]) {</span>
  665 | *   | <span class='executed'>            require(msg.value == 0);</span>
  666 |     | <span class='neutral'></span>
  667 | *   | <span class='executed'>            uint fee = registration.tokenDeposits.tokenAmount / 201;</span>
  668 | *   | <span class='executed'>            registration.tokenDeposits.tokenAmount -= fee;</span>
  669 |     | <span class='neutral'></span>
  670 | *   | <span class='executed'>            qi.safeTransfer(FEE_RECIPIENT, fee);</span>
  671 |     | <span class='neutral'></span>
  672 | *   | <span class='executed'>            emit ValidatorRewarded(nodeId, 0);</span>
  673 |     | <span class='unexecuted'>        } else if (msg.value &gt; registration.tokenDeposits.avaxAmount) {</span>
  674 |     | <span class='unexecuted'>            uint rewards = msg.value - registration.tokenDeposits.avaxAmount;</span>
  675 |     | <span class='neutral'></span>
  676 |     | <span class='unexecuted'>            registration.rewardAmount = rewards;</span>
  677 |     | <span class='unexecuted'>            minimumContractBalance += msg.value;</span>
  678 |     | <span class='neutral'></span>
  679 |     | <span class='unexecuted'>            emit ValidatorRewarded(nodeId, rewards);</span>
  680 |     | <span class='neutral'>        } else {</span>
  681 |     | <span class='unexecuted'>            require(msg.value == registration.tokenDeposits.avaxAmount);</span>
  682 |     | <span class='neutral'></span>
  683 |     | <span class='neutral'>            registration.slashed = true;</span>
  684 |     | <span class='neutral'></span>
  685 |     | <span class='neutral'>            uint qiSlashAmount;</span>
  686 |     | <span class='unexecuted'>            uint avaxSlashAmount;</span>
  687 |     | <span class='neutral'></span>
  688 |     | <span class='unexecuted'>            if (registration.qiSlashPercentage &gt; 0) {</span>
  689 |     | <span class='neutral'>                // tokenDeposits.tokenAmount is always denominated in QI for stake model registrations</span>
  690 |     | <span class='unexecuted'>                qiSlashAmount = registration.tokenDeposits.tokenAmount * registration.qiSlashPercentage / 10_000;</span>
  691 |     | <span class='neutral'></span>
  692 |     | <span class='neutral'>                qi.safeTransfer(SLASHED_TOKEN_RECIPIENT, qiSlashAmount);</span>
  693 |     | <span class='neutral'>            }</span>
  694 |     | <span class='neutral'></span>
  695 |     | <span class='unexecuted'>            if (registration.avaxSlashPercentage &gt; 0) {</span>
  696 |     | <span class='unexecuted'>                avaxSlashAmount = registration.tokenDeposits.avaxAmount * registration.avaxSlashPercentage / 10_000;</span>
  697 |     | <span class='neutral'></span>
  698 |     | <span class='unexecuted'>                minimumContractBalance += msg.value - avaxSlashAmount;</span>
  699 |     | <span class='neutral'></span>
  700 |     | <span class='unexecuted'>                (bool success, ) = SLASHED_TOKEN_RECIPIENT.call{ value: avaxSlashAmount }(&quot;&quot;);</span>
  701 |     | <span class='neutral'>                require(success);</span>
  702 |     | <span class='neutral'>            } else {</span>
  703 |     | <span class='unexecuted'>                minimumContractBalance += msg.value;</span>
  704 |     | <span class='neutral'>            }</span>
  705 |     | <span class='neutral'></span>
  706 |     | <span class='unexecuted'>            emit ValidatorSlashed(nodeId, qiSlashAmount, avaxSlashAmount);</span>
  707 |     | <span class='neutral'>        }</span>
  708 |     | <span class='neutral'>    }</span>
  709 |     | <span class='neutral'></span>
  710 |     | <span class='neutral'>    /**</span>
  711 |     | <span class='neutral'>     * @notice Pause new registrations, withdrawals, releases, and redemptions.</span>
  712 |     | <span class='neutral'>     */</span>
  713 |     | <span class='neutral'>    function pause() external {</span>
  714 |     | <span class='unexecuted'>        require(hasRole(ROLE_PAUSE, msg.sender));</span>
  715 |     | <span class='neutral'></span>
  716 |     | <span class='neutral'>        _pause();</span>
  717 |     | <span class='neutral'>    }</span>
  718 |     | <span class='neutral'></span>
  719 |     | <span class='neutral'>    /**</span>
  720 |     | <span class='neutral'>     * @notice Resume new registrations, withdrawals, releses, and redemptions.</span>
  721 |     | <span class='neutral'>     */</span>
  722 |     | <span class='neutral'>    function unpause() external {</span>
  723 |     | <span class='unexecuted'>        require(hasRole(ROLE_UNPAUSE, msg.sender));</span>
  724 |     | <span class='neutral'></span>
  725 |     | <span class='neutral'>        _unpause();</span>
  726 |     | <span class='neutral'>    }</span>
  727 |     | <span class='neutral'></span>
  728 |     | <span class='neutral'>    /**</span>
  729 |     | <span class='neutral'>     * @notice Change the QI slash percentage</span>
  730 |     | <span class='neutral'>     * @param  newPercentage The new percentage in bps</span>
  731 |     | <span class='neutral'>     */</span>
  732 |     | <span class='neutral'>    function setQiSlashPercentage(uint newPercentage) external {</span>
  733 |     | <span class='unexecuted'>        require(hasRole(DEFAULT_ADMIN_ROLE, msg.sender));</span>
  734 |     | <span class='unexecuted'>        require(newPercentage &lt;= 10_000);</span>
  735 |     | <span class='neutral'></span>
  736 |     | <span class='unexecuted'>        uint oldPercentage = qiSlashPercentage;</span>
  737 |     | <span class='neutral'>        qiSlashPercentage = newPercentage;</span>
  738 |     | <span class='neutral'></span>
  739 |     | <span class='unexecuted'>        emit QiSlashPercentageChanged(oldPercentage, newPercentage);</span>
  740 |     | <span class='neutral'>    }</span>
  741 |     | <span class='neutral'></span>
  742 |     | <span class='neutral'>    /**</span>
  743 |     | <span class='neutral'>     * @notice Change the AVAX slash percentage</span>
  744 |     | <span class='neutral'>     * @param  newPercentage The new percentage in bps</span>
  745 |     | <span class='neutral'>     */</span>
  746 |     | <span class='neutral'>    function setAvaxSlashPercentage(uint newPercentage) external {</span>
  747 |     | <span class='unexecuted'>        require(hasRole(DEFAULT_ADMIN_ROLE, msg.sender));</span>
  748 |     | <span class='unexecuted'>        require(newPercentage &lt;= 10_000);</span>
  749 |     | <span class='neutral'></span>
  750 |     | <span class='unexecuted'>        uint oldPercentage = avaxSlashPercentage;</span>
  751 |     | <span class='neutral'>        avaxSlashPercentage = newPercentage;</span>
  752 |     | <span class='neutral'></span>
  753 |     | <span class='unexecuted'>        emit AvaxSlashPercentageChanged(oldPercentage, newPercentage);</span>
  754 |     | <span class='neutral'>    }</span>
  755 |     | <span class='neutral'></span>
  756 |     | <span class='neutral'>    /**</span>
  757 |     | <span class='neutral'>     * @notice Change the protocol maximum AVAX subsidisation amount</span>
  758 |     | <span class='neutral'>     * @param  newMaximumSubsidisationAmount New maximum subsidisation amount in AVAX (18 decimals)</span>
  759 |     | <span class='neutral'>     */</span>
  760 |     | <span class='neutral'>    function setMaximumSubsidisationAmount(uint newMaximumSubsidisationAmount) external {</span>
  761 |     | <span class='unexecuted'>        require(hasRole(DEFAULT_ADMIN_ROLE, msg.sender));</span>
  762 |     | <span class='neutral'></span>
  763 |     | <span class='unexecuted'>        uint oldMaximumSubsidisationAmount = maximumSubsidisationAmount;</span>
  764 |     | <span class='neutral'>        maximumSubsidisationAmount = newMaximumSubsidisationAmount;</span>
  765 |     | <span class='neutral'></span>
  766 |     | <span class='unexecuted'>        emit MaximumSubsidisationAmountChanged(</span>
  767 |     | <span class='neutral'>            oldMaximumSubsidisationAmount,</span>
  768 |     | <span class='neutral'>            newMaximumSubsidisationAmount</span>
  769 |     | <span class='neutral'>        );</span>
  770 |     | <span class='neutral'>    }</span>
  771 |     | <span class='neutral'></span>
  772 |     | <span class='neutral'>    /**</span>
  773 |     | <span class='neutral'>     * @notice Update the QI price multiplier used for fee payments in QI</span>
  774 |     | <span class='neutral'>     * @param newQiPriceMultiplier New price multiplier in bps</span>
  775 |     | <span class='neutral'>     */</span>
  776 |     | <span class='neutral'>    function setQiPriceMultiplier(uint newQiPriceMultiplier) external {</span>
  777 |     | <span class='unexecuted'>        require(hasRole(DEFAULT_ADMIN_ROLE, msg.sender));</span>
  778 |     | <span class='unexecuted'>        require(newQiPriceMultiplier &lt;= 10_000);</span>
  779 |     | <span class='neutral'></span>
  780 |     | <span class='unexecuted'>        uint oldQiPriceMultiplier = qiPriceMultiplier;</span>
  781 |     | <span class='neutral'>        qiPriceMultiplier = newQiPriceMultiplier;</span>
  782 |     | <span class='neutral'></span>
  783 |     | <span class='unexecuted'>        emit QiPriceMultiplierUpdated(oldQiPriceMultiplier, newQiPriceMultiplier);</span>
  784 |     | <span class='neutral'>    }</span>
  785 |     | <span class='neutral'></span>
  786 |     | <span class='neutral'>    /**</span>
  787 |     | <span class='neutral'>     * @notice Add a new fee payment token option</span>
  788 |     | <span class='neutral'>     * @param  token ERC-20 token address</span>
  789 |     | <span class='neutral'>     * @param  priceFeedAddress Chainlink price feed address for the token</span>
  790 |     | <span class='neutral'>     * @param  maxPriceAge Maximum price feed response age</span>
  791 |     | <span class='neutral'>     */</span>
  792 |     | <span class='neutral'>    function addPaymentToken(</span>
  793 |     | <span class='neutral'>        address token,</span>
  794 |     | <span class='neutral'>        address priceFeedAddress,</span>
  795 |     | <span class='neutral'>        uint maxPriceAge</span>
  796 |     | <span class='neutral'>    ) external {</span>
  797 | *   | <span class='executed'>        require(hasRole(DEFAULT_ADMIN_ROLE, msg.sender));</span>
  798 | *   | <span class='executed'>        require(token != address(0));</span>
  799 | *   | <span class='executed'>        require(!paymentTokens.contains(token));</span>
  800 |     | <span class='neutral'></span>
  801 |     | <span class='neutral'>        IPriceFeed priceFeed = IPriceFeed(priceFeedAddress);</span>
  802 |     | <span class='neutral'></span>
  803 |     | <span class='neutral'>        paymentTokens.add(token);</span>
  804 | *   | <span class='executed'>        priceFeeds[token] = priceFeed;</span>
  805 | *   | <span class='executed'>        maxPriceAges[token] = maxPriceAge;</span>
  806 |     | <span class='neutral'></span>
  807 | *   | <span class='executed'>        (, int256 price, , uint updatedAt, ) = priceFeed.latestRoundData();</span>
  808 | *   | <span class='executed'>        require(price &gt; 0);</span>
  809 | *   | <span class='executed'>        require(block.timestamp - updatedAt &lt;= maxPriceAge);</span>
  810 |     | <span class='neutral'></span>
  811 | *   | <span class='executed'>        emit PaymentTokenAdded(token);</span>
  812 |     | <span class='neutral'>    }</span>
  813 |     | <span class='neutral'></span>
  814 |     | <span class='neutral'>    /**</span>
  815 |     | <span class='neutral'>     * @notice Remove an existing fee payment token option</span>
  816 |     | <span class='neutral'>     * @param  token Token to remove</span>
  817 |     | <span class='neutral'>     */</span>
  818 |     | <span class='neutral'>    function removePaymentToken(address token) external {</span>
  819 |     | <span class='unexecuted'>        require(hasRole(DEFAULT_ADMIN_ROLE, msg.sender));</span>
  820 |     | <span class='unexecuted'>        require(paymentTokens.contains(token));</span>
  821 |     | <span class='neutral'></span>
  822 |     | <span class='neutral'>        // AVAX and QI price feed configuration must not be deleted</span>
  823 |     | <span class='unexecuted'>        if (token != AVAX &amp;&amp; token != address(qi)) {</span>
  824 |     | <span class='unexecuted'>            delete priceFeeds[token];</span>
  825 |     | <span class='unexecuted'>            delete maxPriceAges[token];</span>
  826 |     | <span class='neutral'>        }</span>
  827 |     | <span class='neutral'></span>
  828 |     | <span class='neutral'>        paymentTokens.remove(token);</span>
  829 |     | <span class='neutral'></span>
  830 |     | <span class='unexecuted'>        emit PaymentTokenRemoved(token);</span>
  831 |     | <span class='neutral'>    }</span>
  832 |     | <span class='neutral'></span>
  833 |     | <span class='neutral'>    /**</span>
  834 |     | <span class='neutral'>     * @notice Update the price feed configuration for a pre-existing payment token</span>
  835 |     | <span class='neutral'>     * @param  token ERC-20 token address</span>
  836 |     | <span class='neutral'>     * @param  priceFeedAddress Chainlink price feed address for the token</span>
  837 |     | <span class='neutral'>     * @param  maxPriceAge Maximum price feed response age</span>
  838 |     | <span class='neutral'>     */</span>
  839 |     | <span class='neutral'>    function configurePriceFeed(</span>
  840 |     | <span class='neutral'>        address token,</span>
  841 |     | <span class='neutral'>        address priceFeedAddress,</span>
  842 |     | <span class='neutral'>        uint maxPriceAge</span>
  843 |     | <span class='neutral'>    ) external {</span>
  844 |     | <span class='unexecuted'>        require(hasRole(DEFAULT_ADMIN_ROLE, msg.sender));</span>
  845 |     | <span class='neutral'></span>
  846 |     | <span class='unexecuted'>        address oldPriceFeed = address(priceFeeds[token]);</span>
  847 |     | <span class='unexecuted'>        uint oldPriceMaxAge = maxPriceAges[token];</span>
  848 |     | <span class='neutral'></span>
  849 |     | <span class='unexecuted'>        require(oldPriceFeed != address(0));</span>
  850 |     | <span class='neutral'></span>
  851 |     | <span class='neutral'>        IPriceFeed priceFeed = IPriceFeed(priceFeedAddress);</span>
  852 |     | <span class='neutral'></span>
  853 |     | <span class='neutral'>        priceFeeds[token] = priceFeed;</span>
  854 |     | <span class='neutral'>        maxPriceAges[token] = maxPriceAge;</span>
  855 |     | <span class='neutral'></span>
  856 | *   | <span class='executed'>        (, int256 price, , uint updatedAt, ) = priceFeed.latestRoundData();</span>
  857 |     | <span class='unexecuted'>        require(price &gt; 0);</span>
  858 |     | <span class='unexecuted'>        require(block.timestamp - updatedAt &lt;= maxPriceAge);</span>
  859 |     | <span class='neutral'></span>
  860 |     | <span class='unexecuted'>        emit PriceFeedChanged(token, oldPriceFeed, priceFeedAddress, oldPriceMaxAge, maxPriceAge);</span>
  861 |     | <span class='neutral'>    }</span>
  862 |     | <span class='neutral'></span>
  863 |     | <span class='neutral'>    /**</span>
  864 |     | <span class='neutral'>     * @notice Change the required AVAX deposit amount for a registration</span>
  865 |     | <span class='neutral'>     * @param  newMinimumAvaxDeposit New minimum AVAX deposit amount (18 decimals)</span>
  866 |     | <span class='neutral'>     * @param  newMaximumAvaxDeposit New maximum AVAX deposit amount (18 decimals)</span>
  867 |     | <span class='neutral'>     */</span>
  868 |     | <span class='neutral'>    function setAvaxDepositRange(uint newMinimumAvaxDeposit, uint newMaximumAvaxDeposit) external {</span>
  869 |     | <span class='unexecuted'>        require(hasRole(DEFAULT_ADMIN_ROLE, msg.sender));</span>
  870 |     | <span class='unexecuted'>        require(newMinimumAvaxDeposit &lt;= newMaximumAvaxDeposit);</span>
  871 |     | <span class='neutral'></span>
  872 |     | <span class='unexecuted'>        uint oldMinimumAvaxDeposit = minimumAvaxDeposit;</span>
  873 |     | <span class='unexecuted'>        uint oldMaximumAvaxDeposit = maximumAvaxDeposit;</span>
  874 |     | <span class='neutral'></span>
  875 |     | <span class='neutral'>        minimumAvaxDeposit = newMinimumAvaxDeposit;</span>
  876 |     | <span class='neutral'>        maximumAvaxDeposit = newMaximumAvaxDeposit;</span>
  877 |     | <span class='neutral'></span>
  878 |     | <span class='unexecuted'>        emit AvaxDepositRangeUpdated(</span>
  879 |     | <span class='neutral'>            oldMinimumAvaxDeposit,</span>
  880 |     | <span class='neutral'>            minimumAvaxDeposit,</span>
  881 |     | <span class='neutral'>            oldMaximumAvaxDeposit,</span>
  882 |     | <span class='neutral'>            maximumAvaxDeposit</span>
  883 |     | <span class='neutral'>        );</span>
  884 |     | <span class='neutral'>    }</span>
  885 |     | <span class='neutral'></span>
  886 |     | <span class='neutral'>    /**</span>
  887 |     | <span class='neutral'>     * @notice Set the ValidatorRewarder contract address</span>
  888 |     | <span class='neutral'>     * @param  newValidatorRewarder ValidatorRewarder contract address</span>
  889 |     | <span class='neutral'>     */</span>
  890 |     | <span class='neutral'>    function setValidatorRewarder(address newValidatorRewarder) external {</span>
  891 |     | <span class='unexecuted'>        require(hasRole(DEFAULT_ADMIN_ROLE, msg.sender));</span>
  892 |     | <span class='neutral'></span>
  893 |     | <span class='unexecuted'>        validatorRewarder = ValidatorRewarder(newValidatorRewarder);</span>
  894 |     | <span class='neutral'>    }</span>
  895 |     | <span class='neutral'></span>
  896 |     | <span class='neutral'>    /**</span>
  897 |     | <span class='neutral'>     * @notice Store the registration using _register after validating the subsidisation</span>
  898 |     | <span class='neutral'>     *         cap and validation duration.</span>
  899 |     | <span class='neutral'>     * @param  beneficiary The beneficiary of the registration</span>
  900 |     | <span class='neutral'>     * @param  nodeId ID of the node to register</span>
  901 |     | <span class='neutral'>     * @param  blsProofOfPossession BLS proof of possession (public key + signature)</span>
  902 |     | <span class='neutral'>     * @param  validationDuration Duration of the validation period</span>
  903 |     | <span class='neutral'>     * @param  feePaid Whether or not the fee was paid</span>
  904 |     | <span class='neutral'>     * @param  token ERC-20 payment token address</span>
  905 |     | <span class='neutral'>     * @param  tokenAmount Amount of ERC-20 tokens deposited</span>
  906 |     | <span class='neutral'>     * @param  isEligibleForQiRewards True if the node is eligible for QI rewards at the end of the validation</span>
  907 |     | <span class='neutral'>     */</span>
  908 |     | <span class='neutral'>    function _registerWithChecks(</span>
  909 |     | <span class='neutral'>        address beneficiary,</span>
  910 |     | <span class='neutral'>        string calldata nodeId,</span>
  911 |     | <span class='neutral'>        bytes calldata blsProofOfPossession,</span>
  912 |     | <span class='neutral'>        uint validationDuration,</span>
  913 |     | <span class='neutral'>        bool feePaid,</span>
  914 |     | <span class='neutral'>        address token,</span>
  915 |     | <span class='neutral'>        uint tokenAmount,</span>
  916 |     | <span class='neutral'>        bool isEligibleForQiRewards</span>
  917 |     | <span class='neutral'>    ) internal {</span>
  918 |     | <span class='neutral'>        uint subsidisationAmount;</span>
  919 |     | <span class='neutral'>        if (feePaid) {</span>
  920 | *   | <span class='executed'>            subsidisationAmount = 2000e18;</span>
  921 |     | <span class='neutral'>        } else {</span>
  922 | *   | <span class='executed'>            subsidisationAmount = 2000e18 - msg.value;</span>
  923 |     | <span class='neutral'>        }</span>
  924 |     | <span class='neutral'></span>
  925 |     | <span class='neutral'>        require(</span>
  926 | *   | <span class='executed'>            totalSubsidisedAmount + subsidisationAmount &lt;= maximumSubsidisationAmount,</span>
  927 |     | <span class='neutral'>            &quot;Subsidisation cap exceeded&quot;</span>
  928 |     | <span class='neutral'>        );</span>
  929 |     | <span class='neutral'></span>
  930 |     | <span class='neutral'>        require(</span>
  931 | *   | <span class='executed'>            validationDuration == VALIDATION_DURATION_TWO_WEEKS ||</span>
  932 | *   | <span class='executed'>            validationDuration == VALIDATION_DURATION_FOUR_WEEKS ||</span>
  933 | *   | <span class='executed'>            validationDuration == VALIDATION_DURATION_EIGHT_WEEKS ||</span>
  934 | *   | <span class='executed'>            validationDuration == VALIDATION_DURATION_TWELVE_WEEKS,</span>
  935 |     | <span class='neutral'>            &quot;Invalid staking duration&quot;</span>
  936 |     | <span class='neutral'>        );</span>
  937 |     | <span class='neutral'></span>
  938 | *   | <span class='executed'>        totalSubsidisedAmount += subsidisationAmount;</span>
  939 |     | <span class='neutral'></span>
  940 |     | <span class='neutral'>        _register(</span>
  941 |     | <span class='neutral'>            beneficiary,</span>
  942 |     | <span class='neutral'>            nodeId,</span>
  943 |     | <span class='neutral'>            blsProofOfPossession,</span>
  944 |     | <span class='neutral'>            validationDuration,</span>
  945 |     | <span class='neutral'>            feePaid,</span>
  946 |     | <span class='neutral'>            token,</span>
  947 |     | <span class='neutral'>            tokenAmount,</span>
  948 |     | <span class='neutral'>            isEligibleForQiRewards</span>
  949 |     | <span class='neutral'>        );</span>
  950 |     | <span class='neutral'>    }</span>
  951 |     | <span class='neutral'></span>
  952 |     | <span class='neutral'>    /**</span>
  953 |     | <span class='neutral'>     * @notice Store the registration</span>
  954 |     | <span class='neutral'>     * @param  beneficiary The beneficiary of the registration</span>
  955 |     | <span class='neutral'>     * @param  nodeId ID of the node to register</span>
  956 |     | <span class='neutral'>     * @param  blsProofOfPossession BLS proof of possession (public key + signature)</span>
  957 |     | <span class='neutral'>     * @param  validationDuration Duration of the validation period</span>
  958 |     | <span class='neutral'>     * @param  feePaid Whether or not the fee was paid</span>
  959 |     | <span class='neutral'>     * @param  token Payment token address</span>
  960 |     | <span class='neutral'>     * @param  tokenAmount Amount of ERC-20 tokens deposited</span>
  961 |     | <span class='neutral'>     * @param  isEligibleForQiRewards True if the node is eligible for QI rewards at the end of the validation</span>
  962 |     | <span class='neutral'>     */</span>
  963 |     | <span class='neutral'>    function _register(</span>
  964 |     | <span class='neutral'>        address beneficiary,</span>
  965 |     | <span class='neutral'>        string calldata nodeId,</span>
  966 |     | <span class='neutral'>        bytes calldata blsProofOfPossession,</span>
  967 |     | <span class='neutral'>        uint validationDuration,</span>
  968 |     | <span class='neutral'>        bool feePaid,</span>
  969 |     | <span class='neutral'>        address token,</span>
  970 |     | <span class='neutral'>        uint tokenAmount,</span>
  971 |     | <span class='neutral'>        bool isEligibleForQiRewards</span>
  972 |     | <span class='neutral'>    ) internal whenNotPaused {</span>
  973 |     | <span class='neutral'>        // uint registrationIndex = registrationIndicesByNodeId[nodeId];</span>
  974 |     | <span class='neutral'>        // require(</span>
  975 |     | <span class='neutral'>        //     registrationIndex == 0 &amp;&amp; bytes(nodeId).length != 0,</span>
  976 |     | <span class='neutral'>        //     &quot;Node already registered&quot;</span>
  977 |     | <span class='neutral'>        // );</span>
  978 |     | <span class='neutral'></span>
  979 | *   | <span class='executed'>        require(blsProofOfPossession.length == 144);</span>
  980 |     | <span class='neutral'></span>
  981 | *   | <span class='executed'>        registrationIndicesByNodeId[nodeId] = registrations.length;</span>
  982 | *   | <span class='executed'>        registrations.push(</span>
  983 | *   | <span class='executed'>            Registration(</span>
  984 |     | <span class='neutral'>                beneficiary,</span>
  985 |     | <span class='neutral'>                nodeId,</span>
  986 |     | <span class='neutral'>                validationDuration,</span>
  987 |     | <span class='neutral'>                feePaid,</span>
  988 | *   | <span class='executed'>                TokenDepositDetails(</span>
  989 |     | <span class='neutral'>                    msg.value, // avax amount</span>
  990 |     | <span class='neutral'>                    token,</span>
  991 |     | <span class='neutral'>                    tokenAmount</span>
  992 |     | <span class='neutral'>                ),</span>
  993 |     | <span class='neutral'>                0,</span>
  994 | *   | <span class='executed'>                qiSlashPercentage,</span>
  995 | *   | <span class='executed'>                avaxSlashPercentage,</span>
  996 |     | <span class='neutral'>                false,</span>
  997 |     | <span class='neutral'>                false</span>
  998 |     | <span class='neutral'>            )</span>
  999 |     | <span class='neutral'>        );</span>
 1000 |     | <span class='neutral'></span>
 1001 | *   | <span class='executed'>        blsProofOfPossessionByNodeId[nodeId] = blsProofOfPossession;</span>
 1002 | *   | <span class='executed'>        qiRewardEligibilityByNodeId[nodeId] = isEligibleForQiRewards;</span>
 1003 |     | <span class='neutral'></span>
 1004 | *   | <span class='executed'>        accountRegistrationIndicesByNodeId[nodeId] = registeredNodeIdsByAccount[beneficiary].length;</span>
 1005 |     | <span class='neutral'>        registeredNodeIdsByAccount[beneficiary].push(nodeId);</span>
 1006 |     | <span class='neutral'></span>
 1007 | *   | <span class='executed'>        emit NewRegistration(</span>
 1008 |     | <span class='neutral'>            beneficiary,</span>
 1009 |     | <span class='neutral'>            nodeId,</span>
 1010 |     | <span class='neutral'>            blsProofOfPossession,</span>
 1011 |     | <span class='neutral'>            validationDuration,</span>
 1012 |     | <span class='neutral'>            feePaid,</span>
 1013 |     | <span class='neutral'>            msg.value,</span>
 1014 |     | <span class='neutral'>            token,</span>
 1015 |     | <span class='neutral'>            tokenAmount</span>
 1016 |     | <span class='neutral'>        );</span>
 1017 |     | <span class='neutral'>    }</span>
 1018 |     | <span class='neutral'></span>
 1019 |     | <span class='neutral'>    /**</span>
 1020 |     | <span class='neutral'>     * @dev   Remove a node registration. Note that all tokens must have been</span>
 1021 |     | <span class='neutral'>     *        sent back to the original staker before deleting the registration</span>
 1022 |     | <span class='neutral'>     *        entry in order not to lose the tokens.</span>
 1023 |     | <span class='neutral'>     * @param nodeId Node ID to delete</span>
 1024 |     | <span class='neutral'>     */</span>
 1025 | *   | <span class='executed'>    function _deleteRegistration(string calldata nodeId) internal {</span>
 1026 | *   | <span class='executed'>        uint registrationIndex = registrationIndicesByNodeId[nodeId];</span>
 1027 | *   | <span class='executed'>        require(registrationIndex != 0);</span>
 1028 |     | <span class='neutral'></span>
 1029 | *   | <span class='executed'>        address registerer = registrations[registrationIndex].registerer;</span>
 1030 |     | <span class='neutral'></span>
 1031 | *   | <span class='executed'>        uint accountRegistrationIndex = accountRegistrationIndicesByNodeId[nodeId];</span>
 1032 | *   | <span class='executed'>        uint accountRegistrationLastIndex = registeredNodeIdsByAccount[registerer].length - 1;</span>
 1033 |     | <span class='neutral'></span>
 1034 | *   | <span class='executed'>        if (accountRegistrationIndex != accountRegistrationLastIndex) {</span>
 1035 | *   | <span class='executed'>            string memory lastNodeId = registeredNodeIdsByAccount[registerer][accountRegistrationLastIndex];</span>
 1036 | *   | <span class='executed'>            registeredNodeIdsByAccount[registerer][accountRegistrationIndex] = lastNodeId;</span>
 1037 |     | <span class='neutral'>            accountRegistrationIndicesByNodeId[lastNodeId] = accountRegistrationIndex;</span>
 1038 |     | <span class='neutral'>        }</span>
 1039 |     | <span class='neutral'></span>
 1040 |     | <span class='neutral'>        registeredNodeIdsByAccount[registerer].pop();</span>
 1041 |     | <span class='neutral'></span>
 1042 |     | <span class='neutral'>        delete accountRegistrationIndicesByNodeId[nodeId];</span>
 1043 | *   | <span class='executed'>        delete blsProofOfPossessionByNodeId[nodeId];</span>
 1044 | *   | <span class='executed'>        delete qiRewardEligibilityByNodeId[nodeId];</span>
 1045 |     | <span class='neutral'></span>
 1046 |     | <span class='neutral'>        uint totalRegistrations = registrations.length - 1;</span>
 1047 | *   | <span class='executed'>        if (registrationIndex != totalRegistrations) {</span>
 1048 | *   | <span class='executed'>            string memory lastNodeId = registrations[totalRegistrations].nodeId;</span>
 1049 | *   | <span class='executed'>            registrations[registrationIndex] = registrations[totalRegistrations];</span>
 1050 |     | <span class='neutral'>            registrationIndicesByNodeId[lastNodeId] = registrationIndex;</span>
 1051 |     | <span class='neutral'>        }</span>
 1052 |     | <span class='neutral'></span>
 1053 |     | <span class='neutral'>        registrations.pop();</span>
 1054 |     | <span class='neutral'></span>
 1055 |     | <span class='neutral'>        delete registrationIndicesByNodeId[nodeId];</span>
 1056 |     | <span class='neutral'></span>
 1057 | *   | <span class='executed'>        emit RegistrationDeleted(nodeId);</span>
 1058 |     | <span class='neutral'>    }</span>
 1059 |     | <span class='neutral'></span>
 1060 |     | <span class='neutral'>    /**</span>
 1061 |     | <span class='neutral'>     * @notice Get the registration fee in AVAX for a given validation duration</span>
 1062 |     | <span class='neutral'>     * @param  validationDuration Validation duration in seconds</span>
 1063 |     | <span class='neutral'>     * @return Registration fee in AVAX</span>
 1064 |     | <span class='neutral'>     */</span>
 1065 | *   | <span class='executed'>    function _getRegistrationFee(uint validationDuration) internal view returns (uint) {</span>
 1066 | *   | <span class='executed'>        if (validationDuration == VALIDATION_DURATION_TWO_WEEKS) {</span>
 1067 | *   | <span class='executed'>            return 8e18;</span>
 1068 |     | <span class='neutral'>        }</span>
 1069 |     | <span class='neutral'></span>
 1070 | *   | <span class='executed'>        if (validationDuration == VALIDATION_DURATION_FOUR_WEEKS) {</span>
 1071 | *   | <span class='executed'>            return 15e18;</span>
 1072 |     | <span class='neutral'>        }</span>
 1073 |     | <span class='neutral'></span>
 1074 | *   | <span class='executed'>        if (validationDuration == VALIDATION_DURATION_EIGHT_WEEKS) {</span>
 1075 | *   | <span class='executed'>            return 28e18;</span>
 1076 |     | <span class='neutral'>        }</span>
 1077 |     | <span class='neutral'></span>
 1078 | *   | <span class='executed'>        if (validationDuration == VALIDATION_DURATION_TWELVE_WEEKS) {</span>
 1079 | *   | <span class='executed'>            return 40e18;</span>
 1080 |     | <span class='neutral'>        }</span>
 1081 |     | <span class='neutral'></span>
 1082 |     | <span class='unexecuted'>        revert(&quot;Invalid validation duration&quot;);</span>
 1083 |     | <span class='neutral'>    }</span>
 1084 |     | <span class='neutral'></span>
 1085 |     | <span class='neutral'></span>
 1086 |     | <span class='neutral'>    </span>
 1087 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/src/IgniteStorage.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
   2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/token/ERC20/IERC20Upgradeable.sol&quot;;</span>
   5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/utils/structs/EnumerableSetUpgradeable.sol&quot;;</span>
   6 |     | <span class='neutral'></span>
   7 |     | <span class='neutral'>import &quot;./IStakedAvax.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;./IPriceFeed.sol&quot;;</span>
   9 |     | <span class='neutral'>import &quot;./ValidatorRewarder.sol&quot;;</span>
  10 |     | <span class='neutral'></span>
  11 |     | <span class='neutral'></span>
  12 |     | <span class='unexecuted'>contract IgniteStorage {</span>
  13 |     | <span class='neutral'>    using EnumerableSetUpgradeable for EnumerableSetUpgradeable.AddressSet;</span>
  14 |     | <span class='neutral'></span>
  15 |     | <span class='neutral'>    /// @dev List of all supported ERC-20 payment options for the fee model</span>
  16 |     | <span class='neutral'>    EnumerableSetUpgradeable.AddressSet paymentTokens;</span>
  17 |     | <span class='neutral'></span>
  18 |     | <span class='neutral'>    /// @dev Chainlink price feeds for each payment option</span>
  19 |     | <span class='unexecuted'>    mapping(address =&gt; IPriceFeed) public priceFeeds;</span>
  20 |     | <span class='neutral'></span>
  21 |     | <span class='neutral'>    /// @dev Max Chainlink price feed response age for each token</span>
  22 |     | <span class='unexecuted'>    mapping(address =&gt; uint) public maxPriceAges;</span>
  23 |     | <span class='neutral'></span>
  24 |     | <span class='neutral'>    struct TokenDepositDetails {</span>
  25 |     | <span class='neutral'>        /// @dev AVAX deposit amount</span>
  26 |     | <span class='neutral'>        uint avaxAmount;</span>
  27 |     | <span class='neutral'></span>
  28 |     | <span class='neutral'>        /// @dev Address of the deposited ERC-20 token (optional)</span>
  29 |     | <span class='neutral'>        address token;</span>
  30 |     | <span class='neutral'></span>
  31 |     | <span class='neutral'>        /// @dev Amount of the deposited ERC-20 token (must be zero if no token address is given)</span>
  32 |     | <span class='neutral'>        uint tokenAmount;</span>
  33 |     | <span class='neutral'>    }</span>
  34 |     | <span class='neutral'></span>
  35 |     | <span class='neutral'>    struct Registration {</span>
  36 |     | <span class='neutral'>        /// @dev The user who registered the node ID in Ignite</span>
  37 |     | <span class='neutral'>        address registerer;</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>        /// @dev The node ID</span>
  40 |     | <span class='neutral'>        string nodeId;</span>
  41 |     | <span class='neutral'></span>
  42 |     | <span class='neutral'>        /// @dev The requested validation duration in seconds</span>
  43 |     | <span class='neutral'>        uint validationDuration;</span>
  44 |     | <span class='neutral'></span>
  45 |     | <span class='neutral'>        /// @dev True if the registration was set up by paying a fee</span>
  46 |     | <span class='neutral'>        bool feePaid;</span>
  47 |     | <span class='neutral'></span>
  48 |     | <span class='neutral'>        /// @dev AVAX and ERC-20 token deposit amounts</span>
  49 |     | <span class='neutral'>        TokenDepositDetails tokenDeposits;</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>        /// @dev The amount of AVAX rewarded to the validator</span>
  52 |     | <span class='neutral'>        uint rewardAmount;</span>
  53 |     | <span class='neutral'></span>
  54 |     | <span class='neutral'>        /// @dev The percentage (in bps) of QI that can be slashed for this registration</span>
  55 |     | <span class='neutral'>        uint qiSlashPercentage;</span>
  56 |     | <span class='neutral'></span>
  57 |     | <span class='neutral'>        /// @dev The percentage (in bps) of AVAX that can be slashed for this registration</span>
  58 |     | <span class='neutral'>        uint avaxSlashPercentage;</span>
  59 |     | <span class='neutral'></span>
  60 |     | <span class='neutral'>        /// @dev Whether or not the validator has been slashed</span>
  61 |     | <span class='neutral'>        bool slashed;</span>
  62 |     | <span class='neutral'></span>
  63 |     | <span class='neutral'>        /// @dev Whether or not the registration has expired and the tokens can be withdrawn</span>
  64 |     | <span class='neutral'>        bool withdrawable;</span>
  65 |     | <span class='neutral'>    }</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='neutral'>    /// @dev The sAVAX contract</span>
  68 |     | <span class='unexecuted'>    IStakedAvax public sAVAX;</span>
  69 |     | <span class='neutral'></span>
  70 |     | <span class='neutral'>    /// @dev The QI token contract</span>
  71 |     | <span class='unexecuted'>    IERC20Upgradeable public qi;</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='neutral'>    /// @dev An array of all registrations</span>
  74 | *   | <span class='executed'>    Registration[] public registrations;</span>
  75 |     | <span class='neutral'></span>
  76 |     | <span class='neutral'>    /// @dev Node ID to registrations array index</span>
  77 | *   | <span class='executed'>    mapping(string =&gt; uint) public registrationIndicesByNodeId;</span>
  78 |     | <span class='neutral'></span>
  79 |     | <span class='neutral'>    /// @dev Registered node IDs per account</span>
  80 |     | <span class='unexecuted'>    mapping(address =&gt; string[]) public registeredNodeIdsByAccount;</span>
  81 |     | <span class='neutral'></span>
  82 |     | <span class='neutral'>    /// @dev Node ID to registeredNodeIdsByAccount index</span>
  83 |     | <span class='unexecuted'>    mapping(string =&gt; uint) public accountRegistrationIndicesByNodeId;</span>
  84 |     | <span class='neutral'></span>
  85 |     | <span class='neutral'>    /// @dev The total amount of AVAX that BENQI has subsidised for validation</span>
  86 |     | <span class='unexecuted'>    uint public totalSubsidisedAmount;</span>
  87 |     | <span class='neutral'></span>
  88 |     | <span class='neutral'>    /// @dev The maximum amount of AVAX that BENQI subsidises for validation</span>
  89 |     | <span class='unexecuted'>    uint public maximumSubsidisationAmount;</span>
  90 |     | <span class='neutral'></span>
  91 |     | <span class='neutral'>    /// @dev The amount QI (in bps) that can be slashed</span>
  92 |     | <span class='unexecuted'>    uint public qiSlashPercentage;</span>
  93 |     | <span class='neutral'></span>
  94 |     | <span class='neutral'>    /// @dev The amount of AVAX (in bps) that can be slashed</span>
  95 |     | <span class='unexecuted'>    uint public avaxSlashPercentage;</span>
  96 |     | <span class='neutral'></span>
  97 |     | <span class='neutral'>    /// @dev The minimum contract AVAX balance that must not be subceeded</span>
  98 | *   | <span class='executed'>    uint public minimumContractBalance;</span>
  99 |     | <span class='neutral'></span>
 100 |     | <span class='neutral'>    /// @dev The minimum amount of AVAX needed to register a validator</span>
 101 |     | <span class='unexecuted'>    uint public minimumAvaxDeposit;</span>
 102 |     | <span class='neutral'></span>
 103 |     | <span class='neutral'>    /// @dev The maximum amount of AVAX that can be used to register a validator</span>
 104 |     | <span class='unexecuted'>    uint public maximumAvaxDeposit;</span>
 105 |     | <span class='neutral'></span>
 106 |     | <span class='neutral'>    /// @dev Price multiplier used for fee payments in QI (in bps)</span>
 107 |     | <span class='unexecuted'>    uint public qiPriceMultiplier;</span>
 108 |     | <span class='neutral'></span>
 109 |     | <span class='neutral'>    /// @dev BLS proof of possession for registered nodes</span>
 110 |     | <span class='unexecuted'>    mapping(string =&gt; bytes) public blsProofOfPossessionByNodeId;</span>
 111 |     | <span class='neutral'></span>
 112 |     | <span class='neutral'>    /// @dev Rewarder contract for extra QI validation rewards</span>
 113 |     | <span class='unexecuted'>    ValidatorRewarder public validatorRewarder;</span>
 114 |     | <span class='neutral'></span>
 115 |     | <span class='neutral'>    /// @dev Whether or not a validator should be eligible for extra QI rewards after expiry</span>
 116 | *   | <span class='executed'>    mapping(string =&gt; bool) public qiRewardEligibilityByNodeId;</span>
 117 |     | <span class='neutral'>}</span>
 118 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/src/ValidatorRewarder.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
   2 |     | <span class='neutral'>pragma solidity ^0.8;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/token/ERC20/IERC20Upgradeable.sol&quot;;</span>
   5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol&quot;;</span>
   6 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/access/AccessControlUpgradeable.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/security/PausableUpgradeable.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;./ValidatorRewarderStorage.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/// @notice Thrown if a privileged function is called without appropriate access rights</span>
  11 |     | <span class='neutral'>error Unauthorized();</span>
  12 |     | <span class='neutral'></span>
  13 |     | <span class='unexecuted'>contract ValidatorRewarder is</span>
  14 |     | <span class='neutral'>    AccessControlUpgradeable,</span>
  15 |     | <span class='neutral'>    PausableUpgradeable,</span>
  16 |     | <span class='neutral'>    ValidatorRewarderStorage</span>
  17 |     | <span class='neutral'>{</span>
  18 |     | <span class='neutral'>    using SafeERC20Upgradeable for IERC20Upgradeable;</span>
  19 |     | <span class='neutral'></span>
  20 |     | <span class='unexecuted'>    bytes32 public constant ROLE_WITHDRAW = keccak256(&quot;ROLE_WITHDRAW&quot;);</span>
  21 |     | <span class='unexecuted'>    bytes32 public constant ROLE_PAUSE = keccak256(&quot;ROLE_PAUSE&quot;);</span>
  22 |     | <span class='unexecuted'>    bytes32 public constant ROLE_UNPAUSE = keccak256(&quot;ROLE_UNPAUSE&quot;);</span>
  23 |     | <span class='neutral'></span>
  24 |     | <span class='neutral'>    /// @notice Emitted when rewards are claimed</span>
  25 |     | <span class='neutral'>    event ClaimRewards(uint amount);</span>
  26 |     | <span class='neutral'></span>
  27 |     | <span class='neutral'>    /// @notice Emitted when the target APR is changed</span>
  28 |     | <span class='neutral'>    event NewTargetApr(uint oldTargetApr, uint newTargetApr);</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    /// @notice Emitted when QI is withdrawn from the rewarder contract by an admin</span>
  31 |     | <span class='neutral'>    event Withdraw(uint amount);</span>
  32 |     | <span class='neutral'></span>
  33 |     | <span class='neutral'>    /// @custom:oz-upgrades-unsafe-allow constructor</span>
  34 |     | <span class='neutral'>    constructor() {</span>
  35 |     | <span class='neutral'>        _disableInitializers();</span>
  36 |     | <span class='neutral'>    }</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    /**</span>
  39 |     | <span class='neutral'>     * @notice Set the initial contract parameters</span>
  40 |     | <span class='neutral'>     * @param _qi The QI token address</span>
  41 |     | <span class='neutral'>     * @param _ignite The Ignite contract address</span>
  42 |     | <span class='neutral'>     * @param _targetApr Target QI reward APR (bps)</span>
  43 |     | <span class='neutral'>     * @param _admin Contract owner address</span>
  44 |     | <span class='neutral'>     */</span>
  45 |     | <span class='neutral'>    function initialize(</span>
  46 |     | <span class='neutral'>        address _qi,</span>
  47 |     | <span class='neutral'>        address _ignite,</span>
  48 |     | <span class='neutral'>        uint _targetApr,</span>
  49 |     | <span class='neutral'>        address _admin</span>
  50 |     | <span class='neutral'>    ) initializer public {</span>
  51 |     | <span class='neutral'>        __AccessControl_init();</span>
  52 |     | <span class='neutral'>        __Pausable_init();</span>
  53 |     | <span class='neutral'></span>
  54 |     | <span class='neutral'>        _grantRole(DEFAULT_ADMIN_ROLE, _admin);</span>
  55 |     | <span class='neutral'></span>
  56 |     | <span class='unexecuted'>        qi = IERC20Upgradeable(_qi);</span>
  57 |     | <span class='unexecuted'>        ignite = _ignite;</span>
  58 |     | <span class='unexecuted'>        targetApr = _targetApr;</span>
  59 |     | <span class='neutral'>    }</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    /**</span>
  62 |     | <span class='neutral'>     * @notice Claim QI rewards after validation expiry</span>
  63 |     | <span class='neutral'>     * @param validationDuration Validation duration (seconds)</span>
  64 |     | <span class='neutral'>     * @param stakeAmount QI stake amount (18 decimals)</span>
  65 |     | <span class='neutral'>     */</span>
  66 |     | <span class='neutral'>    function claimRewards(uint validationDuration, uint stakeAmount) external whenNotPaused returns (uint) {</span>
  67 |     | <span class='unexecuted'>        if (msg.sender != ignite) {</span>
  68 |     | <span class='neutral'>            revert Unauthorized();</span>
  69 |     | <span class='neutral'>        }</span>
  70 |     | <span class='neutral'></span>
  71 |     | <span class='unexecuted'>        uint rewardAmount = _calculateRewardAmount(validationDuration, stakeAmount);</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='unexecuted'>        qi.safeTransfer(msg.sender, rewardAmount);</span>
  74 |     | <span class='neutral'></span>
  75 |     | <span class='unexecuted'>        emit ClaimRewards(rewardAmount);</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>        return rewardAmount;</span>
  78 |     | <span class='neutral'>    }</span>
  79 |     | <span class='neutral'></span>
  80 |     | <span class='neutral'>    /**</span>
  81 |     | <span class='neutral'>     * @notice Claim QI rewards after validation expiry</span>
  82 |     | <span class='neutral'>     * @param validationDuration Validation duration (seconds)</span>
  83 |     | <span class='neutral'>     * @param stakeAmount QI stake amount (18 decimals)</span>
  84 |     | <span class='neutral'>     */</span>
  85 |     | <span class='neutral'>    function calculateRewardAmount(uint validationDuration, uint stakeAmount) external view returns (uint) {</span>
  86 |     | <span class='unexecuted'>        return _calculateRewardAmount(validationDuration, stakeAmount);</span>
  87 |     | <span class='neutral'>    }</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>    /**</span>
  90 |     | <span class='neutral'>     * @notice Claim QI rewards after validation expiry</span>
  91 |     | <span class='neutral'>     * @param validationDuration Validation duration (seconds)</span>
  92 |     | <span class='neutral'>     * @param stakeAmount QI stake amount (18 decimals)</span>
  93 |     | <span class='neutral'>     */</span>
  94 |     | <span class='unexecuted'>    function _calculateRewardAmount(uint validationDuration, uint stakeAmount) internal view returns (uint) {</span>
  95 |     | <span class='unexecuted'>        return stakeAmount * targetApr * validationDuration / 10_000 / 60 / 60 / 24 / 365;</span>
  96 |     | <span class='neutral'>    }</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>    /*</span>
  99 |     | <span class='neutral'>     * @notice Withdraw QI from the contract</span>
 100 |     | <span class='neutral'>     * @param amount QI amount</span>
 101 |     | <span class='neutral'>     */</span>
 102 |     | <span class='neutral'>    function withdraw(uint amount) external {</span>
 103 |     | <span class='unexecuted'>        if (!hasRole(ROLE_WITHDRAW, msg.sender)) {</span>
 104 |     | <span class='unexecuted'>            revert Unauthorized();</span>
 105 |     | <span class='neutral'>        }</span>
 106 |     | <span class='neutral'></span>
 107 |     | <span class='unexecuted'>        qi.safeTransfer(msg.sender, amount);</span>
 108 |     | <span class='neutral'></span>
 109 |     | <span class='unexecuted'>        emit Withdraw(amount);</span>
 110 |     | <span class='neutral'>    }</span>
 111 |     | <span class='neutral'></span>
 112 |     | <span class='neutral'>    /**</span>
 113 |     | <span class='neutral'>     * @notice Set the reward APR</span>
 114 |     | <span class='neutral'>     * @param newTargetApr New APR (bps)</span>
 115 |     | <span class='neutral'>     */</span>
 116 |     | <span class='neutral'>    function setTargetApr(uint newTargetApr) external {</span>
 117 |     | <span class='unexecuted'>        if (!hasRole(DEFAULT_ADMIN_ROLE, msg.sender)) {</span>
 118 |     | <span class='unexecuted'>            revert Unauthorized();</span>
 119 |     | <span class='neutral'>        }</span>
 120 |     | <span class='neutral'></span>
 121 |     | <span class='unexecuted'>        emit NewTargetApr(targetApr, newTargetApr);</span>
 122 |     | <span class='neutral'></span>
 123 |     | <span class='neutral'>        targetApr = newTargetApr;</span>
 124 |     | <span class='neutral'>    }</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    /*</span>
 127 |     | <span class='neutral'>     * @notice Pause reward claims</span>
 128 |     | <span class='neutral'>     */</span>
 129 |     | <span class='neutral'>    function pause() external {</span>
 130 |     | <span class='unexecuted'>        if (!hasRole(ROLE_PAUSE, msg.sender)) {</span>
 131 |     | <span class='neutral'>            revert Unauthorized();</span>
 132 |     | <span class='neutral'>        }</span>
 133 |     | <span class='neutral'></span>
 134 |     | <span class='neutral'>        _pause();</span>
 135 |     | <span class='neutral'>    }</span>
 136 |     | <span class='neutral'></span>
 137 |     | <span class='neutral'>    /*</span>
 138 |     | <span class='neutral'>     * @notice Resume reward claims</span>
 139 |     | <span class='neutral'>     */</span>
 140 |     | <span class='neutral'>    function unpause() external {</span>
 141 |     | <span class='unexecuted'>        if (!hasRole(ROLE_PAUSE, msg.sender)) {</span>
 142 |     | <span class='neutral'>            revert Unauthorized();</span>
 143 |     | <span class='neutral'>        }</span>
 144 |     | <span class='neutral'></span>
 145 |     | <span class='neutral'>        _unpause();</span>
 146 |     | <span class='neutral'>    }</span>
 147 |     | <span class='neutral'>}</span>
 148 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/src/ValidatorRewarderStorage.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;@openzeppelin/contracts-upgradeable/token/ERC20/IERC20Upgradeable.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract ValidatorRewarderStorage {</span>
  7 |     | <span class='neutral'>    /// @notice The QI token</span>
  8 |     | <span class='unexecuted'>    IERC20Upgradeable public qi;</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'>    /// @notice The Ignite contract address</span>
 11 |     | <span class='unexecuted'>    address public ignite;</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    /// @notice Target APR (bps)</span>
 14 |     | <span class='unexecuted'>    uint public targetApr;</span>
 15 |     | <span class='neutral'>}</span>
 16 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/test/chiemara/BeforeAfter.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-2.0</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {Setup} from &quot;./Setup.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>// ghost variables for tracking state variable values before and after function calls</span>
  7 |     | <span class='neutral'>abstract contract BeforeAfter is Setup {</span>
  8 |     | <span class='neutral'>    // struct Vars {</span>
  9 |     | <span class='neutral'>    //     uint256 counter_number;</span>
 10 |     | <span class='neutral'>    // }</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>    // Vars internal _before;</span>
 13 |     | <span class='neutral'>    // Vars internal _after;</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'>    function __before() internal {</span>
 16 |     | <span class='neutral'>        // _before.counter_number = counter.number();</span>
 17 |     | <span class='neutral'>    }</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    function __after() internal {</span>
 20 |     | <span class='neutral'>        // _after.counter_number = counter.number();</span>
 21 |     | <span class='neutral'>    }</span>
 22 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/test/chiemara/CryticTester.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-2.0</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {TargetFunctions} from &quot;./TargetFunctions.sol&quot;;</span>
  5 |     | <span class='neutral'>import {CryticAsserts} from &quot;@chimera/CryticAsserts.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>// echidna . --contract CryticTester --config echidna.yaml</span>
  8 |     | <span class='neutral'>// medusa fuzz</span>
  9 | *r  | <span class='executed'>contract CryticTester is TargetFunctions, CryticAsserts {</span>
 10 |     | <span class='neutral'>    constructor() payable {</span>
 11 |     | <span class='neutral'>        setup();</span>
 12 |     | <span class='neutral'>    }</span>
 13 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/test/chiemara/Properties.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-2.0</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {Asserts} from &quot;@chimera/Asserts.sol&quot;;</span>
  5 |     | <span class='neutral'>import {BeforeAfter} from &quot;./BeforeAfter.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>import {IgniteStorage} from &quot;../../src/IgniteStorage.sol&quot;;</span>
  8 |     | <span class='neutral'>event LogAsad(uint256);</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'>abstract contract Properties is BeforeAfter, Asserts {</span>
 11 |     | <span class='neutral'>   function echidna_check_eth_balance() external   returns(bool){</span>
 12 |     | <span class='unexecuted'>            emit LogAsad(totalEthStaked);</span>
 13 |     | <span class='unexecuted'>            emit LogAsad(address(ignite).balance);</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='unexecuted'>        return address(ignite).balance == totalEthStaked;</span>
 17 |     | <span class='neutral'>    }</span>
 18 |     | <span class='neutral'>   function echidna_check_minimum_eth_balance() external  view returns(bool){</span>
 19 | *   | <span class='executed'>        return ignite.minimumContractBalance() == gostMinimumContractBalance;</span>
 20 |     | <span class='neutral'>    }</span>
 21 |     | <span class='neutral'>   function echidna_check_qi_balance() external view returns(bool){</span>
 22 |     | <span class='unexecuted'>        return  qi.balanceOf(address(ignite)) ==  totalQIStaked;</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='unexecuted'>         function echidna_check_fail_registration_withdrawal() public view returns(bool){</span>
 25 |     | <span class='unexecuted'>        if(releaseLockTokenFailedCalled){</span>
 26 |     | <span class='unexecuted'>            for(uint i = 0; i &lt; failRegistrationIndices.length; i++){</span>
 27 |     | <span class='unexecuted'>                uint registrationIndex = ignite.registrationIndicesByNodeId(failRegistrationIndices[i]);</span>
 28 |     | <span class='unexecuted'>                (,,,,,,,,,bool withdrawable) = ignite.</span>
 29 |     | <span class='neutral'>                registrations(registrationIndex);</span>
 30 |     | <span class='unexecuted'>                    if(!withdrawable){</span>
 31 |     | <span class='unexecuted'>                        return false;</span>
 32 |     | <span class='neutral'>                    }   </span>
 33 |     | <span class='neutral'>            }</span>
 34 |     | <span class='neutral'>        }</span>
 35 |     | <span class='unexecuted'>        return true;</span>
 36 |     | <span class='neutral'>    }</span>
 37 |     | <span class='unexecuted'>    function echidna_check_success_registration_withdrawal() external  returns(bool){</span>
 38 |     | <span class='unexecuted'>        if(releaseLockTokenSuccessCalled){</span>
 39 |     | <span class='unexecuted'>        emit LogAsad(avaxFee);</span>
 40 |     | <span class='unexecuted'>        emit LogAsad(tokenFee);</span>
 41 |     | <span class='unexecuted'>            return address(FEE_RECIPIENT).balance == avaxFee &amp;&amp; qi.balanceOf(FEE_RECIPIENT) == tokenFee;</span>
 42 |     | <span class='neutral'>        }</span>
 43 |     | <span class='unexecuted'>        return true;</span>
 44 |     | <span class='neutral'>    }</span>
 45 |     | <span class='unexecuted'>    function echidna_check_success_slashed() external  returns(bool){</span>
 46 |     | <span class='neutral'>        </span>
 47 |     | <span class='unexecuted'>        if(releaseLockTokenSlashedCalled){</span>
 48 |     | <span class='unexecuted'>         emit LogAsad(tokenSlash);</span>
 49 |     | <span class='unexecuted'>        emit LogAsad(avaxSlash);</span>
 50 |     | <span class='unexecuted'>        emit LogAsad(address(SLASHED_TOKEN_RECIPIENT).balance);</span>
 51 |     | <span class='unexecuted'>        emit LogAsad(qi.balanceOf(SLASHED_TOKEN_RECIPIENT));</span>
 52 |     | <span class='unexecuted'>            return address(SLASHED_TOKEN_RECIPIENT).balance == avaxSlash &amp;&amp; qi.balanceOf(SLASHED_TOKEN_RECIPIENT) == tokenSlash;</span>
 53 |     | <span class='neutral'>        }</span>
 54 |     | <span class='unexecuted'>        return true;</span>
 55 |     | <span class='neutral'>    }</span>
 56 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/test/chiemara/Setup.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-2.0</span>
   2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import {BaseSetup} from &quot;@chimera/BaseSetup.sol&quot;;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import {Ignite} from &quot;../../src/Ignite.sol&quot;;</span>
   7 |     | <span class='neutral'>import {PriceFeed} from &quot;../contracts/PriceFeed.sol&quot;;</span>
   8 |     | <span class='neutral'>import {StakedAvax} from &quot;../contracts/StakedAvax.sol&quot;;</span>
   9 |     | <span class='neutral'>import {FaucetToken} from &quot;../contracts/FaucetToken.sol&quot;;</span>
  10 |     | <span class='neutral'></span>
  11 |     | <span class='neutral'>import {vm} from &quot;@chimera/Hevm.sol&quot;;</span>
  12 |     | <span class='neutral'></span>
  13 |     | <span class='neutral'>abstract contract Setup is BaseSetup {</span>
  14 | *   | <span class='executed'>    address admin = address(0x23457643);</span>
  15 |     | <span class='neutral'>    address[] internal users;</span>
  16 | *   | <span class='executed'>    bytes public blsKey =</span>
  17 | *   | <span class='executed'>        hex&quot;8d609cdd38ffc9ad01c91d1ae4fccb8cd6c75a6ad33a401da42283b0c3b59bbaf5abc172335ea4d9c31baa936818f0ab&quot;;</span>
  18 |     | <span class='neutral'></span>
  19 | *   | <span class='executed'>    bytes public blsSignature =</span>
  20 | *   | <span class='executed'>        hex&quot;8c12c805e7dfe4bfe38be44685ee852d931d73b3c0820a1343d731909120cee4895f9b60990520a90d06a031a42e0f8616d415b543408c24be0da90d5e7fa8242f4fd32dadf34c790996ca474dbdbcd763f82c53880db19fd3b30d13cee278b4&quot;;</span>
  21 |     | <span class='neutral'></span>
  22 | *   | <span class='executed'>    bytes public blsPoP = abi.encodePacked(blsKey, blsSignature);</span>
  23 |     | <span class='neutral'>    Ignite ignite;</span>
  24 |     | <span class='neutral'>    FaucetToken qi;</span>
  25 |     | <span class='neutral'>    StakedAvax sAvax;</span>
  26 |     | <span class='neutral'>    PriceFeed qiPriceFeed;</span>
  27 |     | <span class='neutral'>    PriceFeed avaxPriceFeed;</span>
  28 |     | <span class='neutral'>    // ghost variable</span>
  29 |     | <span class='neutral'>    uint256 totalEthStaked;</span>
  30 |     | <span class='neutral'>    uint256 totalQIStaked;</span>
  31 | *   | <span class='executed'>    uint public qiPriceMultiplier = 10_000;</span>
  32 | *   | <span class='executed'>    address public constant FEE_RECIPIENT = 0xaAaAaAaaAaAaAaaAaAAAAAAAAaaaAaAaAaaAaaAa;</span>
  33 | *   | <span class='executed'>    address public constant SLASHED_TOKEN_RECIPIENT = 0xbBbBBBBbbBBBbbbBbbBbbbbBBbBbbbbBbBbbBBbB;</span>
  34 |     | <span class='neutral'></span>
  35 | *   | <span class='executed'>    uint public gostMinimumContractBalance;</span>
  36 |     | <span class='unexecuted'>    uint256[] public durations;</span>
  37 | *   | <span class='executed'>    uint public constant VALIDATION_DURATION_TWO_WEEKS = 86400 * 7 * 2;</span>
  38 | *   | <span class='executed'>    uint public constant VALIDATION_DURATION_FOUR_WEEKS = 86400 * 7 * 4;</span>
  39 | *   | <span class='executed'>    uint public constant VALIDATION_DURATION_EIGHT_WEEKS = 86400 * 7 * 8;</span>
  40 | *   | <span class='executed'>    uint public constant VALIDATION_DURATION_TWELVE_WEEKS = 86400 * 7 * 12;</span>
  41 | *   | <span class='executed'>    uint[] public amountArr = [</span>
  42 | *   | <span class='executed'>        25 ether,</span>
  43 | *   | <span class='executed'>        50 ether,</span>
  44 | *   | <span class='executed'>        75 ether,</span>
  45 | *   | <span class='executed'>        100 ether,</span>
  46 | *   | <span class='executed'>        125 ether,</span>
  47 | *   | <span class='executed'>        150 ether,</span>
  48 | *   | <span class='executed'>        175 ether,</span>
  49 | *   | <span class='executed'>        200 ether,</span>
  50 | *   | <span class='executed'>        225 ether,</span>
  51 | *   | <span class='executed'>        250 ether,</span>
  52 | *   | <span class='executed'>        275 ether,</span>
  53 | *   | <span class='executed'>        300 ether,</span>
  54 | *   | <span class='executed'>        325 ether,</span>
  55 | *   | <span class='executed'>        350 ether,</span>
  56 | *   | <span class='executed'>        375 ether,</span>
  57 | *   | <span class='executed'>        400 ether,</span>
  58 | *   | <span class='executed'>        425 ether,</span>
  59 | *   | <span class='executed'>        450 ether,</span>
  60 | *   | <span class='executed'>        475 ether,</span>
  61 | *   | <span class='executed'>        500 ether</span>
  62 |     | <span class='neutral'>    ];</span>
  63 |     | <span class='neutral'></span>
  64 | *   | <span class='executed'>    string[] public nodeIds;</span>
  65 | *   | <span class='executed'>    string[] public failRegistrationIndices;</span>
  66 |     | <span class='unexecuted'>    uint[] public successRegistrationIndices;</span>
  67 | *   | <span class='executed'>    bool public releaseLockTokenFailedCalled;</span>
  68 |     | <span class='unexecuted'>    bool public releaseLockTokenSuccessCalled;</span>
  69 | *   | <span class='executed'>    bool public releaseLockTokenSlashedCalled;</span>
  70 |     | <span class='neutral'></span>
  71 | *   | <span class='executed'>    uint public avaxFee;</span>
  72 | *   | <span class='executed'>    uint public avaxSlash;</span>
  73 | *   | <span class='executed'>    uint public tokenFee;</span>
  74 |     | <span class='unexecuted'>    uint public tokenSlash;</span>
  75 | *   | <span class='executed'>    bool public isRegisteredCalled;</span>
  76 |     | <span class='neutral'>    function boundValue(</span>
  77 |     | <span class='neutral'>        uint256 value,</span>
  78 |     | <span class='neutral'>        uint256 min,</span>
  79 |     | <span class='neutral'>        uint256 max</span>
  80 |     | <span class='neutral'>    ) public pure returns (uint256) {</span>
  81 | *   | <span class='executed'>        return min + (value % (max - min));</span>
  82 |     | <span class='neutral'>    }</span>
  83 |     | <span class='neutral'></span>
  84 |     | <span class='neutral'>    function setup() internal virtual override {</span>
  85 |     | <span class='neutral'>        users.push(address(0x1));</span>
  86 |     | <span class='neutral'>        users.push(address(0x2));</span>
  87 |     | <span class='neutral'>        users.push(address(0x3));</span>
  88 | *   | <span class='executed'>        vm.prank(admin);</span>
  89 | *   | <span class='executed'>        qiPriceFeed = new PriceFeed(1_000_000);</span>
  90 | *   | <span class='executed'>        vm.prank(admin);</span>
  91 | *   | <span class='executed'>        avaxPriceFeed = new PriceFeed(2_000_000_000);</span>
  92 | *   | <span class='executed'>        vm.prank(admin);</span>
  93 | *   | <span class='executed'>        sAvax = new StakedAvax();</span>
  94 | *   | <span class='executed'>        vm.prank(admin);</span>
  95 | *   | <span class='executed'>        qi = new FaucetToken(&quot;BENQI&quot;, &quot;QI&quot;, 18);</span>
  96 | *   | <span class='executed'>        vm.prank(admin);</span>
  97 | *   | <span class='executed'>        ignite = new Ignite();</span>
  98 | *   | <span class='executed'>        vm.prank(admin);</span>
  99 | *   | <span class='executed'>        ignite.initialize(</span>
 100 |     | <span class='neutral'>            address(sAvax),</span>
 101 |     | <span class='neutral'>            address(qi),</span>
 102 |     | <span class='neutral'>            address(avaxPriceFeed),</span>
 103 | *   | <span class='executed'>            1 days,</span>
 104 |     | <span class='neutral'>            address(qiPriceFeed),</span>
 105 |     | <span class='neutral'>            1 days,</span>
 106 |     | <span class='neutral'>            25 ether, // min eth</span>
 107 | *   | <span class='executed'>            1500 ether // max eth</span>
 108 |     | <span class='neutral'>        );</span>
 109 | *   | <span class='executed'>        for (uint i = 0; i &lt; users.length; i++) {</span>
 110 | *   | <span class='executed'>            vm.prank(users[i]);</span>
 111 | *   | <span class='executed'>            qi.mint(10000000000000000 ether); // mint qi</span>
 112 | *   | <span class='executed'>            vm.deal(users[i], 10000000000000000 ether); // mint eth</span>
 113 | *   | <span class='executed'>            vm.prank(users[i]);</span>
 114 | *   | <span class='executed'>            qi.approve(address(ignite), type(uint256).max);</span>
 115 |     | <span class='neutral'>        }</span>
 116 | *   | <span class='executed'>        vm.prank(admin);</span>
 117 | *   | <span class='executed'>        ignite.grantRole(keccak256(&quot;ROLE_WITHDRAW&quot;), admin);</span>
 118 | *   | <span class='executed'>        vm.prank(admin);</span>
 119 | *   | <span class='executed'>        ignite.grantRole(keccak256(&quot;ROLE_RELEASE_LOCKED_TOKENS&quot;), admin);</span>
 120 |     | <span class='neutral'></span>
 121 | *   | <span class='executed'>        vm.prank(admin);</span>
 122 | *   | <span class='executed'>        ignite.addPaymentToken(address(qi), address(qiPriceFeed), 1 days);</span>
 123 | *   | <span class='executed'>        durations.push(VALIDATION_DURATION_TWO_WEEKS);</span>
 124 |     | <span class='neutral'>        durations.push(VALIDATION_DURATION_FOUR_WEEKS);</span>
 125 |     | <span class='neutral'>        durations.push(VALIDATION_DURATION_EIGHT_WEEKS);</span>
 126 |     | <span class='neutral'>        durations.push(VALIDATION_DURATION_TWELVE_WEEKS);</span>
 127 |     | <span class='neutral'>        // register_With_Erc20_Fee(0,45,0);</span>
 128 |     | <span class='neutral'>        // echidna_check_qi_balance();</span>
 129 |     | <span class='neutral'>        // revert();</span>
 130 |     | <span class='neutral'>    }</span>
 131 |     | <span class='neutral'>}</span>
 132 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/test/chiemara/TargetFunctions.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-2.0</span>
   2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import {BaseTargetFunctions} from &quot;@chimera/BaseTargetFunctions.sol&quot;;</span>
   5 |     | <span class='neutral'>import {BeforeAfter} from &quot;./BeforeAfter.sol&quot;;</span>
   6 |     | <span class='neutral'>import {Properties} from &quot;./Properties.sol&quot;;</span>
   7 |     | <span class='neutral'>import {vm} from &quot;@chimera/Hevm.sol&quot;;</span>
   8 |     | <span class='neutral'>import {IgniteStorage} from &quot;../../src/IgniteStorage.sol&quot;;</span>
   9 |     | <span class='neutral'>event LogUint(uint);</span>
  10 |     | <span class='neutral'></span>
  11 |     | <span class='neutral'>abstract contract TargetFunctions is BaseTargetFunctions, Properties {</span>
  12 |     | <span class='neutral'>    function register_with_stake(</span>
  13 |     | <span class='neutral'>        uint256 userIndex,</span>
  14 |     | <span class='neutral'>        uint256 amountIndex,</span>
  15 |     | <span class='neutral'>        uint256 nodeId,</span>
  16 |     | <span class='neutral'>        uint validationDurationIndex</span>
  17 |     | <span class='neutral'>    ) public {</span>
  18 | *   | <span class='executed'>        amountIndex = boundValue(amountIndex, 0, amountArr.length);</span>
  19 |     | <span class='neutral'>        userIndex = boundValue(userIndex, 0, users.length);</span>
  20 |     | <span class='neutral'>        validationDurationIndex = boundValue(</span>
  21 |     | <span class='neutral'>            validationDurationIndex,</span>
  22 |     | <span class='neutral'>            0,</span>
  23 | *   | <span class='executed'>            durations.length</span>
  24 |     | <span class='neutral'>        ); // 2-12 weeks</span>
  25 | *   | <span class='executed'>        uint validationDuration = durations[validationDurationIndex];</span>
  26 |     | <span class='neutral'>        // uint registrationFee = ignite.getRegistrationFee(validationDuration);</span>
  27 |     | <span class='neutral'></span>
  28 |     | <span class='neutral'>        // gostMinimumContractBalance += registrationFee;</span>
  29 |     | <span class='neutral'></span>
  30 | *   | <span class='executed'>        address user = users[userIndex];</span>
  31 | *   | <span class='executed'>        uint amount = amountArr[amountIndex];</span>
  32 | *   | <span class='executed'>        (, int avaxPrice, , , ) = avaxPriceFeed.latestRoundData();</span>
  33 | *   | <span class='executed'>        (, int qiPrice, , , ) = qiPriceFeed.latestRoundData();</span>
  34 | *   | <span class='executed'>        uint qiAmount = (uint(avaxPrice) * (2000e18 - amount)) /</span>
  35 |     | <span class='neutral'>            uint(qiPrice) /</span>
  36 | *   | <span class='executed'>            10;</span>
  37 | *   | <span class='executed'>        totalQIStaked += qiAmount;</span>
  38 | *   | <span class='executed'>        totalEthStaked += amount;</span>
  39 | *   | <span class='executed'>        vm.prank(user);</span>
  40 | *   | <span class='executed'>        ignite.registerWithStake{value: amount}(</span>
  41 | *   | <span class='executed'>            string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)),</span>
  42 |     | <span class='neutral'>            blsPoP,</span>
  43 |     | <span class='neutral'>            validationDuration</span>
  44 |     | <span class='neutral'>        );</span>
  45 | *   | <span class='executed'>        nodeIds.push(string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)));</span>
  46 | *   | <span class='executed'>        isRegisteredCalled = true;</span>
  47 |     | <span class='neutral'>    }</span>
  48 |     | <span class='neutral'>    function register_with_erc20_fee(</span>
  49 |     | <span class='neutral'>        uint256 userIndex,</span>
  50 |     | <span class='neutral'>        uint256 nodeId,</span>
  51 |     | <span class='neutral'>        uint validationDurationIndex</span>
  52 |     | <span class='neutral'>    ) public {</span>
  53 | *   | <span class='executed'>        userIndex = boundValue(userIndex, 0, users.length);</span>
  54 |     | <span class='neutral'>        validationDurationIndex = boundValue(</span>
  55 |     | <span class='neutral'>            validationDurationIndex,</span>
  56 |     | <span class='neutral'>            0,</span>
  57 |     | <span class='neutral'>            durations.length</span>
  58 |     | <span class='neutral'>        ); // 2-12 weeks</span>
  59 | *   | <span class='executed'>        uint validationDuration = durations[validationDurationIndex];</span>
  60 |     | <span class='neutral'></span>
  61 | *   | <span class='executed'>        address user = users[userIndex];</span>
  62 | *   | <span class='executed'>        uint registrationFee = ignite.getRegistrationFee(validationDuration);</span>
  63 |     | <span class='neutral'></span>
  64 | *   | <span class='executed'>        (, int avaxPrice, , , ) = avaxPriceFeed.latestRoundData();</span>
  65 | *   | <span class='executed'>        (, int qiPrice, , , ) = qiPriceFeed.latestRoundData();</span>
  66 | *   | <span class='executed'>        uint tokenAmount = (uint(avaxPrice) * registrationFee) /</span>
  67 |     | <span class='neutral'>            uint(qiPrice) /</span>
  68 | *   | <span class='executed'>            10 ** (18 - qi.decimals());</span>
  69 | *   | <span class='executed'>        uint amount = (tokenAmount * qiPriceMultiplier) / 10_000;</span>
  70 | *   | <span class='executed'>        totalQIStaked += amount;</span>
  71 | *   | <span class='executed'>        vm.prank(user);</span>
  72 | *   | <span class='executed'>        ignite.registerWithErc20Fee(</span>
  73 |     | <span class='neutral'>            address(qi),</span>
  74 | *   | <span class='executed'>            string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)),</span>
  75 |     | <span class='neutral'>            blsPoP,</span>
  76 |     | <span class='neutral'>            validationDuration</span>
  77 |     | <span class='neutral'>        );</span>
  78 |     | <span class='unexecuted'>        nodeIds.push(string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)));</span>
  79 |     | <span class='neutral'>        isRegisteredCalled = true;</span>
  80 |     | <span class='neutral'>    }</span>
  81 |     | <span class='neutral'></span>
  82 |     | <span class='neutral'>    function register_with_prevalidated_qiStake(</span>
  83 |     | <span class='neutral'>        uint256 userIndex,</span>
  84 |     | <span class='neutral'>        uint256 nodeId,</span>
  85 |     | <span class='neutral'>        uint validationDurationIndex</span>
  86 |     | <span class='neutral'>    ) public {</span>
  87 | *   | <span class='executed'>        userIndex = boundValue(userIndex, 0, users.length);</span>
  88 |     | <span class='neutral'>        validationDurationIndex = boundValue(</span>
  89 |     | <span class='neutral'>            validationDurationIndex,</span>
  90 |     | <span class='neutral'>            0,</span>
  91 | *   | <span class='executed'>            durations.length</span>
  92 |     | <span class='neutral'>        );</span>
  93 | *   | <span class='executed'>        uint validationDuration = durations[validationDurationIndex];</span>
  94 |     | <span class='neutral'></span>
  95 | *   | <span class='executed'>        address user = users[userIndex];</span>
  96 |     | <span class='neutral'></span>
  97 | *   | <span class='executed'>        vm.prank(admin);</span>
  98 | *   | <span class='executed'>        ignite.grantRole(</span>
  99 | *   | <span class='executed'>            keccak256(&quot;ROLE_REGISTER_WITH_FLEXIBLE_PRICE_CHECK&quot;),</span>
 100 |     | <span class='neutral'>            user</span>
 101 |     | <span class='neutral'>        );</span>
 102 |     | <span class='neutral'></span>
 103 | *   | <span class='executed'>        (, int avaxPrice, , , ) = avaxPriceFeed.latestRoundData();</span>
 104 | *   | <span class='executed'>        (, int qiPrice, , , ) = qiPriceFeed.latestRoundData();</span>
 105 |     | <span class='neutral'>        // 200 AVAX + 1 AVAX fee = 201e18</span>
 106 | *   | <span class='executed'>        uint expectedQiAmount = (uint(avaxPrice) * 201e18) / uint(qiPrice);</span>
 107 |     | <span class='neutral'></span>
 108 | *   | <span class='executed'>        uint qiAmount = (expectedQiAmount * 9) / 10;</span>
 109 |     | <span class='neutral'></span>
 110 | *   | <span class='executed'>        totalQIStaked += qiAmount;</span>
 111 | *   | <span class='executed'>        vm.prank(user);</span>
 112 | *   | <span class='executed'>        ignite.registerWithPrevalidatedQiStake(</span>
 113 |     | <span class='neutral'>            address(user),</span>
 114 | *   | <span class='executed'>            string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)),</span>
 115 |     | <span class='neutral'>            blsPoP,</span>
 116 |     | <span class='neutral'>            validationDuration,</span>
 117 |     | <span class='neutral'>            qiAmount</span>
 118 |     | <span class='neutral'>        );</span>
 119 |     | <span class='unexecuted'>        nodeIds.push(string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)));</span>
 120 |     | <span class='neutral'>        isRegisteredCalled = true;</span>
 121 |     | <span class='neutral'>    }</span>
 122 |     | <span class='neutral'>    function register_without_collateral(</span>
 123 |     | <span class='neutral'>        uint256 userIndex,</span>
 124 |     | <span class='neutral'>        uint256 nodeId,</span>
 125 |     | <span class='neutral'>        uint validationDurationIndex</span>
 126 |     | <span class='neutral'>    ) public {</span>
 127 | *   | <span class='executed'>        userIndex = boundValue(userIndex, 0, users.length);</span>
 128 |     | <span class='neutral'>        validationDurationIndex = boundValue(</span>
 129 |     | <span class='neutral'>            validationDurationIndex,</span>
 130 |     | <span class='neutral'>            0,</span>
 131 | *   | <span class='executed'>            durations.length+1</span>
 132 |     | <span class='neutral'>        );</span>
 133 | *   | <span class='executed'>        uint256[5] memory _durations = [durations[0],durations[1],durations[2],durations[3],86400 * 365];</span>
 134 |     | <span class='neutral'>        uint validationDuration = _durations[validationDurationIndex];</span>
 135 |     | <span class='neutral'></span>
 136 | *   | <span class='executed'>        address user = users[userIndex];</span>
 137 |     | <span class='neutral'></span>
 138 | *   | <span class='executed'>        vm.prank(admin);</span>
 139 | *   | <span class='executed'>        ignite.grantRole(keccak256(&quot;ROLE_REGISTER_WITHOUT_COLLATERAL&quot;), user);</span>
 140 |     | <span class='neutral'></span>
 141 | *   | <span class='executed'>        vm.prank(user);</span>
 142 | *   | <span class='executed'>        ignite.registerWithoutCollateral(</span>
 143 | *   | <span class='executed'>            string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)),</span>
 144 |     | <span class='neutral'>            blsPoP,</span>
 145 |     | <span class='neutral'>            validationDuration</span>
 146 |     | <span class='neutral'>        );</span>
 147 | *   | <span class='executed'>        nodeIds.push(string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)));</span>
 148 |     | <span class='neutral'>    }</span>
 149 |     | <span class='neutral'></span>
 150 |     | <span class='neutral'>    function register_with_avax_fee(</span>
 151 |     | <span class='neutral'>        uint256 userIndex,</span>
 152 |     | <span class='neutral'>        uint validationDurationIndex,</span>
 153 |     | <span class='neutral'>        uint256 nodeId</span>
 154 |     | <span class='neutral'>    ) public {</span>
 155 | *   | <span class='executed'>        userIndex = boundValue(userIndex, 0, users.length);</span>
 156 |     | <span class='neutral'>        validationDurationIndex = boundValue(</span>
 157 |     | <span class='neutral'>            validationDurationIndex,</span>
 158 |     | <span class='neutral'>            0,</span>
 159 | *   | <span class='executed'>            durations.length</span>
 160 |     | <span class='neutral'>        );</span>
 161 | *   | <span class='executed'>        uint validationDuration = durations[validationDurationIndex];</span>
 162 |     | <span class='neutral'></span>
 163 | *   | <span class='executed'>        address user = users[userIndex];</span>
 164 | *   | <span class='executed'>        uint amount = ignite.getRegistrationFee(validationDuration);</span>
 165 | *   | <span class='executed'>        gostMinimumContractBalance += amount;</span>
 166 | *   | <span class='executed'>        totalEthStaked += amount;</span>
 167 |     | <span class='neutral'></span>
 168 | *   | <span class='executed'>        vm.prank(user);</span>
 169 | *   | <span class='executed'>        ignite.registerWithAvaxFee{value: amount}(</span>
 170 | *   | <span class='executed'>            string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)),</span>
 171 |     | <span class='neutral'>            blsPoP,</span>
 172 |     | <span class='neutral'>            validationDuration</span>
 173 |     | <span class='neutral'>        );</span>
 174 |     | <span class='neutral'>        nodeIds.push(string(abi.encodePacked(&quot;NodeID-&quot;, nodeId)));</span>
 175 |     | <span class='neutral'>        isRegisteredCalled = true;</span>
 176 |     | <span class='neutral'>    }</span>
 177 |     | <span class='neutral'></span>
 178 |     | <span class='neutral'>    function withdraw_eth(uint amount) public {</span>
 179 | *   | <span class='executed'>        uint minBal = ignite.minimumContractBalance();</span>
 180 |     | <span class='neutral'>        amount = boundValue(</span>
 181 |     | <span class='neutral'>            amount,</span>
 182 |     | <span class='neutral'>            minBal + 1,</span>
 183 | *   | <span class='executed'>            address(ignite).balance - minBal + 1</span>
 184 |     | <span class='neutral'>        );</span>
 185 |     | <span class='neutral'></span>
 186 | *   | <span class='executed'>        totalEthStaked -= amount;</span>
 187 | *   | <span class='executed'>        vm.prank(admin);</span>
 188 | *   | <span class='executed'>        ignite.withdraw(amount);</span>
 189 |     | <span class='neutral'>    }</span>
 190 |     | <span class='neutral'>    function release_locked_tokens_failed(uint256 nodeIdIndex) public {</span>
 191 | *   | <span class='executed'>        nodeIdIndex = boundValue(nodeIdIndex, 0, nodeIds.length);</span>
 192 | *   | <span class='executed'>        string memory nodeId = nodeIds[nodeIdIndex];</span>
 193 | *   | <span class='executed'>        uint registrationIndex = ignite.registrationIndicesByNodeId(nodeId);</span>
 194 |     | <span class='neutral'>        (</span>
 195 |     | <span class='neutral'>            ,</span>
 196 |     | <span class='neutral'>            ,</span>
 197 |     | <span class='neutral'>            ,</span>
 198 |     | <span class='neutral'>            bool feePaid,</span>
 199 |     | <span class='neutral'>            IgniteStorage.TokenDepositDetails memory tokenDeposits,</span>
 200 |     | <span class='neutral'>            ,</span>
 201 |     | <span class='neutral'>            ,</span>
 202 |     | <span class='neutral'>            ,</span>
 203 |     | <span class='neutral'>            ,</span>
 204 |     | <span class='neutral'>            bool withdrawable</span>
 205 | *   | <span class='executed'>        ) = ignite.registrations(registrationIndex);</span>
 206 |     | <span class='neutral'></span>
 207 | *   | <span class='executed'>        if (!withdrawable) {</span>
 208 | *   | <span class='executed'>            if (feePaid) {</span>
 209 | *   | <span class='executed'>                vm.prank(admin);</span>
 210 | *   | <span class='executed'>                ignite.releaseLockedTokens{value: 0}(</span>
 211 |     | <span class='neutral'>                    nodeId,</span>
 212 |     | <span class='neutral'>                    true // bool failed</span>
 213 |     | <span class='neutral'>                );</span>
 214 |     | <span class='neutral'>            } else {</span>
 215 | *   | <span class='executed'>                if (tokenDeposits.avaxAmount &gt; 0 &amp;&amp; tokenDeposits.tokenAmount &gt; 0) {</span>
 216 | *   | <span class='executed'>                    failRegistrationIndices.push(nodeId);</span>
 217 |     | <span class='neutral'>                }</span>
 218 | *   | <span class='executed'>                totalEthStaked += tokenDeposits.avaxAmount;</span>
 219 | *   | <span class='executed'>                gostMinimumContractBalance += tokenDeposits.avaxAmount;</span>
 220 |     | <span class='neutral'></span>
 221 | *   | <span class='executed'>                vm.prank(admin);</span>
 222 | *   | <span class='executed'>                ignite.releaseLockedTokens{value: tokenDeposits.avaxAmount}(</span>
 223 |     | <span class='neutral'>                    nodeId,</span>
 224 |     | <span class='neutral'>                    true // bool failed</span>
 225 |     | <span class='neutral'>                );</span>
 226 |     | <span class='neutral'>            }</span>
 227 |     | <span class='neutral'>        }</span>
 228 | *   | <span class='executed'>        releaseLockTokenFailedCalled = true;</span>
 229 |     | <span class='neutral'>    }</span>
 230 |     | <span class='neutral'></span>
 231 | *   | <span class='executed'>    function release_locked_tokens_success(uint256 nodeIdIndex) public {</span>
 232 | *   | <span class='executed'>        if(!isRegisteredCalled) return;</span>
 233 | *   | <span class='executed'>        nodeIdIndex = boundValue(nodeIdIndex, 0, nodeIds.length);</span>
 234 | *   | <span class='executed'>        string memory nodeId = nodeIds[nodeIdIndex];</span>
 235 | *   | <span class='executed'>        uint registrationIndex = ignite.registrationIndicesByNodeId(nodeId);</span>
 236 |     | <span class='neutral'>        (</span>
 237 |     | <span class='neutral'>            ,</span>
 238 |     | <span class='neutral'>            ,</span>
 239 |     | <span class='neutral'>            ,</span>
 240 |     | <span class='neutral'>            bool feePaid,</span>
 241 |     | <span class='neutral'>            IgniteStorage.TokenDepositDetails memory tokenDeposits,</span>
 242 |     | <span class='neutral'>            ,</span>
 243 |     | <span class='neutral'>            ,</span>
 244 |     | <span class='neutral'>            ,</span>
 245 |     | <span class='neutral'>            ,</span>
 246 |     | <span class='neutral'>            bool withdrawable</span>
 247 | *   | <span class='executed'>        ) = ignite.registrations(registrationIndex);</span>
 248 |     | <span class='neutral'></span>
 249 | *   | <span class='executed'>        if(!withdrawable){</span>
 250 | *   | <span class='executed'>        if (feePaid) {</span>
 251 | *   | <span class='executed'>            if (tokenDeposits.avaxAmount &gt; 0) {</span>
 252 | *   | <span class='executed'>                successRegistrationIndices.push(registrationIndex);</span>
 253 | *   | <span class='executed'>                totalEthStaked -= tokenDeposits.avaxAmount;</span>
 254 | *   | <span class='executed'>                vm.prank(admin);</span>
 255 | *   | <span class='executed'>                ignite.releaseLockedTokens{value: 0}(</span>
 256 |     | <span class='neutral'>                    nodeId,</span>
 257 |     | <span class='neutral'>                    false // bool failed</span>
 258 |     | <span class='neutral'>                );</span>
 259 | *   | <span class='executed'>                avaxFee += tokenDeposits.avaxAmount;</span>
 260 | *   | <span class='executed'>                gostMinimumContractBalance -= tokenDeposits.avaxAmount;</span>
 261 |     | <span class='neutral'></span>
 262 |     | <span class='neutral'>            } else {</span>
 263 |     | <span class='neutral'></span>
 264 |     | <span class='neutral'></span>
 265 | *   | <span class='executed'>                successRegistrationIndices.push(registrationIndex);</span>
 266 | *   | <span class='executed'>                totalQIStaked -= tokenDeposits.tokenAmount;</span>
 267 | *   | <span class='executed'>                vm.prank(admin);</span>
 268 | *   | <span class='executed'>                ignite.releaseLockedTokens{value: 0}(</span>
 269 |     | <span class='neutral'>                    nodeId,</span>
 270 |     | <span class='neutral'>                    false // bool failed</span>
 271 |     | <span class='neutral'>                );</span>
 272 | *   | <span class='executed'>                tokenFee += tokenDeposits.tokenAmount;</span>
 273 |     | <span class='neutral'>            }</span>
 274 |     | <span class='neutral'>        }else{</span>
 275 | *   | <span class='executed'>            if (ignite.qiRewardEligibilityByNodeId(nodeId)) {</span>
 276 |     | <span class='neutral'></span>
 277 | *   | <span class='executed'>            uint fee = tokenDeposits.tokenAmount / 201;</span>
 278 |     | <span class='neutral'></span>
 279 | *   | <span class='executed'>                totalQIStaked -= fee;</span>
 280 |     | <span class='neutral'></span>
 281 | *   | <span class='executed'>                tokenFee += fee;</span>
 282 |     | <span class='neutral'></span>
 283 | *   | <span class='executed'>                  vm.prank(admin);</span>
 284 | *   | <span class='executed'>                ignite.releaseLockedTokens{value: 0}(</span>
 285 |     | <span class='neutral'>                    nodeId,</span>
 286 |     | <span class='neutral'>                    false // bool failed</span>
 287 |     | <span class='neutral'>                );</span>
 288 |     | <span class='neutral'>            }else {</span>
 289 | *   | <span class='executed'>                uint msgValue = tokenDeposits.avaxAmount+10;</span>
 290 | *   | <span class='executed'>                totalEthStaked += msgValue;</span>
 291 | *   | <span class='executed'>            gostMinimumContractBalance += msgValue;</span>
 292 | *   | <span class='executed'>                vm.prank(admin);</span>
 293 | *   | <span class='executed'>                ignite.releaseLockedTokens{value: msgValue}(</span>
 294 |     | <span class='neutral'>                    nodeId,</span>
 295 |     | <span class='neutral'>                    false // bool failed</span>
 296 |     | <span class='neutral'>                );</span>
 297 |     | <span class='neutral'>            }</span>
 298 |     | <span class='neutral'>        }</span>
 299 |     | <span class='neutral'>        }</span>
 300 | *   | <span class='executed'>        releaseLockTokenSuccessCalled = true;</span>
 301 |     | <span class='neutral'>    }</span>
 302 |     | <span class='neutral'></span>
 303 |     | <span class='neutral'></span>
 304 |     | <span class='neutral'></span>
 305 |     | <span class='neutral'>     function release_locked_tokens_slash(uint256 nodeIdIndex) public {</span>
 306 | *   | <span class='executed'>        nodeIdIndex = boundValue(nodeIdIndex, 0, nodeIds.length);</span>
 307 | *   | <span class='executed'>        string memory nodeId = nodeIds[nodeIdIndex];</span>
 308 | *   | <span class='executed'>        uint registrationIndex = ignite.registrationIndicesByNodeId(nodeId);</span>
 309 |     | <span class='neutral'>        (</span>
 310 |     | <span class='neutral'>            ,</span>
 311 |     | <span class='neutral'>            ,</span>
 312 |     | <span class='neutral'>            ,</span>
 313 |     | <span class='neutral'>            bool feePaid,</span>
 314 |     | <span class='neutral'>            IgniteStorage.TokenDepositDetails memory tokenDeposits,</span>
 315 |     | <span class='neutral'>            ,</span>
 316 |     | <span class='neutral'>            uint qiSlashPercentage,</span>
 317 |     | <span class='neutral'>            uint avaxSlashPercentage,</span>
 318 |     | <span class='neutral'>            ,</span>
 319 |     | <span class='neutral'>            bool withdrawable</span>
 320 | *   | <span class='executed'>        ) = ignite.registrations(registrationIndex);</span>
 321 |     | <span class='neutral'></span>
 322 |     | <span class='neutral'>                uint msgValue = tokenDeposits.avaxAmount;</span>
 323 | *   | <span class='executed'>        if(!withdrawable){</span>
 324 | *   | <span class='executed'>        if (!feePaid &amp;&amp; msgValue != 0) {</span>
 325 |     | <span class='neutral'></span>
 326 |     | <span class='neutral'>       </span>
 327 |     | <span class='neutral'></span>
 328 | *   | <span class='executed'>                vm.prank(admin);</span>
 329 | *   | <span class='executed'>                ignite.releaseLockedTokens{value: msgValue}(</span>
 330 |     | <span class='neutral'>                    nodeId,</span>
 331 |     | <span class='neutral'>                    false // bool failed</span>
 332 |     | <span class='neutral'>                );</span>
 333 |     | <span class='unexecuted'>                totalEthStaked += msgValue;</span>
 334 |     | <span class='neutral'></span>
 335 |     | <span class='neutral'></span>
 336 |     | <span class='unexecuted'>            if (qiSlashPercentage &gt; 0) {</span>
 337 |     | <span class='unexecuted'>                uint qiSlashAmount = tokenDeposits.tokenAmount * qiSlashPercentage / 10_000;</span>
 338 |     | <span class='unexecuted'>                tokenSlash += qiSlashAmount;</span>
 339 |     | <span class='unexecuted'>                totalQIStaked -= qiSlashAmount;</span>
 340 |     | <span class='neutral'>            }</span>
 341 |     | <span class='neutral'></span>
 342 |     | <span class='unexecuted'>            if (avaxSlashPercentage &gt; 0) {</span>
 343 |     | <span class='unexecuted'>                uint avaxSlashAmount = tokenDeposits.avaxAmount * avaxSlashPercentage / 10_000;</span>
 344 |     | <span class='neutral'></span>
 345 |     | <span class='unexecuted'>                gostMinimumContractBalance += msgValue - avaxSlashAmount;</span>
 346 |     | <span class='unexecuted'>                   avaxSlash +=avaxSlashAmount;</span>
 347 |     | <span class='unexecuted'>                totalEthStaked -= avaxSlashAmount;</span>
 348 |     | <span class='neutral'>            } else {</span>
 349 |     | <span class='unexecuted'>                gostMinimumContractBalance += msgValue;</span>
 350 |     | <span class='neutral'>            }</span>
 351 |     | <span class='neutral'></span>
 352 |     | <span class='neutral'></span>
 353 |     | <span class='neutral'>        }</span>
 354 |     | <span class='neutral'>        }</span>
 355 | *   | <span class='executed'>        releaseLockTokenSlashedCalled = true;</span>
 356 |     | <span class='neutral'>    }</span>
 357 |     | <span class='neutral'>}</span>
 358 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/test/contracts/FaucetToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'></span>
  8 | *   | <span class='executed'>contract FaucetToken is ERC20 {</span>
  9 |     | <span class='neutral'>    uint8 private _decimals;</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    constructor(</span>
 12 |     | <span class='neutral'>        string memory _symbol,</span>
 13 |     | <span class='neutral'>        string memory _name,</span>
 14 |     | <span class='neutral'>        uint8 __decimals</span>
 15 | *   | <span class='executed'>    ) ERC20(string(abi.encodePacked(_symbol, _name)), _symbol) {</span>
 16 | *   | <span class='executed'>        _decimals = __decimals;</span>
 17 |     | <span class='neutral'>    }</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    function mint(uint256 _amount) external {</span>
 20 | *   | <span class='executed'>        _mint(msg.sender, _amount);</span>
 21 |     | <span class='neutral'>    }</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>    function decimals() public view override returns (uint8) {</span>
 24 | *   | <span class='executed'>        return _decimals;</span>
 25 |     | <span class='neutral'>    }</span>
 26 |     | <span class='neutral'>}</span>
 27 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/test/contracts/PriceFeed.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev A mock price feed that provides latestRoundData with the Chainlink</span>
  8 |     | <span class='neutral'> *      price feed interface. A setPrice function (which does not enforce</span>
  9 |     | <span class='neutral'> *      access control) is used to set the price after the initial value</span>
 10 |     | <span class='neutral'> *      specified during deployment.</span>
 11 |     | <span class='neutral'> */</span>
 12 | *   | <span class='executed'>contract PriceFeed {</span>
 13 |     | <span class='neutral'>    int256 price;</span>
 14 |     | <span class='neutral'>    uint256 updatedAt;</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    constructor(int256 _price) {</span>
 17 |     | <span class='neutral'>        price = _price;</span>
 18 | *   | <span class='executed'>        updatedAt = block.timestamp;</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    function latestRoundData() external view returns (uint80, int256, uint256, uint256, uint80) {</span>
 22 | *   | <span class='executed'>        return (0, price, 0, updatedAt, 0);</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='neutral'></span>
 25 |     | <span class='neutral'>    function setPrice(int256 _price) external {</span>
 26 |     | <span class='neutral'>        price = _price;</span>
 27 |     | <span class='neutral'>    }</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    function setUpdatedAtTimestamp(uint256 _updatedAt) external {</span>
 30 |     | <span class='neutral'>        updatedAt = _updatedAt;</span>
 31 |     | <span class='neutral'>    }</span>
 32 |     | <span class='neutral'>}</span>
 33 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/asad97/my-stuff/audits/ignit-cyfrin/ignite/test/contracts/StakedAvax.sol</b>
<code>
 1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
 2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
 3 |     | <span class='neutral'></span>
 4 |     | <span class='neutral'></span>
 5 | *   | <span class='executed'>contract StakedAvax {</span>
 6 |     | <span class='neutral'>    function accrueRewards(uint amount) external {}</span>
 7 |     | <span class='neutral'>}</span>
 8 |     | <span class='neutral'></span>

</code>
<br />

